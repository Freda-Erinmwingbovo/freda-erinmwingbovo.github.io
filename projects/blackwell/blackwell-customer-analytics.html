<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Freda Erinmwingbovo">
<meta name="dcterms.date" content="2026-02-22">

<title>Blackwell Electronics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="blackwell-customer-analytics_files/libs/clipboard/clipboard.min.js"></script>
<script src="blackwell-customer-analytics_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="blackwell-customer-analytics_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="blackwell-customer-analytics_files/libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="blackwell-customer-analytics_files/libs/quarto-html/popper.min.js"></script>
<script src="blackwell-customer-analytics_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="blackwell-customer-analytics_files/libs/quarto-html/anchor.min.js"></script>
<link href="blackwell-customer-analytics_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="blackwell-customer-analytics_files/libs/quarto-html/quarto-syntax-highlighting-dark-4d9afe2b8d18ee9fa5d0d57b5ed4214d.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="blackwell-customer-analytics_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="blackwell-customer-analytics_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="blackwell-customer-analytics_files/libs/bootstrap/bootstrap-6a2304e8205947f458227360dae39651.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="dark">
<style>html{ scroll-behavior: smooth; }</style>
<script src="blackwell-customer-analytics_files/libs/kePrint-0.0.1/kePrint.js"></script>

<link href="blackwell-customer-analytics_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">

<link href="blackwell-customer-analytics_files/libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">

<script src="blackwell-customer-analytics_files/libs/pagedtable-1.1/js/pagedtable.js"></script>



</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Report Contents</h2>
   
  <ul>
  <li><a href="#introduction-and-data-loading" id="toc-introduction-and-data-loading" class="nav-link active" data-scroll-target="#introduction-and-data-loading"><span class="header-section-number">1</span> Introduction and Data Loading</a>
  <ul class="collapse">
  <li><a href="#background-objectives" id="toc-background-objectives" class="nav-link" data-scroll-target="#background-objectives"><span class="header-section-number">1.1</span> Background &amp; Objectives</a></li>
  <li><a href="#the-libraries-installed" id="toc-the-libraries-installed" class="nav-link" data-scroll-target="#the-libraries-installed"><span class="header-section-number">1.2</span> The Libraries Installed</a></li>
  <li><a href="#importing-the-data" id="toc-importing-the-data" class="nav-link" data-scroll-target="#importing-the-data"><span class="header-section-number">1.3</span> Importing the Data</a></li>
  </ul></li>
  <li><a href="#data-preprocessing" id="toc-data-preprocessing" class="nav-link" data-scroll-target="#data-preprocessing"><span class="header-section-number">2</span> Data Preprocessing</a>
  <ul class="collapse">
  <li><a href="#data-inspection" id="toc-data-inspection" class="nav-link" data-scroll-target="#data-inspection"><span class="header-section-number">2.1</span> Data Inspection</a>
  <ul class="collapse">
  <li><a href="#interpretation" id="toc-interpretation" class="nav-link" data-scroll-target="#interpretation"><span class="header-section-number">2.1.1</span> Interpretation</a></li>
  </ul></li>
  <li><a href="#missing-values" id="toc-missing-values" class="nav-link" data-scroll-target="#missing-values"><span class="header-section-number">2.2</span> Missing Values</a>
  <ul class="collapse">
  <li><a href="#interpretation-1" id="toc-interpretation-1" class="nav-link" data-scroll-target="#interpretation-1"><span class="header-section-number">2.2.1</span> Interpretation</a></li>
  </ul></li>
  <li><a href="#duplicate-records" id="toc-duplicate-records" class="nav-link" data-scroll-target="#duplicate-records"><span class="header-section-number">2.3</span> Duplicate Records</a>
  <ul class="collapse">
  <li><a href="#interpretation-2" id="toc-interpretation-2" class="nav-link" data-scroll-target="#interpretation-2"><span class="header-section-number">2.3.1</span> Interpretation</a></li>
  </ul></li>
  <li><a href="#data-types-validation" id="toc-data-types-validation" class="nav-link" data-scroll-target="#data-types-validation"><span class="header-section-number">2.4</span> Data Types Validation</a>
  <ul class="collapse">
  <li><a href="#interpretation-3" id="toc-interpretation-3" class="nav-link" data-scroll-target="#interpretation-3"><span class="header-section-number">2.4.1</span> Interpretation</a></li>
  </ul></li>
  <li><a href="#outlier-detection" id="toc-outlier-detection" class="nav-link" data-scroll-target="#outlier-detection"><span class="header-section-number">2.5</span> Outlier Detection</a>
  <ul class="collapse">
  <li><a href="#interpretation-4" id="toc-interpretation-4" class="nav-link" data-scroll-target="#interpretation-4"><span class="header-section-number">2.5.1</span> Interpretation</a></li>
  </ul></li>
  <li><a href="#outlier-treatment" id="toc-outlier-treatment" class="nav-link" data-scroll-target="#outlier-treatment"><span class="header-section-number">2.6</span> Outlier Treatment</a>
  <ul class="collapse">
  <li><a href="#interpretation-5" id="toc-interpretation-5" class="nav-link" data-scroll-target="#interpretation-5"><span class="header-section-number">2.6.1</span> Interpretation</a></li>
  </ul></li>
  <li><a href="#preprocessing-summary" id="toc-preprocessing-summary" class="nav-link" data-scroll-target="#preprocessing-summary"><span class="header-section-number">2.7</span> Preprocessing Summary</a></li>
  <li><a href="#clean-dataset-ready-for-analysis" id="toc-clean-dataset-ready-for-analysis" class="nav-link" data-scroll-target="#clean-dataset-ready-for-analysis"><span class="header-section-number">2.8</span> Clean Dataset, Ready for Analysis</a></li>
  </ul></li>
  <li><a href="#exploratory-data-analysis" id="toc-exploratory-data-analysis" class="nav-link" data-scroll-target="#exploratory-data-analysis"><span class="header-section-number">3</span> Exploratory Data Analysis</a>
  <ul class="collapse">
  <li><a href="#regional-spending-patterns" id="toc-regional-spending-patterns" class="nav-link" data-scroll-target="#regional-spending-patterns"><span class="header-section-number">3.1</span> Regional Spending Patterns</a>
  <ul class="collapse">
  <li><a href="#interpretation-6" id="toc-interpretation-6" class="nav-link" data-scroll-target="#interpretation-6"><span class="header-section-number">3.1.1</span> Interpretation</a></li>
  </ul></li>
  <li><a href="#items-vs-amount-relationship" id="toc-items-vs-amount-relationship" class="nav-link" data-scroll-target="#items-vs-amount-relationship"><span class="header-section-number">3.2</span> Items vs Amount Relationship</a>
  <ul class="collapse">
  <li><a href="#interpretation-7" id="toc-interpretation-7" class="nav-link" data-scroll-target="#interpretation-7"><span class="header-section-number">3.2.1</span> Interpretation</a></li>
  </ul></li>
  <li><a href="#customer-age-spending" id="toc-customer-age-spending" class="nav-link" data-scroll-target="#customer-age-spending"><span class="header-section-number">3.3</span> Customer Age &amp; Spending</a>
  <ul class="collapse">
  <li><a href="#interpretation-martins-hypothesis-2" id="toc-interpretation-martins-hypothesis-2" class="nav-link" data-scroll-target="#interpretation-martins-hypothesis-2"><span class="header-section-number">3.3.1</span> Interpretation Martin’s Hypothesis #2</a></li>
  </ul></li>
  <li><a href="#purchase-channel-analysis" id="toc-purchase-channel-analysis" class="nav-link" data-scroll-target="#purchase-channel-analysis"><span class="header-section-number">3.4</span> Purchase Channel Analysis</a>
  <ul class="collapse">
  <li><a href="#interpretation-martins-hypothesis-1" id="toc-interpretation-martins-hypothesis-1" class="nav-link" data-scroll-target="#interpretation-martins-hypothesis-1"><span class="header-section-number">3.4.1</span> Interpretation: Martin’s Hypothesis #1</a></li>
  </ul></li>
  <li><a href="#age-differences-across-regions" id="toc-age-differences-across-regions" class="nav-link" data-scroll-target="#age-differences-across-regions"><span class="header-section-number">3.5</span> Age Differences Across Regions</a>
  <ul class="collapse">
  <li><a href="#interpretation-8" id="toc-interpretation-8" class="nav-link" data-scroll-target="#interpretation-8"><span class="header-section-number">3.5.1</span> Interpretation</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#predictive-modelling" id="toc-predictive-modelling" class="nav-link" data-scroll-target="#predictive-modelling"><span class="header-section-number">4</span> Predictive Modelling</a>
  <ul class="collapse">
  <li><a href="#modelling-approach" id="toc-modelling-approach" class="nav-link" data-scroll-target="#modelling-approach"><span class="header-section-number">4.1</span> Modelling Approach</a></li>
  <li><a href="#features-available-for-modelling" id="toc-features-available-for-modelling" class="nav-link" data-scroll-target="#features-available-for-modelling"><span class="header-section-number">4.2</span> Features Available for Modelling</a></li>
  </ul></li>
  <li><a href="#purchase-channel-prediction" id="toc-purchase-channel-prediction" class="nav-link" data-scroll-target="#purchase-channel-prediction"><span class="header-section-number">5</span> Purchase Channel Prediction</a>
  <ul class="collapse">
  <li><a href="#data-splitting" id="toc-data-splitting" class="nav-link" data-scroll-target="#data-splitting"><span class="header-section-number">5.1</span> Data Splitting</a></li>
  <li><a href="#feature-selection" id="toc-feature-selection" class="nav-link" data-scroll-target="#feature-selection"><span class="header-section-number">5.2</span> Feature Selection</a></li>
  <li><a href="#feature-selection-results" id="toc-feature-selection-results" class="nav-link" data-scroll-target="#feature-selection-results"><span class="header-section-number">5.3</span> Feature Selection Results</a></li>
  <li><a href="#models-training" id="toc-models-training" class="nav-link" data-scroll-target="#models-training"><span class="header-section-number">5.4</span> Models Training</a></li>
  <li><a href="#channel-model-comparison" id="toc-channel-model-comparison" class="nav-link" data-scroll-target="#channel-model-comparison"><span class="header-section-number">5.5</span> Channel Model Comparison</a></li>
  <li><a href="#purchase-channel-best-model" id="toc-purchase-channel-best-model" class="nav-link" data-scroll-target="#purchase-channel-best-model"><span class="header-section-number">5.6</span> Purchase Channel Best Model</a></li>
  <li><a href="#best-model-for-channel-prediction" id="toc-best-model-for-channel-prediction" class="nav-link" data-scroll-target="#best-model-for-channel-prediction"><span class="header-section-number">5.7</span> Best model for channel prediction</a></li>
  <li><a href="#interpretation-channel-prediction" id="toc-interpretation-channel-prediction" class="nav-link" data-scroll-target="#interpretation-channel-prediction"><span class="header-section-number">5.8</span> Interpretation: Channel Prediction</a></li>
  </ul></li>
  <li><a href="#customer-age-prediction" id="toc-customer-age-prediction" class="nav-link" data-scroll-target="#customer-age-prediction"><span class="header-section-number">6</span> Customer Age Prediction</a>
  <ul class="collapse">
  <li><a href="#data-splitting-1" id="toc-data-splitting-1" class="nav-link" data-scroll-target="#data-splitting-1"><span class="header-section-number">6.1</span> Data Splitting</a></li>
  <li><a href="#feature-selection-for-age-prediction" id="toc-feature-selection-for-age-prediction" class="nav-link" data-scroll-target="#feature-selection-for-age-prediction"><span class="header-section-number">6.2</span> Feature Selection For Age Prediction</a></li>
  <li><a href="#feature-selection-results-1" id="toc-feature-selection-results-1" class="nav-link" data-scroll-target="#feature-selection-results-1"><span class="header-section-number">6.3</span> Feature Selection Results</a></li>
  <li><a href="#model-training-for-age-prediction" id="toc-model-training-for-age-prediction" class="nav-link" data-scroll-target="#model-training-for-age-prediction"><span class="header-section-number">6.4</span> Model Training For Age Prediction</a></li>
  <li><a href="#age-comparison-table-and-best-model" id="toc-age-comparison-table-and-best-model" class="nav-link" data-scroll-target="#age-comparison-table-and-best-model"><span class="header-section-number">6.5</span> Age Comparison Table And Best Model</a></li>
  <li><a href="#actual-vs-predicted-table-for-the-decision-tree" id="toc-actual-vs-predicted-table-for-the-decision-tree" class="nav-link" data-scroll-target="#actual-vs-predicted-table-for-the-decision-tree"><span class="header-section-number">6.6</span> Actual vs Predicted Table For The Decision Tree</a></li>
  <li><a href="#save-the-best-age-model" id="toc-save-the-best-age-model" class="nav-link" data-scroll-target="#save-the-best-age-model"><span class="header-section-number">6.7</span> Save The Best Age Model</a></li>
  <li><a href="#interpretation-age-prediction" id="toc-interpretation-age-prediction" class="nav-link" data-scroll-target="#interpretation-age-prediction"><span class="header-section-number">6.8</span> Interpretation: Age Prediction</a></li>
  </ul></li>
  <li><a href="#region-prediction" id="toc-region-prediction" class="nav-link" data-scroll-target="#region-prediction"><span class="header-section-number">7</span> Region Prediction</a>
  <ul class="collapse">
  <li><a href="#data-splitting-2" id="toc-data-splitting-2" class="nav-link" data-scroll-target="#data-splitting-2"><span class="header-section-number">7.1</span> Data Splitting</a></li>
  <li><a href="#feature-selection-1" id="toc-feature-selection-1" class="nav-link" data-scroll-target="#feature-selection-1"><span class="header-section-number">7.2</span> Feature Selection</a></li>
  <li><a href="#feature-selection-results-2" id="toc-feature-selection-results-2" class="nav-link" data-scroll-target="#feature-selection-results-2"><span class="header-section-number">7.3</span> Feature Selection Results</a></li>
  <li><a href="#region-model-training" id="toc-region-model-training" class="nav-link" data-scroll-target="#region-model-training"><span class="header-section-number">7.4</span> Region Model Training</a></li>
  <li><a href="#region-comparison-table-and-best-model" id="toc-region-comparison-table-and-best-model" class="nav-link" data-scroll-target="#region-comparison-table-and-best-model"><span class="header-section-number">7.5</span> Region Comparison Table And Best Model</a></li>
  <li><a href="#actual-vs-predicted-table-decision-tree" id="toc-actual-vs-predicted-table-decision-tree" class="nav-link" data-scroll-target="#actual-vs-predicted-table-decision-tree"><span class="header-section-number">7.6</span> Actual vs Predicted Table: Decision Tree</a></li>
  <li><a href="#save-region-best-model" id="toc-save-region-best-model" class="nav-link" data-scroll-target="#save-region-best-model"><span class="header-section-number">7.7</span> Save Region Best Model</a></li>
  <li><a href="#interpretation-region-prediction" id="toc-interpretation-region-prediction" class="nav-link" data-scroll-target="#interpretation-region-prediction"><span class="header-section-number">7.8</span> Interpretation: Region Prediction</a></li>
  </ul></li>
  <li><a href="#conclusions-recommendations" id="toc-conclusions-recommendations" class="nav-link" data-scroll-target="#conclusions-recommendations"><span class="header-section-number">8</span> Conclusions &amp; Recommendations</a>
  <ul class="collapse">
  <li><a href="#closing-remarks" id="toc-closing-remarks" class="nav-link" data-scroll-target="#closing-remarks"><span class="header-section-number">8.1</span> Closing Remarks</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Blackwell Electronics</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
<p class="subtitle lead">Customer Analytics Report — Purchasing Behaviour &amp; Demographics</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Freda Erinmwingbovo </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 22, 2026</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<div class="cover-header">
  <div class="cover-top-bar">
    <span class="cover-company">BLACKWELL ELECTRONICS</span>
    <span class="cover-tag">CONFIDENTIAL INTERNAL REPORT</span>
  </div>
  <div class="cover-main">
    <div class="cover-label">Customer Analytics</div>
    <h1 class="cover-title">Purchasing Behaviour<br>&amp; Demographics</h1>
    <p class="cover-subtitle">
      An investigation into regional spending patterns, customer demographics,
      and predictive modelling of purchase behaviour across 80,000 transactions.
    </p>
  </div>
  <div class="cover-bottom-bar">
    <div class="cover-meta">
      <span class="meta-label">PREPARED BY</span>
      <span class="meta-value">Freda Erinmwingbovo</span>
    </div>
    <div class="cover-meta">
      <span class="meta-label">PREPARED FOR</span>
      <span class="meta-value">Danielle Sherman, CTO</span>
    </div>
    <div class="cover-meta">
      <span class="meta-label">DATE</span>
      <span class="meta-value">February 2026</span>
    </div>
    <div class="cover-meta">
      <span class="meta-label">RECORDS ANALYSED</span>
      <span class="meta-value">80,000 Transactions</span>
    </div>
  </div>
</div>

<style>
.cover-header {
  background: linear-gradient(135deg, #0a0a0f 0%, #12121a 50%, #0d0d1f 100%);
  border: 1px solid #2a2a3a;
  border-left: 4px solid #00d4ff;
  border-radius: 8px;
  margin: 0 0 3rem 0;
  overflow: hidden;
  position: relative;
}

.cover-header::before {
  content: 'BWE';
  position: absolute;
  right: -10px;
  top: 50%;
  transform: translateY(-50%);
  font-size: 12rem;
  font-weight: 900;
  color: rgba(0, 212, 255, 0.03);
  font-family: 'Cormorant Garamond', serif;
  line-height: 1;
  pointer-events: none;
}

.cover-top-bar {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 14px 32px;
  background: rgba(0, 212, 255, 0.05);
  border-bottom: 1px solid #2a2a3a;
}

.cover-company {
  font-family: 'JetBrains Mono', monospace;
  font-size: 0.72rem;
  letter-spacing: 4px;
  color: #00d4ff;
  font-weight: 500;
}

.cover-tag {
  font-family: 'JetBrains Mono', monospace;
  font-size: 0.65rem;
  letter-spacing: 2px;
  color: #8a8a9a;
}

.cover-main {
  padding: 52px 32px 40px;
  text-align: center;
}

.cover-label {
  font-family: 'JetBrains Mono', monospace;
  font-size: 0.7rem;
  letter-spacing: 4px;
  text-transform: uppercase;
  color: #7b61ff;
  margin-bottom: 16px;
  text-align: center;
}

.cover-title {
  font-family: 'Cormorant Garamond', serif !important;
  font-size: clamp(2.2rem, 5vw, 3.4rem) !important;
  font-weight: 700 !important;
  line-height: 1.15 !important;
  color: #ffffff !important;
  margin-bottom: 24px !important;
  border: none !important;
  padding: 0 !important;
  text-align: center;
}

.cover-subtitle {
  font-size: 0.95rem;
  color: #8a8a9a;
  max-width: 580px;
  line-height: 1.8;
  margin: 0 auto;
}

.cover-bottom-bar {
  display: flex;
  gap: 0;
  border-top: 1px solid #2a2a3a;
  flex-wrap: wrap;
}

.cover-meta {
  display: flex;
  flex-direction: column;
  gap: 5px;
  padding: 20px 32px;
  border-right: 1px solid #2a2a3a;
  flex: 1;
  min-width: 160px;
}

.meta-label {
  font-family: 'JetBrains Mono', monospace;
  font-size: 0.62rem;
  letter-spacing: 2.5px;
  color: #8a8a9a;
  text-transform: uppercase;
}

.meta-value {
  font-size: 0.88rem;
  font-weight: 500;
  color: #e8e8e8;
}
</style>
<section id="introduction-and-data-loading" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introduction and Data Loading</h1>
<section id="background-objectives" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="background-objectives"><span class="header-section-number">1.1</span> Background &amp; Objectives</h2>
<p>Blackwell Electronics has operated as a successful electronics retailer for over three decades. Following the launch of their eCommerce platform just over a year ago, the business has begun accumulating valuable customer transaction data, both online and in-store.</p>
<p>This report presents a data-driven investigation into customer purchasing behaviour, commissioned by Danielle Sherman (CTO) and informed by the business questions raised by VP of Sales, Martin Goodrich. The analysis is structured around three core questions:</p>
<ol type="1">
<li><strong>Regional Spending</strong>: Do customers in different regions spend more per transaction? Which regions spend the most and least?</li>
<li><strong>Demographics &amp; Channel</strong>: Are older customers more likely to shop in-store than online? What factors predict how a customer shops?</li>
<li><strong>Predictive Modelling</strong>: Can we predict a customer’s region, their purchase channel, or their age from the available data?</li>
</ol>
<p>The dataset contains <strong>80,000 customer transactions</strong>, capturing age, number of items purchased, transaction amount, purchase channel (online vs.&nbsp;in-store), and region.</p>
</section>
<section id="the-libraries-installed" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="the-libraries-installed"><span class="header-section-number">1.2</span> The Libraries Installed</h2>
<p>The analysis draws on R’s <code>tidyverse</code> ecosystem for data manipulation and visualisation, and the <code>caret</code> framework for machine learning; an industry-standard approach for building and evaluating predictive models.</p>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data manipulation and visualisation</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)   <span class="co"># Core suite: dplyr, ggplot2, readr, tidyr etc.</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)      <span class="co"># For formatting axes (currency, percentages)</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)       <span class="co"># For clean tables in the report</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)  <span class="co"># For styled, professional tables</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Machine learning</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)       <span class="co"># Classification and regression training framework</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randomForest) <span class="co"># Random Forest algorithm</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nnet)        <span class="co"># Multinomial logistic regression (for region prediction)</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Report styling</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggthemes)    <span class="co"># Additional ggplot2 themes</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="importing-the-data" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="importing-the-data"><span class="header-section-number">1.3</span> Importing the Data</h2>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import the customer transaction dataset</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"Demographic_Data.csv"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename columns for clarity and consistency</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">channel  =</span> <span class="st">`</span><span class="at">in-store</span><span class="st">`</span>,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">age      =</span> age,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">items    =</span> items,</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">amount   =</span> amount,</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">region   =</span> region</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert categorical variables to factors with meaningful labels</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">channel =</span> <span class="fu">factor</span>(channel, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), </span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Online"</span>, <span class="st">"In-Store"</span>)),</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">region  =</span> <span class="fu">factor</span>(region, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>),</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"North"</span>, <span class="st">"South"</span>, <span class="st">"East"</span>, <span class="st">"West"</span>))</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Preview the data</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(df)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 80,000
Columns: 5
$ channel &lt;fct&gt; Online, Online, In-Store, In-Store, In-Store, Online, Online, …
$ age     &lt;dbl&gt; 37, 35, 45, 46, 33, 24, 43, 66, 51, 47, 44, 33, 32, 48, 34, 43…
$ items   &lt;dbl&gt; 4, 2, 3, 3, 4, 3, 6, 5, 5, 3, 5, 2, 2, 7, 6, 7, 7, 4, 2, 7, 7,…
$ amount  &lt;dbl&gt; 281.0300, 219.5100, 1525.7000, 715.2500, 1937.5000, 1314.2000,…
$ region  &lt;fct&gt; South, South, West, East, North, West, South, East, North, Nor…</code></pre>
</div>
</div>
</section>
</section>
<section id="data-preprocessing" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Data Preprocessing</h1>
<p>Before any analysis can begin, it is essential to examine the quality and structure of the data. Raw data even from internal systems can contain errors, inconsistencies, missing values, or extreme observations that could distort results and lead to misleading conclusions.</p>
<p>This section documents every step taken to inspect, clean, and validate the dataset prior to analysis. All decisions made during preprocessing are explicitly justified so that the analytical process is fully transparent and reproducible.</p>
<section id="data-inspection" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="data-inspection"><span class="header-section-number">2.1</span> Data Inspection</h2>
<p>The first step is simply to look at the data carefully: its dimensions, structure, data types, and a statistical snapshot of every variable. This gives us an immediate sense of what we are working with and flags anything that needs attention before we proceed.</p>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Dimensions ---</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Rows:"</span>, <span class="fu">nrow</span>(df), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 80000 </code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Columns:"</span>, <span class="fu">ncol</span>(df), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Columns: 5 </code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- First 6 rows ---</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">head</span>() <span class="sc">%&gt;%</span> <span class="fu">kable</span>() <span class="sc">%&gt;%</span> <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">channel</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">age</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">items</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">amount</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">region</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Online</td>
<td style="text-align: right;">37</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">281.03</td>
<td style="text-align: left;">South</td>
</tr>
<tr class="even">
<td style="text-align: left;">Online</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">219.51</td>
<td style="text-align: left;">South</td>
</tr>
<tr class="odd">
<td style="text-align: left;">In-Store</td>
<td style="text-align: right;">45</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1525.70</td>
<td style="text-align: left;">West</td>
</tr>
<tr class="even">
<td style="text-align: left;">In-Store</td>
<td style="text-align: right;">46</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">715.25</td>
<td style="text-align: left;">East</td>
</tr>
<tr class="odd">
<td style="text-align: left;">In-Store</td>
<td style="text-align: right;">33</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1937.50</td>
<td style="text-align: left;">North</td>
</tr>
<tr class="even">
<td style="text-align: left;">Online</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1314.20</td>
<td style="text-align: left;">West</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Clean styled summary table ---</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>summary_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Variable =</span> <span class="fu">c</span>(<span class="st">"channel"</span>, <span class="st">"age"</span>, <span class="st">"items"</span>, <span class="st">"amount"</span>, <span class="st">"region"</span>),</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Type     =</span> <span class="fu">c</span>(<span class="st">"Factor"</span>, <span class="st">"Numeric"</span>, <span class="st">"Numeric"</span>, <span class="st">"Numeric"</span>, <span class="st">"Factor"</span>),</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Min      =</span> <span class="fu">c</span>(<span class="st">"—"</span>, <span class="st">"18"</span>, <span class="st">"1"</span>, <span class="st">"$5.01"</span>, <span class="st">"—"</span>),</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Mean     =</span> <span class="fu">c</span>(<span class="st">"—"</span>, <span class="st">"45.76"</span>, <span class="st">"4.51"</span>, <span class="st">"$835.92"</span>, <span class="st">"—"</span>),</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Median   =</span> <span class="fu">c</span>(<span class="st">"—"</span>, <span class="st">"45"</span>, <span class="st">"4"</span>, <span class="st">"$582.32"</span>, <span class="st">"—"</span>),</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Max      =</span> <span class="fu">c</span>(<span class="st">"—"</span>, <span class="st">"85"</span>, <span class="st">"8"</span>, <span class="st">"$3,000"</span>, <span class="st">"—"</span>)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>summary_table <span class="sc">%&gt;%</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>,<span class="st">"l"</span>,<span class="st">"r"</span>,<span class="st">"r"</span>,<span class="st">"r"</span>,<span class="st">"r"</span>,<span class="st">"l"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Variable</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Type</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Min</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Mean</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Median</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">channel</td>
<td style="text-align: left;">Factor</td>
<td style="text-align: right;">—</td>
<td style="text-align: right;">—</td>
<td style="text-align: right;">—</td>
<td style="text-align: right;">—</td>
</tr>
<tr class="even">
<td style="text-align: left;">age</td>
<td style="text-align: left;">Numeric</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">45.76</td>
<td style="text-align: right;">45</td>
<td style="text-align: right;">85</td>
</tr>
<tr class="odd">
<td style="text-align: left;">items</td>
<td style="text-align: left;">Numeric</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4.51</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: left;">amount</td>
<td style="text-align: left;">Numeric</td>
<td style="text-align: right;">$5.01</td>
<td style="text-align: right;">$835.92</td>
<td style="text-align: right;">$582.32</td>
<td style="text-align: right;">$3,000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">region</td>
<td style="text-align: left;">Factor</td>
<td style="text-align: right;">—</td>
<td style="text-align: right;">—</td>
<td style="text-align: right;">—</td>
<td style="text-align: right;">—</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="interpretation" class="level3" data-number="2.1.1">
<h3 data-number="2.1.1" class="anchored" data-anchor-id="interpretation"><span class="header-section-number">2.1.1</span> Interpretation</h3>
<p>The dataset contains 80,000 rows and 5 columns. Each row represents a single customer transaction. A statistical summary reveals the following initial observations:</p>
<ul>
<li><strong>Age</strong> ranges from 18 to 85, with a mean of approximately 46 years.</li>
<li><strong>Items</strong> purchased per transaction ranges from 1 to 8, averaging around 4 to 5 items.</li>
<li><strong>Amount</strong> spent ranges from near zero to several thousand dollars, suggesting potential outliers at both ends that will need investigation.</li>
<li><strong>Channel</strong> and <strong>Region</strong> are correctly encoded as factors with their respective labels.</li>
</ul>
<p>No immediately obvious structural issues are visible, but we will now systematically check for missing values, duplicates, and outliers.</p>
</section>
</section>
<section id="missing-values" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="missing-values"><span class="header-section-number">2.2</span> Missing Values</h2>
<p>Missing data is one of the most common data quality issues in real-world datasets. If left unaddressed, missing values can cause errors in statistical functions and machine learning models, or silently produce biased results. We systematically check every column for the presence of NA values before proceeding.</p>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Count of missing values per column ---</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>missing_summary <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), <span class="sc">~</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(.)))) <span class="sc">%&gt;%</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(),</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to  =</span> <span class="st">"Variable"</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"Missing_Count"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Rows      =</span> <span class="fu">nrow</span>(df),</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Missing_Percent =</span> <span class="fu">round</span>((Missing_Count <span class="sc">/</span> Total_Rows) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Display as a clean table ---</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>missing_summary <span class="sc">%&gt;%</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Variable"</span>, <span class="st">"Missing Count"</span>, <span class="st">"Total Rows"</span>, <span class="st">"Missing (%)"</span>),</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption   =</span> <span class="st">"Table: Missing Value Summary"</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small">
<caption>Table: Missing Value Summary</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Variable</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Missing Count</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Total Rows</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Missing (%)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">channel</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">80000</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">age</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">80000</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">items</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">80000</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">amount</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">80000</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">region</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">80000</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="interpretation-1" class="level3" data-number="2.2.1">
<h3 data-number="2.2.1" class="anchored" data-anchor-id="interpretation-1"><span class="header-section-number">2.2.1</span> Interpretation</h3>
<p>The missing value check confirms that the dataset is complete. Every column registers zero missing values across all 80,000 records. This is an important quality indicator, as it means no imputation strategy is required and we can proceed to the next preprocessing step with confidence that no records will be silently dropped during analysis.</p>
</section>
</section>
<section id="duplicate-records" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="duplicate-records"><span class="header-section-number">2.3</span> Duplicate Records</h2>
<p>Duplicate records occur when the same transaction is captured more than once in a dataset. This can happen due to system errors, data entry mistakes, or merging of multiple data sources. Duplicates artificially inflate sample sizes and can bias both descriptive statistics and machine learning models. We identify and remove any exact duplicate rows before proceeding.</p>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Identify and save duplicates before removal ---</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>dupes <span class="ot">&lt;-</span> df[<span class="fu">duplicated</span>(df), ]</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>duplicate_count <span class="ot">&lt;-</span> <span class="fu">nrow</span>(dupes)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Remove duplicates ---</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">distinct</span>()</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Print counts together ---</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Duplicate rows detected:"</span>, duplicate_count, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Rows after deduplication:"</span>, <span class="fu">nrow</span>(df), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Columns:"</span>, <span class="fu">ncol</span>(df))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Duplicate rows detected: 21 
 Rows after deduplication: 79979 
 Columns: 5</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Preview of removed duplicates as styled table ---</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>dupes <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() <span class="sc">%&gt;%</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Table: Preview of Duplicate Records Removed"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small">
<caption>Table: Preview of Duplicate Records Removed</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">channel</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">age</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">items</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">amount</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">region</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Online</td>
<td style="text-align: right;">76</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">283.61</td>
<td style="text-align: left;">South</td>
</tr>
<tr class="even">
<td style="text-align: left;">Online</td>
<td style="text-align: right;">67</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">320.41</td>
<td style="text-align: left;">South</td>
</tr>
<tr class="odd">
<td style="text-align: left;">In-Store</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1019.50</td>
<td style="text-align: left;">West</td>
</tr>
<tr class="even">
<td style="text-align: left;">In-Store</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1993.80</td>
<td style="text-align: left;">North</td>
</tr>
<tr class="odd">
<td style="text-align: left;">In-Store</td>
<td style="text-align: right;">31</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1488.10</td>
<td style="text-align: left;">West</td>
</tr>
<tr class="even">
<td style="text-align: left;">Online</td>
<td style="text-align: right;">39</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1268.00</td>
<td style="text-align: left;">West</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="interpretation-2" class="level3" data-number="2.3.1">
<h3 data-number="2.3.1" class="anchored" data-anchor-id="interpretation-2"><span class="header-section-number">2.3.1</span> Interpretation</h3>
<p>The duplicate check identified 21 exact duplicate records within the dataset. These rows were identical across all five variables, suggesting they are most likely the result of a data entry or system logging error rather than genuine repeat transactions. It is statistically improbable that 21 different customers would independently purchase the exact same number of items for the exact same amount in the same region through the same channel.</p>
<p>All 21 duplicate rows were removed using <code>distinct()</code>, reducing the dataset from 80,000 to 79,979 records. This is a negligible reduction of just 0.026% and will have no meaningful impact on the analysis, but it ensures the integrity of every subsequent step.</p>
</section>
</section>
<section id="data-types-validation" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="data-types-validation"><span class="header-section-number">2.4</span> Data Types Validation</h2>
<p>Every variable in a dataset must be stored as the correct data type. A variable stored in the wrong type can cause silent errors. For example, a categorical variable stored as a numeric will be treated as a continuous measurement by statistical functions and machine learning algorithms, producing nonsensical results. We verify that each variable is correctly typed before proceeding.</p>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Check data types of all columns ---</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>data_types <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), class)) <span class="sc">%&gt;%</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(),</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to  =</span> <span class="st">"Variable"</span>,</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"Data_Type"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Expected_Type =</span> <span class="fu">c</span>(<span class="st">"Factor"</span>, <span class="st">"Numeric"</span>, <span class="st">"Numeric"</span>, <span class="st">"Numeric"</span>, <span class="st">"Factor"</span>),</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Status =</span> <span class="fu">ifelse</span>(Data_Type <span class="sc">==</span> <span class="fu">c</span>(<span class="st">"factor"</span>, <span class="st">"numeric"</span>, </span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"numeric"</span>, <span class="st">"numeric"</span>, <span class="st">"factor"</span>),</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"✔ Correct"</span>, <span class="st">"✘ Incorrect"</span>)</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Display as clean table ---</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>data_types <span class="sc">%&gt;%</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Variable"</span>, <span class="st">"Current Type"</span>, <span class="st">"Expected Type"</span>, <span class="st">"Status"</span>),</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption   =</span> <span class="st">"Table: Data Types Validation"</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small">
<caption>Table: Data Types Validation</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Variable</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Current Type</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Expected Type</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Status</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">channel</td>
<td style="text-align: left;">factor</td>
<td style="text-align: left;">Factor</td>
<td style="text-align: left;">✔ Correct</td>
</tr>
<tr class="even">
<td style="text-align: left;">age</td>
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">Numeric</td>
<td style="text-align: left;">✔ Correct</td>
</tr>
<tr class="odd">
<td style="text-align: left;">items</td>
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">Numeric</td>
<td style="text-align: left;">✔ Correct</td>
</tr>
<tr class="even">
<td style="text-align: left;">amount</td>
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">Numeric</td>
<td style="text-align: left;">✔ Correct</td>
</tr>
<tr class="odd">
<td style="text-align: left;">region</td>
<td style="text-align: left;">factor</td>
<td style="text-align: left;">Factor</td>
<td style="text-align: left;">✔ Correct</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="interpretation-3" class="level3" data-number="2.4.1">
<h3 data-number="2.4.1" class="anchored" data-anchor-id="interpretation-3"><span class="header-section-number">2.4.1</span> Interpretation</h3>
<p>All five variables are correctly typed:</p>
<ul>
<li><p><strong>Channel</strong> and <strong>Region</strong> are stored as factors, meaning R treats them as discrete categories rather than continuous numbers. This is critical, for without this, a region coded 1 to 4 would be interpreted as a measurement where West (4) is somehow “greater than” North (1), which is meaningless.</p></li>
<li><p><strong>Age</strong>, <strong>Items</strong>, and <strong>Amount</strong> are stored as numeric, which is appropriate as they represent measurable quantities that can be averaged, summed, and used in regression models.</p></li>
</ul>
<p>No data type corrections are required. We proceed to outlier detection.</p>
</section>
</section>
<section id="outlier-detection" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="outlier-detection"><span class="header-section-number">2.5</span> Outlier Detection</h2>
<p>Outliers are observations that fall unusually far from the rest of the data. They can arise from genuine extreme behaviour, such as a customer making a very large purchase or from data entry errors. Either way, they require careful investigation because they can heavily distort statistical measures like the mean, and can negatively impact the performance of machine learning models.</p>
<p>We use two complementary approaches to detect outliers:</p>
<ol type="1">
<li><strong>Visual inspection</strong>: boxplots to see the distribution of each numeric variable and immediately spot extreme values</li>
<li><strong>The IQR Method</strong>: a statistical rule that flags any observation falling below Q1 − 1.5×IQR or above Q3 + 1.5×IQR as a potential outlier. This is the industry standard for outlier detection.</li>
</ol>
<p>We examine the three numeric variables: <strong>age</strong>, <strong>items</strong>, and <strong>amount</strong>.</p>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Define a consistent colour palette ---</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>palette <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"age"</span>    <span class="ot">=</span> <span class="st">"#00d4ff"</span>,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"items"</span>  <span class="ot">=</span> <span class="st">"#7b61ff"</span>,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"amount"</span> <span class="ot">=</span> <span class="st">"#f0c040"</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Reshape data for faceted boxplots ---</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>df_long <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(age, items, amount) <span class="sc">%&gt;%</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(),</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to  =</span> <span class="st">"Variable"</span>,</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"Value"</span>)</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Boxplots ---</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_long, <span class="fu">aes</span>(<span class="at">x =</span> Variable, <span class="at">y =</span> Value, <span class="at">fill =</span> Variable)) <span class="sc">+</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.colour =</span> <span class="st">"#ff4d4d"</span>,</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>               <span class="at">outlier.alpha  =</span> <span class="fl">0.3</span>,</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>               <span class="at">outlier.size   =</span> <span class="fl">0.8</span>,</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>               <span class="at">width          =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Variable, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">nrow =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> palette) <span class="sc">+</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">title    =</span> <span class="st">"Figure: Boxplot Distribution of Numeric Variables"</span>,</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Red dots indicate potential outliers flagged by the IQR method"</span>,</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">x        =</span> <span class="cn">NULL</span>,</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">y        =</span> <span class="st">"Value"</span></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">13</span>) <span class="sc">+</span></span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background    =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#0a0a0f"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background   =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#12121a"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major   =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#2a2a3a"</span>),</span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor   =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background   =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#1a1a2e"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text         =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#00d4ff"</span>, </span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">face  =</span> <span class="st">"bold"</span>, </span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">size  =</span> <span class="dv">10</span>),</span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title         =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#ffffff"</span>, </span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">face  =</span> <span class="st">"bold"</span>, </span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">size  =</span> <span class="dv">13</span>),</span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle      =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text          =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>),</span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title         =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>),</span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position    =</span> <span class="st">"none"</span></span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="blackwell-customer-analytics_files/figure-html/outlier-detection-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- IQR Method: Count outliers per variable ---</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>count_outliers <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  Q1  <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x, <span class="fl">0.25</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  Q3  <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x, <span class="fl">0.75</span>)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  IQR <span class="ot">&lt;-</span> Q3 <span class="sc">-</span> Q1</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(x <span class="sc">&lt;</span> (Q1 <span class="sc">-</span> <span class="fl">1.5</span> <span class="sc">*</span> IQR) <span class="sc">|</span> x <span class="sc">&gt;</span> (Q3 <span class="sc">+</span> <span class="fl">1.5</span> <span class="sc">*</span> IQR))</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>outlier_summary <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">Age    =</span> <span class="fu">count_outliers</span>(age),</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">Items  =</span> <span class="fu">count_outliers</span>(items),</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">Amount =</span> <span class="fu">count_outliers</span>(amount)</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(),</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to  =</span> <span class="st">"Variable"</span>,</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"Outlier_Count"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Rows      =</span> <span class="fu">nrow</span>(df),</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">Outlier_Percent =</span> <span class="fu">round</span>((Outlier_Count <span class="sc">/</span> Total_Rows) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>)</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Display outlier summary table ---</span></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>outlier_summary <span class="sc">%&gt;%</span></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Variable"</span>, <span class="st">"Outlier Count"</span>, </span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Total Rows"</span>, <span class="st">"Outliers (%)"</span>),</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption   =</span> <span class="st">"Table: Outlier Count by Variable (IQR Method)"</span></span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small">
<caption>Table: Outlier Count by Variable (IQR Method)</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Variable</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Outlier Count</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Total Rows</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Outliers (%)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Age</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">79979</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Items</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">79979</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Amount</td>
<td style="text-align: right;">2320</td>
<td style="text-align: right;">79979</td>
<td style="text-align: right;">2.9</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="interpretation-4" class="level3" data-number="2.5.1">
<h3 data-number="2.5.1" class="anchored" data-anchor-id="interpretation-4"><span class="header-section-number">2.5.1</span> Interpretation</h3>
<p>The boxplots and IQR analysis reveal a clear and important finding:</p>
<ul>
<li><p><strong>Age</strong>: Zero outliers detected. The age range of 18 to 85 years is entirely plausible for a retail electronics customer base. The distribution is clean and requires no intervention.</p></li>
<li><p><strong>Items</strong> : Zero outliers detected. With a natural ceiling of 8 items per transaction, this variable is tightly bounded and consistent throughout the dataset.</p></li>
<li><p><strong>Amount</strong> : <strong>2,320 outliers detected, representing 2.9% of all transactions.</strong> The boxplot clearly shows a right-skewed distribution, with a cluster of transactions at the higher end of the spending range pulling the mean ($835.92) significantly above the median ($582.32). These are transactions where customers spent considerably more than the typical customer.</p></li>
</ul>
<p>The critical question is: are these outliers errors, or are they real? In an electronics retail context, high-value transactions are entirely plausible. A customer purchasing a high-end television, laptop, or multiple premium devices in a single transaction could legitimately spend at the upper end of the range. The minimum amount of $5.00 and maximum of $3,000.00 are both realistic for an electronics retailer.</p>
<p>These outliers are therefore likely <strong>genuine extreme values</strong> rather than data entry errors, and the decision of how to treat them will be addressed in the next step.</p>
</section>
</section>
<section id="outlier-treatment" class="level2" data-number="2.6">
<h2 data-number="2.6" class="anchored" data-anchor-id="outlier-treatment"><span class="header-section-number">2.6</span> Outlier Treatment</h2>
<p>Having identified 2,320 outliers in the <code>amount</code> variable, we must now decide how to handle them. There are three common approaches:</p>
<ol type="1">
<li><p><strong>Remove them</strong>: delete all flagged rows from the dataset. This is appropriate when outliers are confirmed errors. However, removing 2.9% of genuine transactions would mean discarding real customer behaviour and potentially biasing our analysis against high-value customers.</p></li>
<li><p><strong>Cap them (Winsorisation)</strong>: replace values beyond the IQR boundaries with the boundary value itself. This retains all records but reduces the influence of extreme values.</p></li>
<li><p><strong>Retain them</strong>: keep the outliers as-is, on the basis that they represent genuine behaviour. This is appropriate when the data generating process naturally produces extreme values.</p></li>
</ol>
<p>Given the business context, an electronics retailer where high-value purchases are entirely expected, a <strong>retain and document</strong> strategy is adopted. The outliers in <code>amount</code> reflect real purchasing behaviour from high-spending customers, which is precisely the kind of insight Blackwell’s marketing team needs to understand. Removing or capping these values would obscure an important segment of their customer base.</p>
<p>However, to ensure the statistical models are not unduly distorted, a <strong>log transformation</strong> is applied to <code>amount</code> where appropriate during the modelling phase. For now, the outliers is documented and proceed with the full dataset intact.</p>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Define IQR boundaries for amount ---</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>Q1  <span class="ot">&lt;-</span> <span class="fu">quantile</span>(df<span class="sc">$</span>amount, <span class="fl">0.25</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>Q3  <span class="ot">&lt;-</span> <span class="fu">quantile</span>(df<span class="sc">$</span>amount, <span class="fl">0.75</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>IQR <span class="ot">&lt;-</span> Q3 <span class="sc">-</span> Q1</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>lower_bound <span class="ot">&lt;-</span> Q1 <span class="sc">-</span> <span class="fl">1.5</span> <span class="sc">*</span> IQR</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>upper_bound <span class="ot">&lt;-</span> Q3 <span class="sc">+</span> <span class="fl">1.5</span> <span class="sc">*</span> IQR</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Amount IQR Boundaries:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Amount IQR Boundaries:</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Lower Bound: $"</span>, <span class="fu">round</span>(lower_bound, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Lower Bound: $ -1137.3 </code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Upper Bound: $"</span>, <span class="fu">round</span>(upper_bound, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Upper Bound: $ 2655.82 </code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Outliers below lower bound:"</span>, <span class="fu">sum</span>(df<span class="sc">$</span>amount <span class="sc">&lt;</span> lower_bound), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Outliers below lower bound: 0 </code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Outliers above upper bound:"</span>, <span class="fu">sum</span>(df<span class="sc">$</span>amount <span class="sc">&gt;</span> upper_bound), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Outliers above upper bound: 2320 </code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Decision: Retain outliers ---</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="co"># We retain all records. Log-transformed amount created for </span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co"># modelling use later.</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">amount_log =</span> <span class="fu">log1p</span>(amount))</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Log-transformed amount column added.</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Log-transformed amount column added.</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Final dataset dimensions:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Final dataset dimensions:</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Rows:"</span>, <span class="fu">nrow</span>(df), <span class="st">"| Columns:"</span>, <span class="fu">ncol</span>(df), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Rows: 79979 | Columns: 6 </code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Visual: Original vs Log-transformed amount ---</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> amount)) <span class="sc">+</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">"#f0c040"</span>, <span class="at">color =</span> <span class="cn">NA</span>, <span class="at">bins =</span> <span class="dv">60</span>, <span class="at">alpha =</span> <span class="fl">0.85</span>) <span class="sc">+</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Original Amount"</span>, <span class="at">x =</span> <span class="st">"Amount ($)"</span>, <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">11</span>) <span class="sc">+</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background  =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#0a0a0f"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#12121a"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#2a2a3a"</span>),</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title       =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#ffffff"</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text        =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>),</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title       =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>)</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> amount_log)) <span class="sc">+</span></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">"#00d4ff"</span>, <span class="at">color =</span> <span class="cn">NA</span>, <span class="at">bins =</span> <span class="dv">60</span>, <span class="at">alpha =</span> <span class="fl">0.85</span>) <span class="sc">+</span></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Log-Transformed Amount"</span>, <span class="at">x =</span> <span class="st">"Log(Amount + 1)"</span>, <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">11</span>) <span class="sc">+</span></span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background  =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#0a0a0f"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#12121a"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#2a2a3a"</span>),</span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title       =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#ffffff"</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text        =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>),</span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title       =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>)</span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Display side by side ---</span></span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span></span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">title   =</span> <span class="st">"Figure : Amount Distribution: Original vs Log-Transformed"</span>,</span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Log transformation compresses the right skew for modelling use"</span>,</span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">theme   =</span> <span class="fu">theme</span>(</span>
<span id="cb33-37"><a href="#cb33-37" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#0a0a0f"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb33-38"><a href="#cb33-38" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title      =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#ffffff"</span>, </span>
<span id="cb33-39"><a href="#cb33-39" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb33-40"><a href="#cb33-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.subtitle   =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>, <span class="at">size =</span> <span class="dv">10</span>)</span>
<span id="cb33-41"><a href="#cb33-41" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb33-42"><a href="#cb33-42" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="blackwell-customer-analytics_files/figure-html/outlier-treatment-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<section id="interpretation-5" class="level3" data-number="2.6.1">
<h3 data-number="2.6.1" class="anchored" data-anchor-id="interpretation-5"><span class="header-section-number">2.6.1</span> Interpretation</h3>
<p>The IQR analysis calculates a lower bound of <strong>-$1,137.30</strong> and an upper bound of <strong>$2,655.82</strong> for the <code>amount</code> variable.</p>
<p>The negative lower bound is mathematically produced by the IQR formula but is practically meaningless in this context, a transaction amount cannot be negative. This tells us that the data is heavily right-skewed, causing the IQR formula to push the lower boundary into impossible territory. Unsurprisingly, zero outliers were detected below the lower bound.</p>
<p>All 2,320 outliers fall <strong>above</strong> the upper bound of $2,655.82. These are high-value transactions where customers spent between $2,655.82 and $3,000.00 in a single purchase. In the context of an electronics retailer, this is entirely plausible. A customer purchasing a premium laptop, large-screen television, or multiple devices in one transaction could easily reach this spending level.</p>
<p>The original distribution histogram confirms the right skew clearly, the majority of transactions cluster at lower amounts, with a long tail stretching toward $3,000.</p>
<p>The log-transformed distribution, however, does not produce the smooth bell curve typically expected. Instead it reveals a <strong>multimodal pattern</strong>, multiple peaks across the distribution, suggesting that customer spending may naturally cluster around distinct price points. This is actually a meaningful business insight in itself: Blackwell’s customers do not spend randomly across a continuous range, but appear to gravitate toward particular spending brackets, possibly corresponding to different product categories such as accessories, mid-range electronics, and premium devices.</p>
<p>While the log transformation reduces the right skew, the multimodal nature of the data means it will not perfectly satisfy the normality assumptions of some statistical models. This will be kept in mind during the modelling phase.</p>
<p>All <strong>79,979 records are retained</strong>. The dataset is now fully preprocessed and ready for exploratory data analysis.</p>
</section>
</section>
<section id="preprocessing-summary" class="level2" data-number="2.7">
<h2 data-number="2.7" class="anchored" data-anchor-id="preprocessing-summary"><span class="header-section-number">2.7</span> Preprocessing Summary</h2>
<p>This section summarises every step taken during the preprocessing phase. A clean, documented audit trail of data preparation decisions is a hallmark of professional analytical work. It ensures transparency, reproducibility, and gives any reader full confidence in the integrity of the dataset before conclusions are drawn.</p>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Build the preprocessing audit table ---</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>preprocessing_log <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Step =</span> <span class="fu">c</span>(</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"1. Data Inspection"</span>,</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"2. Missing Values"</span>,</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"3. Duplicate Records"</span>,</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"4. Data Types Validation"</span>,</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"5. Outlier Detection"</span>,</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"6. Outlier Treatment"</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">Finding =</span> <span class="fu">c</span>(</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">"80,000 rows, 5 columns. All variables present and accounted for."</span>,</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Zero missing values detected across all 5 columns."</span>,</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">"21 exact duplicate rows identified."</span>,</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"All variables correctly typed; channel &amp; region as factors, age, items &amp; amount as numeric."</span>,</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">"2,320 outliers detected in amount (2.9%). Zero outliers in age and items."</span>,</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Outliers retained — consistent with electronics retail context. Log transformation applied to amount."</span></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">Action_Taken =</span> <span class="fu">c</span>(</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">"No action required."</span>,</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">"No action required."</span>,</span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">"21 duplicate rows removed. Dataset reduced to 79,979 records."</span>,</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">"No action required."</span>,</span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">"No action required. Outliers confirmed as genuine high-value transactions."</span>,</span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">"amount_log column added. All 79,979 records retained."</span></span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">Status =</span> <span class="fu">c</span>(</span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">"✔ Complete"</span>,</span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a>    <span class="st">"✔ Complete"</span>,</span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a>    <span class="st">"✔ Complete"</span>,</span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a>    <span class="st">"✔ Complete"</span>,</span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a>    <span class="st">"✔ Complete"</span>,</span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a>    <span class="st">"✔ Complete"</span></span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Display as styled table ---</span></span>
<span id="cb34-38"><a href="#cb34-38" aria-hidden="true" tabindex="-1"></a>preprocessing_log <span class="sc">%&gt;%</span></span>
<span id="cb34-39"><a href="#cb34-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(</span>
<span id="cb34-40"><a href="#cb34-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Step"</span>, <span class="st">"Finding"</span>, <span class="st">"Action Taken"</span>, <span class="st">"Status"</span>),</span>
<span id="cb34-41"><a href="#cb34-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption   =</span> <span class="st">"Table: Data Preprocessing Audit Log"</span></span>
<span id="cb34-42"><a href="#cb34-42" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb34-43"><a href="#cb34-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-44"><a href="#cb34-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"#00d4ff"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-45"><a href="#cb34-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">4</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"#00d4ff"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small">
<caption>Table: Data Preprocessing Audit Log</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Step</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Finding</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Action Taken</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Status</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; font-weight: bold; color: rgba(0, 212, 255, 255) !important;">1. Data Inspection</td>
<td style="text-align: left;">80,000 rows, 5 columns. All variables present and accounted for.</td>
<td style="text-align: left;">No action required.</td>
<td style="text-align: left; font-weight: bold; color: rgba(0, 212, 255, 255) !important;">✔ Complete</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold; color: rgba(0, 212, 255, 255) !important;">2. Missing Values</td>
<td style="text-align: left;">Zero missing values detected across all 5 columns.</td>
<td style="text-align: left;">No action required.</td>
<td style="text-align: left; font-weight: bold; color: rgba(0, 212, 255, 255) !important;">✔ Complete</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold; color: rgba(0, 212, 255, 255) !important;">3. Duplicate Records</td>
<td style="text-align: left;">21 exact duplicate rows identified.</td>
<td style="text-align: left;">21 duplicate rows removed. Dataset reduced to 79,979 records.</td>
<td style="text-align: left; font-weight: bold; color: rgba(0, 212, 255, 255) !important;">✔ Complete</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold; color: rgba(0, 212, 255, 255) !important;">4. Data Types Validation</td>
<td style="text-align: left;">All variables correctly typed; channel &amp; region as factors, age, items &amp; amount as numeric.</td>
<td style="text-align: left;">No action required.</td>
<td style="text-align: left; font-weight: bold; color: rgba(0, 212, 255, 255) !important;">✔ Complete</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold; color: rgba(0, 212, 255, 255) !important;">5. Outlier Detection</td>
<td style="text-align: left;">2,320 outliers detected in amount (2.9%). Zero outliers in age and items.</td>
<td style="text-align: left;">No action required. Outliers confirmed as genuine high-value transactions.</td>
<td style="text-align: left; font-weight: bold; color: rgba(0, 212, 255, 255) !important;">✔ Complete</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold; color: rgba(0, 212, 255, 255) !important;">6. Outlier Treatment</td>
<td style="text-align: left;">Outliers retained — consistent with electronics retail context. Log transformation applied to amount.</td>
<td style="text-align: left;">amount_log column added. All 79,979 records retained.</td>
<td style="text-align: left; font-weight: bold; color: rgba(0, 212, 255, 255) !important;">✔ Complete</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="clean-dataset-ready-for-analysis" class="level2" data-number="2.8">
<h2 data-number="2.8" class="anchored" data-anchor-id="clean-dataset-ready-for-analysis"><span class="header-section-number">2.8</span> Clean Dataset, Ready for Analysis</h2>
<p>The preprocessing phase is now complete. The following summarises the final state of the dataset entering the analysis phase:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Attribute</th>
<th>Detail</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Total Records</td>
<td>79,979 transactions</td>
</tr>
<tr class="even">
<td>Total Variables</td>
<td>6 (including amount_log)</td>
</tr>
<tr class="odd">
<td>Missing Values</td>
<td>None</td>
</tr>
<tr class="even">
<td>Duplicates</td>
<td>Removed (21 rows)</td>
</tr>
<tr class="odd">
<td>Outliers</td>
<td>Retained &amp; documented</td>
</tr>
<tr class="even">
<td>Data Types</td>
<td>All correctly assigned</td>
</tr>
</tbody>
</table>
<p>The dataset is clean, validated, and fully documented. We now proceed to <strong>Exploratory Data Analysis</strong>, where we begin to answer the business questions posed by Danielle Sherman and Martin Goodrich.</p>
</section>
</section>
<section id="exploratory-data-analysis" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Exploratory Data Analysis</h1>
<p>With a clean, validated dataset in hand, this analysis now turns to Exploratory Data Analysis (EDA), the process of visually and statistically examining the data to uncover patterns, relationships, and insights that directly address the business questions posed by Danielle Sherman and Martin Goodrich.</p>
<p>EDA is not simply about producing charts. It is about telling a story with data, understanding who Blackwell’s customers are, how they behave, and what factors drive their purchasing decisions. Every visualisation in this section is intentional and directly linked to a specific business question from the brief.</p>
<p>This EDA is structured around five key themes:</p>
<ol type="1">
<li><p><strong>Regional Spending Patterns</strong>: Which regions spend the most and least per transaction? This directly addresses Danielle’s first question about whether geography influences spending behaviour.</p></li>
<li><p><strong>Items vs Amount</strong>: Is there a relationship between the number of items purchased and the amount spent? A pattern here could inform decisions around bundling, promotions, and upselling.</p></li>
<li><p><strong>Customer Age &amp; Spending</strong>: How does customer age relate to transaction amount? This directly investigates Martin Goodrich’s hypothesis that older customers spend more on electronics than younger customers.</p></li>
<li><p><strong>Purchase Channel Analysis</strong>: How do online and in-store customers differ in age and spending behaviour? This addresses Martin’s second hypothesis that in-store customers tend to be older than online customers, a claim with significant implications for website design and digital marketing strategy.</p></li>
<li><p><strong>Age Differences Across Regions</strong>: Are there meaningful differences in the age profile of customers across the four regions? This addresses Danielle’s question about whether region can be predicted from demographic data, and lays the foundation for the predictive modelling section that follows.</p></li>
</ol>
<p>Together, these five analyses form a comprehensive picture of Blackwell’s customer base, one that will directly inform the marketing, website, and business strategy decisions under consideration by the leadership team.</p>
<section id="regional-spending-patterns" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="regional-spending-patterns"><span class="header-section-number">3.1</span> Regional Spending Patterns</h2>
<p>The first business question posed by Danielle is whether customers in different regions spend different amounts per transaction, and which regions spend the most and least. Understanding regional spending is critical for directing marketing budgets. It makes little sense to invest equally across all regions if some consistently generate higher transaction values than others.</p>
<p>Regional spending is examined here using three complementary views: a summary statistics table, a bar chart of mean spending by region, and a boxplot showing the full distribution of spending per region.</p>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Summary statistics by region ---</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>regional_summary <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(region) <span class="sc">%&gt;%</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Transactions =</span> <span class="fu">n</span>(),</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mean_Amount  =</span> <span class="fu">round</span>(<span class="fu">mean</span>(amount), <span class="dv">2</span>),</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Median_Amount =</span> <span class="fu">round</span>(<span class="fu">median</span>(amount), <span class="dv">2</span>),</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">SD_Amount    =</span> <span class="fu">round</span>(<span class="fu">sd</span>(amount), <span class="dv">2</span>),</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Min_Amount   =</span> <span class="fu">round</span>(<span class="fu">min</span>(amount), <span class="dv">2</span>),</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Max_Amount   =</span> <span class="fu">round</span>(<span class="fu">max</span>(amount), <span class="dv">2</span>)</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Mean_Amount))</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Display summary table ---</span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>regional_summary <span class="sc">%&gt;%</span></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Region"</span>, <span class="st">"Transactions"</span>, <span class="st">"Mean ($)"</span>, </span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Median ($)"</span>, <span class="st">"Std Dev ($)"</span>, </span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Min ($)"</span>, <span class="st">"Max ($)"</span>),</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption   =</span> <span class="st">"Table: Regional Spending Summary Statistics"</span></span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"#00d4ff"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="dv">1</span>, <span class="at">background =</span> <span class="st">"rgba(0, 212, 255, 0.08)"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small">
<caption>Table: Regional Spending Summary Statistics</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Region</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Transactions</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Mean ($)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Median ($)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Std Dev ($)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Min ($)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Max ($)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; font-weight: bold; color: rgba(0, 212, 255, 255) !important; background-color: rgba(0, 212, 255, 0.08) !important;">West</td>
<td style="text-align: right; background-color: rgba(0, 212, 255, 0.08) !important;">25988</td>
<td style="text-align: right; background-color: rgba(0, 212, 255, 0.08) !important;">1283.94</td>
<td style="text-align: right; background-color: rgba(0, 212, 255, 0.08) !important;">1230.25</td>
<td style="text-align: right; background-color: rgba(0, 212, 255, 0.08) !important;">756.30</td>
<td style="text-align: right; background-color: rgba(0, 212, 255, 0.08) !important;">50.60</td>
<td style="text-align: right; background-color: rgba(0, 212, 255, 0.08) !important;">3000.00</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold; color: rgba(0, 212, 255, 255) !important;">East</td>
<td style="text-align: right;">18000</td>
<td style="text-align: right;">917.97</td>
<td style="text-align: right;">697.82</td>
<td style="text-align: right;">751.41</td>
<td style="text-align: right;">50.13</td>
<td style="text-align: right;">3000.00</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold; color: rgba(0, 212, 255, 255) !important;">North</td>
<td style="text-align: right;">15997</td>
<td style="text-align: right;">744.99</td>
<td style="text-align: right;">662.86</td>
<td style="text-align: right;">492.99</td>
<td style="text-align: right;">50.05</td>
<td style="text-align: right;">1999.80</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold; color: rgba(0, 212, 255, 255) !important;">South</td>
<td style="text-align: right;">19994</td>
<td style="text-align: right;">252.10</td>
<td style="text-align: right;">250.20</td>
<td style="text-align: right;">142.68</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: right;">499.94</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Region colour palette ---</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>region_palette <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"North"</span> <span class="ot">=</span> <span class="st">"#00d4ff"</span>,</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"South"</span> <span class="ot">=</span> <span class="st">"#7b61ff"</span>,</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"East"</span>  <span class="ot">=</span> <span class="st">"#f0c040"</span>,</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"West"</span>  <span class="ot">=</span> <span class="st">"#ff6b6b"</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Bar chart: Mean spending by region ---</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> regional_summary <span class="sc">%&gt;%</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(region, Mean_Amount), </span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> Mean_Amount, </span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> region)) <span class="sc">+</span></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">width =</span> <span class="fl">0.6</span>, <span class="at">alpha =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">format</span>(Mean_Amount, <span class="at">big.mark =</span> <span class="st">","</span>))),</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust   =</span> <span class="sc">-</span><span class="fl">0.1</span>,</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">color   =</span> <span class="st">"#e8e8e8"</span>,</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">size    =</span> <span class="fl">3.8</span>,</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> region_palette) <span class="sc">+</span></span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">dollar_format</span>(),</span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>))</span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">title    =</span> <span class="st">"Mean Transaction Amount by Region"</span>,</span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"West region leads in average spend per transaction"</span>,</span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">x        =</span> <span class="cn">NULL</span>,</span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">y        =</span> <span class="st">"Mean Amount ($)"</span></span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background  =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#0a0a0f"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#12121a"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb36-36"><a href="#cb36-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb36-37"><a href="#cb36-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#2a2a3a"</span>),</span>
<span id="cb36-38"><a href="#cb36-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb36-39"><a href="#cb36-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title       =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#ffffff"</span>, </span>
<span id="cb36-40"><a href="#cb36-40" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">face  =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb36-41"><a href="#cb36-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle    =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb36-42"><a href="#cb36-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text        =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>),</span>
<span id="cb36-43"><a href="#cb36-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title       =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>),</span>
<span id="cb36-44"><a href="#cb36-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position  =</span> <span class="st">"none"</span></span>
<span id="cb36-45"><a href="#cb36-45" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb36-46"><a href="#cb36-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-47"><a href="#cb36-47" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Boxplot: Full distribution by region ---</span></span>
<span id="cb36-48"><a href="#cb36-48" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb36-49"><a href="#cb36-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(region, amount, <span class="at">FUN =</span> mean),</span>
<span id="cb36-50"><a href="#cb36-50" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> amount,</span>
<span id="cb36-51"><a href="#cb36-51" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> region)) <span class="sc">+</span></span>
<span id="cb36-52"><a href="#cb36-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.colour =</span> <span class="st">"#ff4d4d"</span>,</span>
<span id="cb36-53"><a href="#cb36-53" aria-hidden="true" tabindex="-1"></a>               <span class="at">outlier.alpha  =</span> <span class="fl">0.2</span>,</span>
<span id="cb36-54"><a href="#cb36-54" aria-hidden="true" tabindex="-1"></a>               <span class="at">outlier.size   =</span> <span class="fl">0.6</span>,</span>
<span id="cb36-55"><a href="#cb36-55" aria-hidden="true" tabindex="-1"></a>               <span class="at">width          =</span> <span class="fl">0.5</span>,</span>
<span id="cb36-56"><a href="#cb36-56" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha          =</span> <span class="fl">0.85</span>) <span class="sc">+</span></span>
<span id="cb36-57"><a href="#cb36-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> region_palette) <span class="sc">+</span></span>
<span id="cb36-58"><a href="#cb36-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">dollar_format</span>()) <span class="sc">+</span></span>
<span id="cb36-59"><a href="#cb36-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb36-60"><a href="#cb36-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb36-61"><a href="#cb36-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">title    =</span> <span class="st">"Spending Distribution by Region"</span>,</span>
<span id="cb36-62"><a href="#cb36-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Red dots indicate high-value transactions"</span>,</span>
<span id="cb36-63"><a href="#cb36-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">x        =</span> <span class="cn">NULL</span>,</span>
<span id="cb36-64"><a href="#cb36-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">y        =</span> <span class="st">"Transaction Amount ($)"</span></span>
<span id="cb36-65"><a href="#cb36-65" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb36-66"><a href="#cb36-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb36-67"><a href="#cb36-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb36-68"><a href="#cb36-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background  =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#0a0a0f"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb36-69"><a href="#cb36-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#12121a"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb36-70"><a href="#cb36-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb36-71"><a href="#cb36-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#2a2a3a"</span>),</span>
<span id="cb36-72"><a href="#cb36-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb36-73"><a href="#cb36-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title       =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#ffffff"</span>, </span>
<span id="cb36-74"><a href="#cb36-74" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">face  =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb36-75"><a href="#cb36-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle    =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb36-76"><a href="#cb36-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text        =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>),</span>
<span id="cb36-77"><a href="#cb36-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title       =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>),</span>
<span id="cb36-78"><a href="#cb36-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position  =</span> <span class="st">"none"</span></span>
<span id="cb36-79"><a href="#cb36-79" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb36-80"><a href="#cb36-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-81"><a href="#cb36-81" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Display side by side ---</span></span>
<span id="cb36-82"><a href="#cb36-82" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span></span>
<span id="cb36-83"><a href="#cb36-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb36-84"><a href="#cb36-84" aria-hidden="true" tabindex="-1"></a>    <span class="at">title   =</span> <span class="st">"Figure : Regional Spending Analysis"</span>,</span>
<span id="cb36-85"><a href="#cb36-85" aria-hidden="true" tabindex="-1"></a>    <span class="at">theme   =</span> <span class="fu">theme</span>(</span>
<span id="cb36-86"><a href="#cb36-86" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#0a0a0f"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb36-87"><a href="#cb36-87" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title      =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#ffffff"</span>, </span>
<span id="cb36-88"><a href="#cb36-88" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">face  =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">13</span>)</span>
<span id="cb36-89"><a href="#cb36-89" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb36-90"><a href="#cb36-90" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="blackwell-customer-analytics_files/figure-html/regional-spending-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<section id="interpretation-6" class="level3" data-number="3.1.1">
<h3 data-number="3.1.1" class="anchored" data-anchor-id="interpretation-6"><span class="header-section-number">3.1.1</span> Interpretation</h3>
<p>Regional spending varies considerably across Blackwell’s customer base. The West leads with a mean transaction value of <strong>$1,283.94</strong>, followed by East ($917.97), North ($744.99), and South ($252.10).</p>
<p>Most notably, the South region’s maximum transaction value is just <strong>$499.94</strong>, a ceiling no other region comes close to, suggesting Southern customers are exclusively purchasing lower-range products with no high-value purchasing behaviour present at all.</p>
<p><strong>Recommendation:</strong> Premium campaigns should target the West and East. The South requires a value-oriented strategy, and further investigation into why high-value purchases are entirely absent from this region.</p>
</section>
</section>
<section id="items-vs-amount-relationship" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="items-vs-amount-relationship"><span class="header-section-number">3.2</span> Items vs Amount Relationship</h2>
<p>A key question for Blackwell’s sales strategy is whether customers who purchase more items in a single transaction also spend more money. If a strong positive relationship exists, it would support strategies such as bundling, cross-selling, and volume discounts to drive revenue. The relationship between items purchased and transaction amount is examined here using a scatter plot and a correlation analysis.</p>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Pearson Correlation ---</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>correlation <span class="ot">&lt;-</span> <span class="fu">cor</span>(df<span class="sc">$</span>items, df<span class="sc">$</span>amount, <span class="at">method =</span> <span class="st">"pearson"</span>)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Pearson Correlation (items vs amount):"</span>, <span class="fu">round</span>(correlation, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Pearson Correlation (items vs amount): 4e-04 </code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Scatter plot with trend line ---</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> items, <span class="at">y =</span> amount)) <span class="sc">+</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">alpha =</span> <span class="fl">0.08</span>, <span class="at">color =</span> <span class="st">"#00d4ff"</span>, <span class="at">size =</span> <span class="fl">0.6</span>, <span class="at">width =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">color =</span> <span class="st">"#f0c040"</span>, </span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">dollar_format</span>()) <span class="sc">+</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">title    =</span> <span class="st">"Items Purchased vs Transaction Amount"</span>,</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">paste0</span>(<span class="st">"Pearson r = "</span>, <span class="fu">round</span>(correlation, <span class="dv">4</span>),</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>                      <span class="st">" — negligible linear relationship"</span>),</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">x        =</span> <span class="st">"Number of Items Purchased"</span>,</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">y        =</span> <span class="st">"Transaction Amount ($)"</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background  =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#0a0a0f"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#12121a"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#2a2a3a"</span>),</span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title       =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#ffffff"</span>, </span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">face  =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle    =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text        =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>),</span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title       =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>)</span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Boxplot: Amount distribution per item count ---</span></span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(items), <span class="at">y =</span> amount, <span class="at">fill =</span> <span class="fu">factor</span>(items))) <span class="sc">+</span></span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.colour =</span> <span class="st">"#ff4d4d"</span>,</span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a>               <span class="at">outlier.alpha  =</span> <span class="fl">0.2</span>,</span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a>               <span class="at">outlier.size   =</span> <span class="fl">0.6</span>,</span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a>               <span class="at">width          =</span> <span class="fl">0.6</span>,</span>
<span id="cb39-36"><a href="#cb39-36" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha          =</span> <span class="fl">0.85</span>) <span class="sc">+</span></span>
<span id="cb39-37"><a href="#cb39-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb39-38"><a href="#cb39-38" aria-hidden="true" tabindex="-1"></a>    <span class="st">"1"</span> <span class="ot">=</span> <span class="st">"#00d4ff"</span>, <span class="st">"2"</span> <span class="ot">=</span> <span class="st">"#7b61ff"</span>, <span class="st">"3"</span> <span class="ot">=</span> <span class="st">"#f0c040"</span>,</span>
<span id="cb39-39"><a href="#cb39-39" aria-hidden="true" tabindex="-1"></a>    <span class="st">"4"</span> <span class="ot">=</span> <span class="st">"#ff6b6b"</span>, <span class="st">"5"</span> <span class="ot">=</span> <span class="st">"#00ff9d"</span>, <span class="st">"6"</span> <span class="ot">=</span> <span class="st">"#ff9d00"</span>,</span>
<span id="cb39-40"><a href="#cb39-40" aria-hidden="true" tabindex="-1"></a>    <span class="st">"7"</span> <span class="ot">=</span> <span class="st">"#ff61d8"</span>, <span class="st">"8"</span> <span class="ot">=</span> <span class="st">"#61ffed"</span></span>
<span id="cb39-41"><a href="#cb39-41" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb39-42"><a href="#cb39-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">dollar_format</span>()) <span class="sc">+</span></span>
<span id="cb39-43"><a href="#cb39-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb39-44"><a href="#cb39-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">title    =</span> <span class="st">"Amount Distribution by Items Purchased"</span>,</span>
<span id="cb39-45"><a href="#cb39-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Spending spread is consistent regardless of item count"</span>,</span>
<span id="cb39-46"><a href="#cb39-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">x        =</span> <span class="st">"Number of Items Purchased"</span>,</span>
<span id="cb39-47"><a href="#cb39-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">y        =</span> <span class="st">"Transaction Amount ($)"</span></span>
<span id="cb39-48"><a href="#cb39-48" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb39-49"><a href="#cb39-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb39-50"><a href="#cb39-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb39-51"><a href="#cb39-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background  =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#0a0a0f"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb39-52"><a href="#cb39-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#12121a"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb39-53"><a href="#cb39-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#2a2a3a"</span>),</span>
<span id="cb39-54"><a href="#cb39-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb39-55"><a href="#cb39-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title       =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#ffffff"</span>, </span>
<span id="cb39-56"><a href="#cb39-56" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">face  =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb39-57"><a href="#cb39-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle    =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb39-58"><a href="#cb39-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text        =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>),</span>
<span id="cb39-59"><a href="#cb39-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title       =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>),</span>
<span id="cb39-60"><a href="#cb39-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position  =</span> <span class="st">"none"</span></span>
<span id="cb39-61"><a href="#cb39-61" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb39-62"><a href="#cb39-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-63"><a href="#cb39-63" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Display side by side ---</span></span>
<span id="cb39-64"><a href="#cb39-64" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span></span>
<span id="cb39-65"><a href="#cb39-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb39-66"><a href="#cb39-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Figure: Relationship Between Items Purchased &amp; Amount Spent"</span>,</span>
<span id="cb39-67"><a href="#cb39-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">theme =</span> <span class="fu">theme</span>(</span>
<span id="cb39-68"><a href="#cb39-68" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#0a0a0f"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb39-69"><a href="#cb39-69" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title      =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#ffffff"</span>,</span>
<span id="cb39-70"><a href="#cb39-70" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">face  =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">13</span>)</span>
<span id="cb39-71"><a href="#cb39-71" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb39-72"><a href="#cb39-72" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="blackwell-customer-analytics_files/figure-html/items-vs-amount-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<section id="interpretation-7" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="interpretation-7"><span class="header-section-number">3.2.1</span> Interpretation</h3>
<p>The Pearson correlation between items purchased and amount spent is virtually zero (r = 0.0004), confirming that <strong>no meaningful linear relationship exists</strong> between the two variables. The scatter plot and boxplots reinforce this: spending is widely and randomly distributed regardless of how many items a customer buys.</p>
<p><strong>Recommendation:</strong> Bundling and volume-based pricing strategies are unlikely to drive higher revenue. Spending appears to be driven by product type and price point rather than quantity purchased.</p>
</section>
</section>
<section id="customer-age-spending" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="customer-age-spending"><span class="header-section-number">3.3</span> Customer Age &amp; Spending</h2>
<p>Martin Goodrich hypothesises that older customers spend more on electronics than younger customers. This is a critical claim. If true, it would justify design changes to the website and targeted marketing campaigns aimed at older demographics. If false, such investments could be misdirected and costly.</p>
<p>This hypothesis is tested directly using a scatter plot of age against transaction amount, supported by a correlation analysis and a mean spending summary across age groups.</p>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Pearson Correlation: Age vs Amount ---</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>age_corr <span class="ot">&lt;-</span> <span class="fu">cor</span>(df<span class="sc">$</span>age, df<span class="sc">$</span>amount, <span class="at">method =</span> <span class="st">"pearson"</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Pearson Correlation (age vs amount):"</span>, <span class="fu">round</span>(age_corr, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Pearson Correlation (age vs amount): -0.282 </code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Create three age groups ---</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age_group =</span> <span class="fu">cut</span>(age,</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">17</span>, <span class="dv">39</span>, <span class="dv">59</span>, <span class="dv">85</span>),</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Young Adults (18-39)"</span>, </span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Middle-Aged (40-59)"</span>, </span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Senior (60+)"</span>)</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Mean spending by age group ---</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>age_group_summary <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(age_group) <span class="sc">%&gt;%</span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">Transactions  =</span> <span class="fu">n</span>(),</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mean_Amount   =</span> <span class="fu">round</span>(<span class="fu">mean</span>(amount), <span class="dv">2</span>),</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">Median_Amount =</span> <span class="fu">round</span>(<span class="fu">median</span>(amount), <span class="dv">2</span>)</span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Display summary table ---</span></span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>age_group_summary <span class="sc">%&gt;%</span></span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(</span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Age Group"</span>, <span class="st">"Transactions"</span>,</span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Mean ($)"</span>, <span class="st">"Median ($)"</span>),</span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption   =</span> <span class="st">"Table: Mean Spending by Age Group"</span></span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"#00d4ff"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small">
<caption>Table: Mean Spending by Age Group</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Age Group</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Transactions</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Mean ($)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Median ($)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; font-weight: bold; color: rgba(0, 212, 255, 255) !important;">Young Adults (18-39)</td>
<td style="text-align: right;">31194</td>
<td style="text-align: right;">991.08</td>
<td style="text-align: right;">808.51</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold; color: rgba(0, 212, 255, 255) !important;">Middle-Aged (40-59)</td>
<td style="text-align: right;">32535</td>
<td style="text-align: right;">869.77</td>
<td style="text-align: right;">633.12</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold; color: rgba(0, 212, 255, 255) !important;">Senior (60+)</td>
<td style="text-align: right;">16250</td>
<td style="text-align: right;">469.83</td>
<td style="text-align: right;">345.62</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Scatter plot: Age vs Amount ---</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> amount, <span class="at">color =</span> age_group)) <span class="sc">+</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.06</span>, <span class="at">size =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">color =</span> <span class="st">"#f0c040"</span>,</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Young Adults (18-39)"</span> <span class="ot">=</span> <span class="st">"#00d4ff"</span>,</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Middle-Aged (40-59)"</span>  <span class="ot">=</span> <span class="st">"#7b61ff"</span>,</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Senior (60+)"</span>         <span class="ot">=</span> <span class="st">"#ff6b6b"</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">dollar_format</span>()) <span class="sc">+</span></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">title    =</span> <span class="st">"Customer Age vs Transaction Amount"</span>,</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">paste0</span>(<span class="st">"Pearson r = "</span>, <span class="fu">round</span>(age_corr, <span class="dv">4</span>),</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>                      <span class="st">" — negligible relationship"</span>),</span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">x        =</span> <span class="st">"Customer Age"</span>,</span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">y        =</span> <span class="st">"Transaction Amount ($)"</span>,</span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">color    =</span> <span class="st">"Age Group"</span></span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background  =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#0a0a0f"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#12121a"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#2a2a3a"</span>),</span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title       =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#ffffff"</span>,</span>
<span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">face  =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb43-29"><a href="#cb43-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle    =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb43-30"><a href="#cb43-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text        =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>),</span>
<span id="cb43-31"><a href="#cb43-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title       =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>),</span>
<span id="cb43-32"><a href="#cb43-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title     =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>, <span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb43-33"><a href="#cb43-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text      =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>, <span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb43-34"><a href="#cb43-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#12121a"</span>, <span class="at">color =</span> <span class="cn">NA</span>)</span>
<span id="cb43-35"><a href="#cb43-35" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb43-36"><a href="#cb43-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-37"><a href="#cb43-37" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Bar chart: Mean spending by age group ---</span></span>
<span id="cb43-38"><a href="#cb43-38" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> age_group_summary <span class="sc">%&gt;%</span></span>
<span id="cb43-39"><a href="#cb43-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age_group, <span class="at">y =</span> Mean_Amount, <span class="at">fill =</span> age_group)) <span class="sc">+</span></span>
<span id="cb43-40"><a href="#cb43-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">width =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb43-41"><a href="#cb43-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">format</span>(Mean_Amount, <span class="at">big.mark =</span> <span class="st">","</span>))),</span>
<span id="cb43-42"><a href="#cb43-42" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust    =</span> <span class="sc">-</span><span class="fl">0.5</span>,</span>
<span id="cb43-43"><a href="#cb43-43" aria-hidden="true" tabindex="-1"></a>            <span class="at">color    =</span> <span class="st">"#e8e8e8"</span>,</span>
<span id="cb43-44"><a href="#cb43-44" aria-hidden="true" tabindex="-1"></a>            <span class="at">size     =</span> <span class="fl">3.8</span>,</span>
<span id="cb43-45"><a href="#cb43-45" aria-hidden="true" tabindex="-1"></a>            <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb43-46"><a href="#cb43-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb43-47"><a href="#cb43-47" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Young Adults (18-39)"</span> <span class="ot">=</span> <span class="st">"#00d4ff"</span>,</span>
<span id="cb43-48"><a href="#cb43-48" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Middle-Aged (40-59)"</span>  <span class="ot">=</span> <span class="st">"#7b61ff"</span>,</span>
<span id="cb43-49"><a href="#cb43-49" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Senior (60+)"</span>         <span class="ot">=</span> <span class="st">"#ff6b6b"</span></span>
<span id="cb43-50"><a href="#cb43-50" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb43-51"><a href="#cb43-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb43-52"><a href="#cb43-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">dollar_format</span>(),</span>
<span id="cb43-53"><a href="#cb43-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.15</span>))</span>
<span id="cb43-54"><a href="#cb43-54" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb43-55"><a href="#cb43-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb43-56"><a href="#cb43-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">title    =</span> <span class="st">"Mean Spending by Age Group"</span>,</span>
<span id="cb43-57"><a href="#cb43-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"No consistent upward trend with increasing age"</span>,</span>
<span id="cb43-58"><a href="#cb43-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">x        =</span> <span class="cn">NULL</span>,</span>
<span id="cb43-59"><a href="#cb43-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">y        =</span> <span class="st">"Mean Amount ($)"</span></span>
<span id="cb43-60"><a href="#cb43-60" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb43-61"><a href="#cb43-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb43-62"><a href="#cb43-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb43-63"><a href="#cb43-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background  =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#0a0a0f"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb43-64"><a href="#cb43-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#12121a"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb43-65"><a href="#cb43-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#2a2a3a"</span>),</span>
<span id="cb43-66"><a href="#cb43-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb43-67"><a href="#cb43-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title       =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#ffffff"</span>,</span>
<span id="cb43-68"><a href="#cb43-68" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">face  =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb43-69"><a href="#cb43-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle    =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb43-70"><a href="#cb43-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text        =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>),</span>
<span id="cb43-71"><a href="#cb43-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title       =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>),</span>
<span id="cb43-72"><a href="#cb43-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position  =</span> <span class="st">"none"</span></span>
<span id="cb43-73"><a href="#cb43-73" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb43-74"><a href="#cb43-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-75"><a href="#cb43-75" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Display side by side ---</span></span>
<span id="cb43-76"><a href="#cb43-76" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span></span>
<span id="cb43-77"><a href="#cb43-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb43-78"><a href="#cb43-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Figure: Customer Age &amp; Spending Behaviour"</span>,</span>
<span id="cb43-79"><a href="#cb43-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">theme =</span> <span class="fu">theme</span>(</span>
<span id="cb43-80"><a href="#cb43-80" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#0a0a0f"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb43-81"><a href="#cb43-81" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title      =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#ffffff"</span>,</span>
<span id="cb43-82"><a href="#cb43-82" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">face  =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">13</span>)</span>
<span id="cb43-83"><a href="#cb43-83" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb43-84"><a href="#cb43-84" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="blackwell-customer-analytics_files/figure-html/age-vs-spending-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<section id="interpretation-martins-hypothesis-2" class="level3" data-number="3.3.1">
<h3 data-number="3.3.1" class="anchored" data-anchor-id="interpretation-martins-hypothesis-2"><span class="header-section-number">3.3.1</span> Interpretation Martin’s Hypothesis #2</h3>
<p>The data directly <strong>contradicts</strong> Martin’s hypothesis. Rather than older customers spending more, the analysis reveals the opposite; a <strong>negative correlation (r = -0.282)</strong> between age and transaction amount, meaning older customers actually tend to spend <strong>less</strong> than younger customers.</p>
<p>The age group summary confirms this clearly:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Age Group</th>
<th>Mean Spend</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Young Adults (18-39)</td>
<td>$991.08</td>
</tr>
<tr class="even">
<td>Middle-Aged (40-59)</td>
<td>$869.77</td>
</tr>
<tr class="odd">
<td>Senior (60+)</td>
<td>$469.83</td>
</tr>
</tbody>
</table>
<p>Spending declines consistently as age increases — Young Adults spend on average more than <strong>twice as much</strong> as Senior customers ($991.08 vs $469.83).</p>
<p><strong>Recommendation:</strong> Martin’s proposed website design changes and marketing activities targeting older customers as higher spenders are not supported by the data. If anything, marketing efforts aimed at driving higher transaction values should focus on <strong>younger demographics</strong>, particularly the 18-39 age group, which consistently generates the highest average spend.</p>
</section>
</section>
<section id="purchase-channel-analysis" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="purchase-channel-analysis"><span class="header-section-number">3.4</span> Purchase Channel Analysis</h2>
<p>Martin Goodrich’s second hypothesis is that customers who shop in-store are older than customers who shop online. This claim has significant implications. If true, it would suggest the website should be redesigned to appeal to younger shoppers, while in-store experiences are tailored to older customers.</p>
<p>This hypothesis is tested directly by comparing the age distribution of online and in-store customers, supported by a statistical test to determine whether any observed difference is meaningful or simply due to chance.</p>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Summary statistics by channel ---</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>channel_summary <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(channel) <span class="sc">%&gt;%</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Transactions  =</span> <span class="fu">n</span>(),</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mean_Age      =</span> <span class="fu">round</span>(<span class="fu">mean</span>(age), <span class="dv">1</span>),</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Median_Age    =</span> <span class="fu">round</span>(<span class="fu">median</span>(age), <span class="dv">1</span>),</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mean_Amount   =</span> <span class="fu">round</span>(<span class="fu">mean</span>(amount), <span class="dv">2</span>),</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Median_Amount =</span> <span class="fu">round</span>(<span class="fu">median</span>(amount), <span class="dv">2</span>)</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Display summary table ---</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>channel_summary <span class="sc">%&gt;%</span></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Channel"</span>, <span class="st">"Transactions"</span>, <span class="st">"Mean Age"</span>,</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Median Age"</span>, <span class="st">"Mean Amount ($)"</span>, </span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Median Amount ($)"</span>),</span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption   =</span> <span class="st">"Table: Customer Profile by Purchase Channel"</span></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"#00d4ff"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small">
<caption>Table: Customer Profile by Purchase Channel</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Channel</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Transactions</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Mean Age</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Median Age</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Mean Amount ($)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Median Amount ($)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; font-weight: bold; color: rgba(0, 212, 255, 255) !important;">Online</td>
<td style="text-align: right;">39989</td>
<td style="text-align: right;">48.6</td>
<td style="text-align: right;">48</td>
<td style="text-align: right;">897.55</td>
<td style="text-align: right;">441.89</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold; color: rgba(0, 212, 255, 255) !important;">In-Store</td>
<td style="text-align: right;">39990</td>
<td style="text-align: right;">43.0</td>
<td style="text-align: right;">42</td>
<td style="text-align: right;">774.11</td>
<td style="text-align: right;">688.18</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- T-test: Is the age difference statistically significant? ---</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>online_ages   <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(channel <span class="sc">==</span> <span class="st">"Online"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(age)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>instore_ages  <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(channel <span class="sc">==</span> <span class="st">"In-Store"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(age)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>ttest_result <span class="ot">&lt;-</span> <span class="fu">t.test</span>(instore_ages, online_ages)</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Welch Two-Sample T-Test: Age by Channel</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Welch Two-Sample T-Test: Age by Channel</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  In-Store Mean Age:"</span>, <span class="fu">round</span>(<span class="fu">mean</span>(instore_ages), <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  In-Store Mean Age: 42.96 </code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Online Mean Age:  "</span>, <span class="fu">round</span>(<span class="fu">mean</span>(online_ages), <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Online Mean Age:   48.56 </code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  t-statistic:      "</span>, <span class="fu">round</span>(ttest_result<span class="sc">$</span>statistic, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  t-statistic:       -51.209 </code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  p-value:          "</span>, <span class="fu">round</span>(ttest_result<span class="sc">$</span>p.value, <span class="dv">6</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  p-value:           0 </code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Conclusion:       "</span>,</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ifelse</span>(ttest_result<span class="sc">$</span>p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>,</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Statistically significant difference (p &lt; 0.05)"</span>,</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>           <span class="st">"No statistically significant difference (p &gt;= 0.05)"</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Conclusion:        Statistically significant difference (p &lt; 0.05) </code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Channel colour palette ---</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>channel_palette <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Online"</span> <span class="ot">=</span> <span class="st">"#00d4ff"</span>, <span class="st">"In-Store"</span> <span class="ot">=</span> <span class="st">"#ff6b6b"</span>)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Density plot: Age distribution by channel ---</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">fill =</span> channel, <span class="at">color =</span> channel)) <span class="sc">+</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values  =</span> channel_palette) <span class="sc">+</span></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> channel_palette) <span class="sc">+</span></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">title    =</span> <span class="st">"Age Distribution by Purchase Channel"</span>,</span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Online vs In-Store customer age profiles"</span>,</span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">x        =</span> <span class="st">"Customer Age"</span>,</span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">y        =</span> <span class="st">"Density"</span>,</span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill     =</span> <span class="st">"Channel"</span>,</span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">color    =</span> <span class="st">"Channel"</span></span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background   =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#0a0a0f"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb57-21"><a href="#cb57-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background  =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#12121a"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb57-22"><a href="#cb57-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major  =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#2a2a3a"</span>),</span>
<span id="cb57-23"><a href="#cb57-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor  =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb57-24"><a href="#cb57-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title        =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#ffffff"</span>,</span>
<span id="cb57-25"><a href="#cb57-25" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">face  =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb57-26"><a href="#cb57-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle     =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb57-27"><a href="#cb57-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text         =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>),</span>
<span id="cb57-28"><a href="#cb57-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title        =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>),</span>
<span id="cb57-29"><a href="#cb57-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#12121a"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb57-30"><a href="#cb57-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title      =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>, <span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb57-31"><a href="#cb57-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text       =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>, <span class="at">size =</span> <span class="dv">8</span>)</span>
<span id="cb57-32"><a href="#cb57-32" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb57-33"><a href="#cb57-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-34"><a href="#cb57-34" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Boxplot: Age by channel ---</span></span>
<span id="cb57-35"><a href="#cb57-35" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb57-36"><a href="#cb57-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> channel, <span class="at">y =</span> age, <span class="at">fill =</span> channel)) <span class="sc">+</span></span>
<span id="cb57-37"><a href="#cb57-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.colour =</span> <span class="st">"#ff4d4d"</span>,</span>
<span id="cb57-38"><a href="#cb57-38" aria-hidden="true" tabindex="-1"></a>               <span class="at">outlier.alpha  =</span> <span class="fl">0.3</span>,</span>
<span id="cb57-39"><a href="#cb57-39" aria-hidden="true" tabindex="-1"></a>               <span class="at">outlier.size   =</span> <span class="fl">0.8</span>,</span>
<span id="cb57-40"><a href="#cb57-40" aria-hidden="true" tabindex="-1"></a>               <span class="at">width          =</span> <span class="fl">0.5</span>,</span>
<span id="cb57-41"><a href="#cb57-41" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha          =</span> <span class="fl">0.85</span>) <span class="sc">+</span></span>
<span id="cb57-42"><a href="#cb57-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">alpha =</span> <span class="fl">0.02</span>, <span class="at">width =</span> <span class="fl">0.2</span>,</span>
<span id="cb57-43"><a href="#cb57-43" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"#ffffff"</span>, <span class="at">size =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb57-44"><a href="#cb57-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> channel_palette) <span class="sc">+</span></span>
<span id="cb57-45"><a href="#cb57-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb57-46"><a href="#cb57-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">title    =</span> <span class="st">"Age Spread by Purchase Channel"</span>,</span>
<span id="cb57-47"><a href="#cb57-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Median age comparison between channels"</span>,</span>
<span id="cb57-48"><a href="#cb57-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">x        =</span> <span class="cn">NULL</span>,</span>
<span id="cb57-49"><a href="#cb57-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">y        =</span> <span class="st">"Customer Age"</span></span>
<span id="cb57-50"><a href="#cb57-50" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb57-51"><a href="#cb57-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb57-52"><a href="#cb57-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb57-53"><a href="#cb57-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background  =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#0a0a0f"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb57-54"><a href="#cb57-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#12121a"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb57-55"><a href="#cb57-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#2a2a3a"</span>),</span>
<span id="cb57-56"><a href="#cb57-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb57-57"><a href="#cb57-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title       =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#ffffff"</span>,</span>
<span id="cb57-58"><a href="#cb57-58" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">face  =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb57-59"><a href="#cb57-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle    =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb57-60"><a href="#cb57-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text        =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>),</span>
<span id="cb57-61"><a href="#cb57-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title       =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>),</span>
<span id="cb57-62"><a href="#cb57-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position  =</span> <span class="st">"none"</span></span>
<span id="cb57-63"><a href="#cb57-63" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb57-64"><a href="#cb57-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-65"><a href="#cb57-65" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Display side by side ---</span></span>
<span id="cb57-66"><a href="#cb57-66" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span></span>
<span id="cb57-67"><a href="#cb57-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb57-68"><a href="#cb57-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Figure: Purchase Channel: Age Analysis"</span>,</span>
<span id="cb57-69"><a href="#cb57-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">theme =</span> <span class="fu">theme</span>(</span>
<span id="cb57-70"><a href="#cb57-70" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#0a0a0f"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb57-71"><a href="#cb57-71" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title      =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#ffffff"</span>,</span>
<span id="cb57-72"><a href="#cb57-72" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">face  =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">13</span>)</span>
<span id="cb57-73"><a href="#cb57-73" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb57-74"><a href="#cb57-74" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="blackwell-customer-analytics_files/figure-html/channel-analysis-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<section id="interpretation-martins-hypothesis-1" class="level3" data-number="3.4.1">
<h3 data-number="3.4.1" class="anchored" data-anchor-id="interpretation-martins-hypothesis-1"><span class="header-section-number">3.4.1</span> Interpretation: Martin’s Hypothesis #1</h3>
<p>The data <strong>partially supports</strong> Martin’s hypothesis but in the opposite direction to what he expected.</p>
<p>Online customers are actually <strong>older</strong> (mean age 48.56) than in-store customers (mean age 42.96), contradicting Martin’s claim that in-store shoppers are older. The Welch t-test confirms this difference is <strong>statistically significant</strong> (t = -51.21, p &lt; 0.0001), meaning it is extremely unlikely to be due to chance across 79,979 transactions.</p>
<p>Additionally, in-store customers spend considerably more on average (<strong>$688.18</strong>) compared to online customers (<strong>$441.89</strong>), despite being younger, which further contradicts Martin’s assumption that older customers are the higher spenders.</p>
<p><strong>Recommendation:</strong> The evidence does not support redesigning the website to attract older buyers, older customers are already the primary online shoppers. Instead, attention should focus on understanding why younger in-store customers are generating higher transaction values, and whether that behaviour can be replicated through the online channel to drive eCommerce revenue.</p>
</section>
</section>
<section id="age-differences-across-regions" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="age-differences-across-regions"><span class="header-section-number">3.5</span> Age Differences Across Regions</h2>
<p>Danielle’s second email raises an important question: are there meaningful differences in the age profile of customers across the four regions? Understanding whether age varies by region is valuable for two reasons: it informs region-specific marketing strategies, and it lays the analytical foundation for the predictive modelling section that follows, where age and other demographic variables are used to predict customer behaviour.</p>
<p>Age distributions across the four regions are examined here using a combination of summary statistics, density plots, and boxplots.</p>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Summary statistics: Age by region ---</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>region_age_summary <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(region) <span class="sc">%&gt;%</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Transactions =</span> <span class="fu">n</span>(),</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mean_Age     =</span> <span class="fu">round</span>(<span class="fu">mean</span>(age), <span class="dv">1</span>),</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Median_Age   =</span> <span class="fu">round</span>(<span class="fu">median</span>(age), <span class="dv">1</span>),</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">SD_Age       =</span> <span class="fu">round</span>(<span class="fu">sd</span>(age), <span class="dv">1</span>),</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Min_Age      =</span> <span class="fu">min</span>(age),</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Max_Age      =</span> <span class="fu">max</span>(age)</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Mean_Age))</span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Display summary table ---</span></span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>region_age_summary <span class="sc">%&gt;%</span></span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(</span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Region"</span>, <span class="st">"Transactions"</span>, <span class="st">"Mean Age"</span>,</span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Median Age"</span>, <span class="st">"Std Dev"</span>, </span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Min Age"</span>, <span class="st">"Max Age"</span>),</span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption   =</span> <span class="st">"Table: Customer Age Profile by Region"</span></span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb58-23"><a href="#cb58-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"#00d4ff"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb58-24"><a href="#cb58-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="dv">1</span>, <span class="at">background =</span> <span class="st">"rgba(0, 212, 255, 0.08)"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small">
<caption>Table: Customer Age Profile by Region</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Region</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Transactions</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Mean Age</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Median Age</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Std Dev</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Min Age</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Max Age</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; font-weight: bold; color: rgba(0, 212, 255, 255) !important; background-color: rgba(0, 212, 255, 0.08) !important;">South</td>
<td style="text-align: right; background-color: rgba(0, 212, 255, 0.08) !important;">19994</td>
<td style="text-align: right; background-color: rgba(0, 212, 255, 0.08) !important;">56.6</td>
<td style="text-align: right; background-color: rgba(0, 212, 255, 0.08) !important;">57</td>
<td style="text-align: right; background-color: rgba(0, 212, 255, 0.08) !important;">16.5</td>
<td style="text-align: right; background-color: rgba(0, 212, 255, 0.08) !important;">28</td>
<td style="text-align: right; background-color: rgba(0, 212, 255, 0.08) !important;">85</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold; color: rgba(0, 212, 255, 255) !important;">East</td>
<td style="text-align: right;">18000</td>
<td style="text-align: right;">45.6</td>
<td style="text-align: right;">45</td>
<td style="text-align: right;">14.4</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">74</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold; color: rgba(0, 212, 255, 255) !important;">North</td>
<td style="text-align: right;">15997</td>
<td style="text-align: right;">43.7</td>
<td style="text-align: right;">43</td>
<td style="text-align: right;">14.1</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">74</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold; color: rgba(0, 212, 255, 255) !important;">West</td>
<td style="text-align: right;">25988</td>
<td style="text-align: right;">38.8</td>
<td style="text-align: right;">39</td>
<td style="text-align: right;">11.9</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">63</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- ANOVA: Is age difference across regions significant? ---</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>anova_result <span class="ot">&lt;-</span> <span class="fu">aov</span>(age <span class="sc">~</span> region, <span class="at">data =</span> df)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>anova_summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(anova_result)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>p_value <span class="ot">&lt;-</span> anova_summary[[<span class="dv">1</span>]][[<span class="st">"Pr(&gt;F)"</span>]][<span class="dv">1</span>]</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">One-Way ANOVA: Age by Region</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
One-Way ANOVA: Age by Region</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  F-statistic:"</span>, <span class="fu">round</span>(anova_summary[[<span class="dv">1</span>]][[<span class="st">"F value"</span>]][<span class="dv">1</span>], <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  F-statistic: 6139.42 </code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  p-value:    "</span>, <span class="fu">round</span>(p_value, <span class="dv">6</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  p-value:     0 </code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Conclusion: "</span>,</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ifelse</span>(p_value <span class="sc">&lt;</span> <span class="fl">0.05</span>,</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Statistically significant age differences across regions (p &lt; 0.05)"</span>,</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>           <span class="st">"No statistically significant difference (p &gt;= 0.05)"</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Conclusion:  Statistically significant age differences across regions (p &lt; 0.05) </code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Region colour palette ---</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>region_palette <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"North"</span> <span class="ot">=</span> <span class="st">"#00d4ff"</span>,</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"South"</span> <span class="ot">=</span> <span class="st">"#7b61ff"</span>,</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"East"</span>  <span class="ot">=</span> <span class="st">"#f0c040"</span>,</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"West"</span>  <span class="ot">=</span> <span class="st">"#ff6b6b"</span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Density plot: Age distribution by region ---</span></span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">fill =</span> region, <span class="at">color =</span> region)) <span class="sc">+</span></span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values  =</span> region_palette) <span class="sc">+</span></span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> region_palette) <span class="sc">+</span></span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">title    =</span> <span class="st">"Age Distribution by Region"</span>,</span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Distinct age profiles visible across regions"</span>,</span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">x        =</span> <span class="st">"Customer Age"</span>,</span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">y        =</span> <span class="st">"Density"</span>,</span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill     =</span> <span class="st">"Region"</span>,</span>
<span id="cb67-21"><a href="#cb67-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">color    =</span> <span class="st">"Region"</span></span>
<span id="cb67-22"><a href="#cb67-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb67-23"><a href="#cb67-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb67-24"><a href="#cb67-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb67-25"><a href="#cb67-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background   =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#0a0a0f"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb67-26"><a href="#cb67-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background  =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#12121a"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb67-27"><a href="#cb67-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major  =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#2a2a3a"</span>),</span>
<span id="cb67-28"><a href="#cb67-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor  =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb67-29"><a href="#cb67-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title        =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#ffffff"</span>,</span>
<span id="cb67-30"><a href="#cb67-30" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">face  =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb67-31"><a href="#cb67-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle     =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb67-32"><a href="#cb67-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text         =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>),</span>
<span id="cb67-33"><a href="#cb67-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title        =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>),</span>
<span id="cb67-34"><a href="#cb67-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#12121a"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb67-35"><a href="#cb67-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title      =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>, <span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb67-36"><a href="#cb67-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text       =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>, <span class="at">size =</span> <span class="dv">8</span>)</span>
<span id="cb67-37"><a href="#cb67-37" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb67-38"><a href="#cb67-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-39"><a href="#cb67-39" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Boxplot: Age spread by region ---</span></span>
<span id="cb67-40"><a href="#cb67-40" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb67-41"><a href="#cb67-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(region, age, <span class="at">FUN =</span> mean),</span>
<span id="cb67-42"><a href="#cb67-42" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> age, <span class="at">fill =</span> region)) <span class="sc">+</span></span>
<span id="cb67-43"><a href="#cb67-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.colour =</span> <span class="st">"#ff4d4d"</span>,</span>
<span id="cb67-44"><a href="#cb67-44" aria-hidden="true" tabindex="-1"></a>               <span class="at">outlier.alpha  =</span> <span class="fl">0.3</span>,</span>
<span id="cb67-45"><a href="#cb67-45" aria-hidden="true" tabindex="-1"></a>               <span class="at">outlier.size   =</span> <span class="fl">0.8</span>,</span>
<span id="cb67-46"><a href="#cb67-46" aria-hidden="true" tabindex="-1"></a>               <span class="at">width          =</span> <span class="fl">0.5</span>,</span>
<span id="cb67-47"><a href="#cb67-47" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha          =</span> <span class="fl">0.85</span>) <span class="sc">+</span></span>
<span id="cb67-48"><a href="#cb67-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">alpha =</span> <span class="fl">0.015</span>, <span class="at">width =</span> <span class="fl">0.2</span>,</span>
<span id="cb67-49"><a href="#cb67-49" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"#ffffff"</span>, <span class="at">size =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb67-50"><a href="#cb67-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> region_palette) <span class="sc">+</span></span>
<span id="cb67-51"><a href="#cb67-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb67-52"><a href="#cb67-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb67-53"><a href="#cb67-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">title    =</span> <span class="st">"Age Spread by Region"</span>,</span>
<span id="cb67-54"><a href="#cb67-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Ordered by mean age — South notably older"</span>,</span>
<span id="cb67-55"><a href="#cb67-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">x        =</span> <span class="cn">NULL</span>,</span>
<span id="cb67-56"><a href="#cb67-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">y        =</span> <span class="st">"Customer Age"</span></span>
<span id="cb67-57"><a href="#cb67-57" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb67-58"><a href="#cb67-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb67-59"><a href="#cb67-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb67-60"><a href="#cb67-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background  =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#0a0a0f"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb67-61"><a href="#cb67-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#12121a"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb67-62"><a href="#cb67-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#2a2a3a"</span>),</span>
<span id="cb67-63"><a href="#cb67-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb67-64"><a href="#cb67-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title       =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#ffffff"</span>,</span>
<span id="cb67-65"><a href="#cb67-65" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">face  =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb67-66"><a href="#cb67-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle    =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb67-67"><a href="#cb67-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text        =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>),</span>
<span id="cb67-68"><a href="#cb67-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title       =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>),</span>
<span id="cb67-69"><a href="#cb67-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position  =</span> <span class="st">"none"</span></span>
<span id="cb67-70"><a href="#cb67-70" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb67-71"><a href="#cb67-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-72"><a href="#cb67-72" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Display side by side ---</span></span>
<span id="cb67-73"><a href="#cb67-73" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span></span>
<span id="cb67-74"><a href="#cb67-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb67-75"><a href="#cb67-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Figure: Age Distribution Across Regions"</span>,</span>
<span id="cb67-76"><a href="#cb67-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">theme =</span> <span class="fu">theme</span>(</span>
<span id="cb67-77"><a href="#cb67-77" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#0a0a0f"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb67-78"><a href="#cb67-78" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title      =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#ffffff"</span>,</span>
<span id="cb67-79"><a href="#cb67-79" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">face  =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">13</span>)</span>
<span id="cb67-80"><a href="#cb67-80" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb67-81"><a href="#cb67-81" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="blackwell-customer-analytics_files/figure-html/age-by-region-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<section id="interpretation-8" class="level3" data-number="3.5.1">
<h3 data-number="3.5.1" class="anchored" data-anchor-id="interpretation-8"><span class="header-section-number">3.5.1</span> Interpretation</h3>
<p>Significant age differences exist across Blackwell’s four regions. The mean age ranking from oldest to youngest is:</p>
<ol type="1">
<li><strong>South</strong>: 56.6 years (oldest)</li>
<li><strong>East</strong>: 45.6 years</li>
<li><strong>North</strong>: 43.7 years</li>
<li><strong>West</strong>: 38.8 years (youngest)</li>
</ol>
<p>The South region stands out strikingly. Iits customers are on average <strong>17.8 years older</strong> than West region customers. Combined with the earlier finding that the South has the lowest spending ceiling ($499.94 maximum), this paints a consistent picture; the South has an older, more conservative spending customer base.</p>
<p>The West, by contrast, has the youngest customer profile and the highest transaction values. Reinforcing the earlier finding that younger customers tend to spend more.</p>
<p>The One-Way ANOVA confirms these differences are <strong>statistically significant</strong> (F = 6,139.42, p &lt; 0.0001). The age gaps across regions are not due to chance.</p>
<p><strong>Recommendation:</strong> Regional marketing strategies should account for these demographic differences. The South may respond better to trust-building, value-oriented messaging suited to an older audience. The West and East, with younger and higher-spending customers, are better targets for premium and technology-forward campaigns.</p>
</section>
</section>
</section>
<section id="predictive-modelling" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Predictive Modelling</h1>
<p>The exploratory analysis has revealed clear patterns in Blackwell’s customer data. This section builds on those findings by developing predictive models that can anticipate customer behaviour, moving beyond description into prediction.</p>
<p>Three prediction tasks are addressed:</p>
<ol type="1">
<li><p><strong>Purchase Channel Prediction</strong>: Can a customer’s likelihood of shopping online or in-store be predicted from their demographic and transaction data? <em>(Binary Classification)</em></p></li>
<li><p><strong>Customer Age Prediction</strong>: Can the age of a customer be estimated from their purchasing behaviour and region? <em>(Regression)</em></p></li>
<li><p><strong>Region Prediction</strong>: Can the region a customer belongs to be predicted from their demographic profile? <em>(Multi-Class Classification)</em></p></li>
</ol>
<p>For each task, three models are trained and evaluated on a held-out test set, and the best performing model is selected for final interpretation and business recommendations.</p>
<section id="modelling-approach" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="modelling-approach"><span class="header-section-number">4.1</span> Modelling Approach</h2>
<p>All three tasks follow a consistent workflow:</p>
<ul>
<li><strong>Data splitting</strong>: 80% training, 20% test set</li>
<li><strong>Reproducibility</strong>: a fixed random seed (set.seed(1234)) is used throughout to ensure results are fully reproducible</li>
<li><strong>Model training</strong>: three candidate models trained per task</li>
<li><strong>Model selection</strong>: best model chosen based on evaluation metrics on the test set</li>
<li><strong>Interpretation</strong>: findings translated into actionable business recommendations</li>
</ul>
</section>
<section id="features-available-for-modelling" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="features-available-for-modelling"><span class="header-section-number">4.2</span> Features Available for Modelling</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 28%">
<col style="width: 24%">
<col style="width: 46%">
</colgroup>
<thead>
<tr class="header">
<th>Task</th>
<th>Target Variable</th>
<th>Predictor Variables</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Channel Prediction</td>
<td>channel</td>
<td>age, items, amount, region</td>
</tr>
<tr class="even">
<td>Age Prediction</td>
<td>age</td>
<td>channel, items, amount, region</td>
</tr>
<tr class="odd">
<td>Region Prediction</td>
<td>region</td>
<td>age, channel, items, amount</td>
</tr>
</tbody>
</table>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Set seed for reproducibility ---</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Define reusable train control ---</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 5-fold cross validation during training</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">method          =</span> <span class="st">"cv"</span>,</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">number          =</span> <span class="dv">5</span>,</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">savePredictions =</span> <span class="st">"final"</span>,</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">verboseIter     =</span> <span class="cn">FALSE</span></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Modelling setup complete.</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Modelling setup complete.</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Random seed set to 1234 for full reproducibility.</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Random seed set to 1234 for full reproducibility.</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"5-fold cross-validation configured for all models.</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>5-fold cross-validation configured for all models.</code></pre>
</div>
</div>
<p>A 5-fold cross-validation strategy is applied during training. This means the training set is divided into five equal folds. The model trains on four folds and validates on the fifth, rotating until every fold has served as the validation set. This produces a more reliable estimate of model performance than a single train/validate split, and reduces the risk of overfitting.</p>
</section>
</section>
<section id="purchase-channel-prediction" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Purchase Channel Prediction</h1>
<p>The first modelling task investigates whether a customer’s purchase channel, <strong>online or in-store</strong>, can be predicted from their demographic and transaction data. This is a binary classification problem, where the target variable has two possible outcomes: Online or In-Store.</p>
<p>Accurately predicting purchase channel would allow Blackwell to proactively identify customers likely to shop online versus in-store, enabling more targeted marketing, personalised communications, and smarter inventory decisions across channels.</p>
<p><strong>Candidate predictor variables:</strong> age, items, amount, region</p>
<section id="data-splitting" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="data-splitting"><span class="header-section-number">5.1</span> Data Splitting</h2>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 80/20 Train/Test Split ---</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>train_index <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(df<span class="sc">$</span>channel, <span class="at">p =</span> <span class="fl">0.8</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>train_channel <span class="ot">&lt;-</span> df[train_index, ]</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>test_channel  <span class="ot">&lt;-</span> df[<span class="sc">-</span>train_index, ]</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Channel Prediction: Data Split Summary:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Channel Prediction: Data Split Summary:</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Training set:"</span>, <span class="fu">nrow</span>(train_channel), <span class="st">"rows</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Training set: 63984 rows</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Test set:    "</span>, <span class="fu">nrow</span>(test_channel), <span class="st">"rows</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Test set:     15995 rows</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Verify class balance in split ---</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Training set channel distribution:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Training set channel distribution:</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">prop.table</span>(<span class="fu">table</span>(train_channel<span class="sc">$</span>channel)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
  Online In-Store 
     0.5      0.5 </code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Test set channel distribution:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Test set channel distribution:</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">prop.table</span>(<span class="fu">table</span>(test_channel<span class="sc">$</span>channel)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
   Online  In-Store 
0.4999687 0.5000313 </code></pre>
</div>
</div>
</section>
<section id="feature-selection" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="feature-selection"><span class="header-section-number">5.2</span> Feature Selection</h2>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Recursive Feature Elimination ---</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Using Random Forest as the estimator for feature importance</span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>rfe_control <span class="ot">&lt;-</span> <span class="fu">rfeControl</span>(</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">functions =</span> rfFuncs,</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">method    =</span> <span class="st">"cv"</span>,</span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">number    =</span> <span class="dv">5</span>,</span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">verbose   =</span> <span class="cn">FALSE</span></span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Prepare features and target ---</span></span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert region to numeric for RFE compatibility</span></span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a>train_channel_rfe <span class="ot">&lt;-</span> train_channel <span class="sc">%&gt;%</span></span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">region_num  =</span> <span class="fu">as.numeric</span>(region),</span>
<span id="cb88-15"><a href="#cb88-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">channel_num =</span> <span class="fu">as.numeric</span>(channel)</span>
<span id="cb88-16"><a href="#cb88-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb88-17"><a href="#cb88-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-18"><a href="#cb88-18" aria-hidden="true" tabindex="-1"></a>rfe_features <span class="ot">&lt;-</span> train_channel_rfe <span class="sc">%&gt;%</span></span>
<span id="cb88-19"><a href="#cb88-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(age, items, amount, region_num)</span>
<span id="cb88-20"><a href="#cb88-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-21"><a href="#cb88-21" aria-hidden="true" tabindex="-1"></a>rfe_target <span class="ot">&lt;-</span> train_channel_rfe<span class="sc">$</span>channel</span>
<span id="cb88-22"><a href="#cb88-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-23"><a href="#cb88-23" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Run RFE ---</span></span>
<span id="cb88-24"><a href="#cb88-24" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb88-25"><a href="#cb88-25" aria-hidden="true" tabindex="-1"></a>rfe_result_channel <span class="ot">&lt;-</span> <span class="fu">rfe</span>(</span>
<span id="cb88-26"><a href="#cb88-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">x          =</span> rfe_features,</span>
<span id="cb88-27"><a href="#cb88-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">y          =</span> rfe_target,</span>
<span id="cb88-28"><a href="#cb88-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">sizes      =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>),</span>
<span id="cb88-29"><a href="#cb88-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">rfeControl =</span> rfe_control</span>
<span id="cb88-30"><a href="#cb88-30" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb88-31"><a href="#cb88-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-32"><a href="#cb88-32" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Results ---</span></span>
<span id="cb88-33"><a href="#cb88-33" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Optimal Features Selected:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Optimal Features Selected:</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">predictors</span>(rfe_result_channel))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "region_num" "amount"     "age"       </code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">RFE Performance Summary:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
RFE Performance Summary:</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(rfe_result_channel)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Recursive feature selection

Outer resampling method: Cross-Validated (5 fold) 

Resampling performance over subset size:

 Variables Accuracy  Kappa AccuracySD  KappaSD Selected
         1   0.7485 0.4970   0.002571 0.005143         
         2   0.8642 0.7284   0.002162 0.004328         
         3   0.8864 0.7728   0.003316 0.006636        *
         4   0.8811 0.7623   0.003380 0.006762         

The top 3 variables (out of 3):
   region_num, amount, age</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Extract RFE results for custom plot ---</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>rfe_results_df <span class="ot">&lt;-</span> rfe_result_channel<span class="sc">$</span>results</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Custom readable RFE plot ---</span></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(rfe_results_df, <span class="fu">aes</span>(<span class="at">x =</span> Variables, <span class="at">y =</span> Accuracy)) <span class="sc">+</span></span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"#00d4ff"</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> Accuracy), </span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"#f0c040"</span>, <span class="at">fill =</span> <span class="st">"#f0c040"</span>,</span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">stroke =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(Accuracy, <span class="dv">4</span>)),</span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust  =</span> <span class="sc">-</span><span class="fl">1.2</span>,</span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">color  =</span> <span class="st">"#ffffff"</span>,</span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">size   =</span> <span class="fl">3.8</span>,</span>
<span id="cb96-14"><a href="#cb96-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb96-15"><a href="#cb96-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb96-16"><a href="#cb96-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb96-17"><a href="#cb96-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(</span>
<span id="cb96-18"><a href="#cb96-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">min</span>(rfe_results_df<span class="sc">$</span>Accuracy) <span class="sc">-</span> <span class="fl">0.01</span>,</span>
<span id="cb96-19"><a href="#cb96-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">max</span>(rfe_results_df<span class="sc">$</span>Accuracy) <span class="sc">+</span> <span class="fl">0.02</span></span>
<span id="cb96-20"><a href="#cb96-20" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb96-21"><a href="#cb96-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>(<span class="at">accuracy =</span> <span class="fl">0.1</span>)</span>
<span id="cb96-22"><a href="#cb96-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb96-23"><a href="#cb96-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb96-24"><a href="#cb96-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">title    =</span> <span class="st">"Figure: RFE: Feature Selection for Channel Prediction"</span>,</span>
<span id="cb96-25"><a href="#cb96-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Cross-validated accuracy by number of features retained"</span>,</span>
<span id="cb96-26"><a href="#cb96-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">x        =</span> <span class="st">"Number of Features"</span>,</span>
<span id="cb96-27"><a href="#cb96-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">y        =</span> <span class="st">"Accuracy (Cross-Validated)"</span></span>
<span id="cb96-28"><a href="#cb96-28" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb96-29"><a href="#cb96-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb96-30"><a href="#cb96-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb96-31"><a href="#cb96-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background  =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#0a0a0f"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb96-32"><a href="#cb96-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#12121a"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb96-33"><a href="#cb96-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#2a2a3a"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>),</span>
<span id="cb96-34"><a href="#cb96-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb96-35"><a href="#cb96-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title       =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#ffffff"</span>,</span>
<span id="cb96-36"><a href="#cb96-36" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">face  =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb96-37"><a href="#cb96-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle    =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb96-38"><a href="#cb96-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text        =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#e8e8e8"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb96-39"><a href="#cb96-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title       =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#e8e8e8"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb96-40"><a href="#cb96-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position  =</span> <span class="st">"none"</span></span>
<span id="cb96-41"><a href="#cb96-41" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="blackwell-customer-analytics_files/figure-html/channel-rfe-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="feature-selection-results" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="feature-selection-results"><span class="header-section-number">5.3</span> Feature Selection Results</h2>
<p>Recursive Feature Elimination identified <strong>three optimal features</strong> for predicting purchase channel: <strong>region, amount, and age.</strong></p>
<p>The <code>items</code> variable was eliminated, contributing no meaningful predictive power, consistent with the EDA finding that items purchased has no relationship with customer behaviour.</p>
<p>Cross-validated accuracy improves progressively from 74.77% with one feature to <strong>88.72% with three features</strong>. Adding the fourth feature (items) actually reduces accuracy slightly to 88.29%, confirming the three-feature model as optimal.</p>
<p>All three models will be trained using region, amount, and age as predictor variables.<br>
</p>
</section>
<section id="models-training" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="models-training"><span class="header-section-number">5.4</span> Models Training</h2>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Prepare train and test sets with RFE selected features ---</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>train_x <span class="ot">&lt;-</span> train_channel <span class="sc">%&gt;%</span> <span class="fu">select</span>(age, amount, region)</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>test_x  <span class="ot">&lt;-</span> test_channel <span class="sc">%&gt;%</span> <span class="fu">select</span>(age, amount, region)</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>train_y <span class="ot">&lt;-</span> train_channel<span class="sc">$</span>channel</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>test_y  <span class="ot">&lt;-</span> test_channel<span class="sc">$</span>channel</span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Training models with features: age, amount, region</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Training models with features: age, amount, region</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Model 1: Logistic Regression ---</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>model_lr_channel <span class="ot">&lt;-</span> <span class="fu">train</span>(</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">x          =</span> train_x,</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">y          =</span> train_y,</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">method     =</span> <span class="st">"glm"</span>,</span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">family     =</span> <span class="st">"binomial"</span>,</span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">trControl  =</span> train_control,</span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">preProcess =</span> <span class="fu">c</span>(<span class="st">"center"</span>, <span class="st">"scale"</span>)</span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Logistic Regression — Trained</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Logistic Regression — Trained</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Model 2: Random Forest ---</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>model_rf_channel <span class="ot">&lt;-</span> <span class="fu">train</span>(</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">x          =</span> train_x,</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">y          =</span> train_y,</span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">method     =</span> <span class="st">"rf"</span>,</span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">trControl  =</span> train_control,</span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">preProcess =</span> <span class="fu">c</span>(<span class="st">"center"</span>, <span class="st">"scale"</span>),</span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">tuneLength =</span> <span class="dv">3</span></span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>note: only 2 unique complexity parameters in default grid. Truncating the grid to 2 .</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Random Forest — Trained</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Random Forest — Trained</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Model 3: Decision Tree ---</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>model_dt_channel <span class="ot">&lt;-</span> <span class="fu">train</span>(</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">x          =</span> train_x,</span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">y          =</span> train_y,</span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">method     =</span> <span class="st">"rpart"</span>,</span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">trControl  =</span> train_control,</span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">preProcess =</span> <span class="fu">c</span>(<span class="st">"center"</span>, <span class="st">"scale"</span>),</span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">tuneLength =</span> <span class="dv">10</span></span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Decision Tree — Trained</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Decision Tree — Trained</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">All three models trained successfully.</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
All three models trained successfully.</code></pre>
</div>
</div>
</section>
<section id="channel-model-comparison" class="level2" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="channel-model-comparison"><span class="header-section-number">5.5</span> Channel Model Comparison</h2>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Predictions on test set ---</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>pred_lr_channel <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_lr_channel, test_x)</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>pred_rf_channel <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_rf_channel, test_x)</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>pred_dt_channel <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_dt_channel, test_x)</span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Confusion matrices ---</span></span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a>cm_lr <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_lr_channel, test_y)</span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a>cm_rf <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_rf_channel, test_y)</span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a>cm_dt <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_dt_channel, test_y)</span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-11"><a href="#cb109-11" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Model comparison table ---</span></span>
<span id="cb109-12"><a href="#cb109-12" aria-hidden="true" tabindex="-1"></a>model_comparison_channel <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb109-13"><a href="#cb109-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model       =</span> <span class="fu">c</span>(<span class="st">"Logistic Regression"</span>,</span>
<span id="cb109-14"><a href="#cb109-14" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Random Forest"</span>,</span>
<span id="cb109-15"><a href="#cb109-15" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Decision Tree"</span>),</span>
<span id="cb109-16"><a href="#cb109-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">Accuracy    =</span> <span class="fu">c</span>(cm_lr<span class="sc">$</span>overall[<span class="st">"Accuracy"</span>],</span>
<span id="cb109-17"><a href="#cb109-17" aria-hidden="true" tabindex="-1"></a>                  cm_rf<span class="sc">$</span>overall[<span class="st">"Accuracy"</span>],</span>
<span id="cb109-18"><a href="#cb109-18" aria-hidden="true" tabindex="-1"></a>                  cm_dt<span class="sc">$</span>overall[<span class="st">"Accuracy"</span>]),</span>
<span id="cb109-19"><a href="#cb109-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">Kappa       =</span> <span class="fu">c</span>(cm_lr<span class="sc">$</span>overall[<span class="st">"Kappa"</span>],</span>
<span id="cb109-20"><a href="#cb109-20" aria-hidden="true" tabindex="-1"></a>                  cm_rf<span class="sc">$</span>overall[<span class="st">"Kappa"</span>],</span>
<span id="cb109-21"><a href="#cb109-21" aria-hidden="true" tabindex="-1"></a>                  cm_dt<span class="sc">$</span>overall[<span class="st">"Kappa"</span>]),</span>
<span id="cb109-22"><a href="#cb109-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">Sensitivity =</span> <span class="fu">c</span>(cm_lr<span class="sc">$</span>byClass[<span class="st">"Sensitivity"</span>],</span>
<span id="cb109-23"><a href="#cb109-23" aria-hidden="true" tabindex="-1"></a>                  cm_rf<span class="sc">$</span>byClass[<span class="st">"Sensitivity"</span>],</span>
<span id="cb109-24"><a href="#cb109-24" aria-hidden="true" tabindex="-1"></a>                  cm_dt<span class="sc">$</span>byClass[<span class="st">"Sensitivity"</span>]),</span>
<span id="cb109-25"><a href="#cb109-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">Specificity =</span> <span class="fu">c</span>(cm_lr<span class="sc">$</span>byClass[<span class="st">"Specificity"</span>],</span>
<span id="cb109-26"><a href="#cb109-26" aria-hidden="true" tabindex="-1"></a>                  cm_rf<span class="sc">$</span>byClass[<span class="st">"Specificity"</span>],</span>
<span id="cb109-27"><a href="#cb109-27" aria-hidden="true" tabindex="-1"></a>                  cm_dt<span class="sc">$</span>byClass[<span class="st">"Specificity"</span>])</span>
<span id="cb109-28"><a href="#cb109-28" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb109-29"><a href="#cb109-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span> <span class="fu">round</span>(., <span class="dv">4</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb109-30"><a href="#cb109-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Accuracy))</span>
<span id="cb109-31"><a href="#cb109-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-32"><a href="#cb109-32" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Display comparison table ---</span></span>
<span id="cb109-33"><a href="#cb109-33" aria-hidden="true" tabindex="-1"></a>model_comparison_channel <span class="sc">%&gt;%</span></span>
<span id="cb109-34"><a href="#cb109-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(</span>
<span id="cb109-35"><a href="#cb109-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Model"</span>, <span class="st">"Accuracy"</span>, <span class="st">"Kappa"</span>,</span>
<span id="cb109-36"><a href="#cb109-36" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Sensitivity"</span>, <span class="st">"Specificity"</span>),</span>
<span id="cb109-37"><a href="#cb109-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption   =</span> <span class="st">"Table 9: Model Comparison — Channel Prediction"</span></span>
<span id="cb109-38"><a href="#cb109-38" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb109-39"><a href="#cb109-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb109-40"><a href="#cb109-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"#00d4ff"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb109-41"><a href="#cb109-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="dv">1</span>, <span class="at">background =</span> <span class="st">"rgba(0, 212, 255, 0.08)"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small">
<caption>Table 9: Model Comparison — Channel Prediction</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Model</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Accuracy</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Kappa</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Sensitivity</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Specificity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; font-weight: bold; color: rgba(0, 212, 255, 255) !important; background-color: rgba(0, 212, 255, 0.08) !important;">Decision Tree</td>
<td style="text-align: right; background-color: rgba(0, 212, 255, 0.08) !important;">0.8915</td>
<td style="text-align: right; background-color: rgba(0, 212, 255, 0.08) !important;">0.7829</td>
<td style="text-align: right; background-color: rgba(0, 212, 255, 0.08) !important;">0.7843</td>
<td style="text-align: right; background-color: rgba(0, 212, 255, 0.08) !important;">0.9986</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold; color: rgba(0, 212, 255, 255) !important;">Random Forest</td>
<td style="text-align: right;">0.8786</td>
<td style="text-align: right;">0.7572</td>
<td style="text-align: right;">0.8074</td>
<td style="text-align: right;">0.9497</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold; color: rgba(0, 212, 255, 255) !important;">Logistic Regression</td>
<td style="text-align: right;">0.8392</td>
<td style="text-align: right;">0.6784</td>
<td style="text-align: right;">0.8057</td>
<td style="text-align: right;">0.8727</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Best model statement ---</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>best_model    <span class="ot">&lt;-</span> model_comparison_channel<span class="sc">$</span>Model[<span class="dv">1</span>]</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>best_accuracy <span class="ot">&lt;-</span> <span class="fu">round</span>(model_comparison_channel<span class="sc">$</span>Accuracy[<span class="dv">1</span>] <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>)</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>best_kappa    <span class="ot">&lt;-</span> model_comparison_channel<span class="sc">$</span>Kappa[<span class="dv">1</span>]</span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Best Performing Model:"</span>, best_model, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Best Performing Model: Decision Tree </code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Test Set Accuracy:    "</span>, best_accuracy, <span class="st">"%</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Test Set Accuracy:     89.15 %</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Kappa Statistic:      "</span>, best_kappa, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Kappa Statistic:       0.7829 </code></pre>
</div>
</div>
</section>
<section id="purchase-channel-best-model" class="level2" data-number="5.6">
<h2 data-number="5.6" class="anchored" data-anchor-id="purchase-channel-best-model"><span class="header-section-number">5.6</span> Purchase Channel Best Model</h2>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Confusion Matrix: Decision Tree ---</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Confusion Matrix — Decision Tree</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix — Decision Tree</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"==================================</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>==================================</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cm_dt<span class="sc">$</span>table)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          Reference
Prediction Online In-Store
  Online     6272       11
  In-Store   1725     7987</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Actual vs Predicted comparison table ---</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>dt_results <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Actual    =</span> test_y,</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Predicted =</span> pred_dt_channel,</span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Correct   =</span> test_y <span class="sc">==</span> pred_dt_channel</span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Summary of correct vs incorrect predictions ---</span></span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a>dt_summary <span class="ot">&lt;-</span> dt_results <span class="sc">%&gt;%</span></span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Actual, Predicted) <span class="sc">%&gt;%</span></span>
<span id="cb122-11"><a href="#cb122-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb122-12"><a href="#cb122-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb122-13"><a href="#cb122-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">Result =</span> <span class="fu">ifelse</span>(Actual <span class="sc">==</span> Predicted, </span>
<span id="cb122-14"><a href="#cb122-14" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"Correct"</span>, <span class="st">"Incorrect"</span>)</span>
<span id="cb122-15"><a href="#cb122-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb122-16"><a href="#cb122-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-17"><a href="#cb122-17" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Display actual vs predicted table ---</span></span>
<span id="cb122-18"><a href="#cb122-18" aria-hidden="true" tabindex="-1"></a>dt_summary <span class="sc">%&gt;%</span></span>
<span id="cb122-19"><a href="#cb122-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(</span>
<span id="cb122-20"><a href="#cb122-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Actual"</span>, <span class="st">"Predicted"</span>, </span>
<span id="cb122-21"><a href="#cb122-21" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Count"</span>, <span class="st">"Result"</span>),</span>
<span id="cb122-22"><a href="#cb122-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption   =</span> <span class="st">"Table 10: Actual vs Predicted — Decision Tree"</span></span>
<span id="cb122-23"><a href="#cb122-23" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb122-24"><a href="#cb122-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb122-25"><a href="#cb122-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"#00d4ff"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb122-26"><a href="#cb122-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">4</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>,</span>
<span id="cb122-27"><a href="#cb122-27" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="fu">ifelse</span>(dt_summary<span class="sc">$</span>Result <span class="sc">==</span> <span class="st">"Correct"</span>,</span>
<span id="cb122-28"><a href="#cb122-28" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"#00ff9d"</span>, <span class="st">"#ff6b6b"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small">
<caption>Table 10: Actual vs Predicted — Decision Tree</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Actual</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Predicted</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Count</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; font-weight: bold; color: rgba(0, 212, 255, 255) !important;">Online</td>
<td style="text-align: left;">Online</td>
<td style="text-align: right;">6272</td>
<td style="text-align: left; font-weight: bold; color: rgba(0, 255, 157, 255) !important;">Correct</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold; color: rgba(0, 212, 255, 255) !important;">Online</td>
<td style="text-align: left;">In-Store</td>
<td style="text-align: right;">1725</td>
<td style="text-align: left; font-weight: bold; color: rgba(255, 107, 107, 255) !important;">Incorrect</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold; color: rgba(0, 212, 255, 255) !important;">In-Store</td>
<td style="text-align: left;">Online</td>
<td style="text-align: right;">11</td>
<td style="text-align: left; font-weight: bold; color: rgba(255, 107, 107, 255) !important;">Incorrect</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold; color: rgba(0, 212, 255, 255) !important;">In-Store</td>
<td style="text-align: left;">In-Store</td>
<td style="text-align: right;">7987</td>
<td style="text-align: left; font-weight: bold; color: rgba(0, 255, 157, 255) !important;">Correct</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Overall prediction accuracy breakdown ---</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Prediction Breakdown:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Prediction Breakdown:</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Correctly classified:  "</span>, <span class="fu">sum</span>(dt_results<span class="sc">$</span>Correct), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Correctly classified:   14259 </code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Incorrectly classified:"</span>, <span class="fu">sum</span>(<span class="sc">!</span>dt_results<span class="sc">$</span>Correct), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Incorrectly classified: 1736 </code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Overall Accuracy:      "</span>, </span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">mean</span>(dt_results<span class="sc">$</span>Correct) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>), <span class="st">"%</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Overall Accuracy:       89.15 %</code></pre>
</div>
</div>
</section>
<section id="best-model-for-channel-prediction" class="level2" data-number="5.7">
<h2 data-number="5.7" class="anchored" data-anchor-id="best-model-for-channel-prediction"><span class="header-section-number">5.7</span> Best model for channel prediction</h2>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Save best model for channel prediction ---</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(model_dt_channel, <span class="st">"best_model_channel.rds"</span>)</span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Best model for channel prediction saved successfully.</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Best model for channel prediction saved successfully.</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Model: Decision Tree</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Model: Decision Tree</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"File:  best_model_channel.rds</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>File:  best_model_channel.rds</code></pre>
</div>
</div>
</section>
<section id="interpretation-channel-prediction" class="level2" data-number="5.8">
<h2 data-number="5.8" class="anchored" data-anchor-id="interpretation-channel-prediction"><span class="header-section-number">5.8</span> Interpretation: Channel Prediction</h2>
<p>The Decision Tree outperformed both Random Forest and Logistic Regression, achieving a test set accuracy of <strong>88.82%</strong> and a Kappa of <strong>0.7764</strong>, indicating strong agreement between predicted and actual channel classifications beyond chance.</p>
<p>The actual vs predicted table reveals an important asymmetry in model performance:</p>
<ul>
<li><strong>Online customers</strong> are predicted with near-perfect accuracy. Only <strong>1</strong> <strong>Online custome</strong>r was misclassified as In-Store</li>
<li><strong>In-Store customers</strong> are harder to predict. <strong>1,744 In-Store customers</strong> were incorrectly classified as Online</li>
</ul>
<p>This suggests the model has learned a very strong signal for identifying Online customers, likely driven by age and region, but finds In-Store customers more difficult to distinguish, possibly because their demographic profile overlaps more with Online customers in certain regions.</p>
<p>Overall, 14,250 out of 15,995 customers were correctly classified, with only 1,745 misclassifications.</p>
<p><strong>Recommendation:</strong> The Decision Tree model provides a reliable tool for predicting whether a customer will shop online or in-store. Blackwell can use this model to proactively segment new customers and personalise marketing communications by channel before a purchase is even made. The model’s near-perfect identification of Online customers is particularly valuable for targeted digital marketing campaigns.</p>
</section>
</section>
<section id="customer-age-prediction" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Customer Age Prediction</h1>
<p>The second modelling task investigates whether the age of a customer can be predicted from their purchasing behaviour and demographic data. This is a regression problem; the target variable, age, is a continuous numeric value rather than a category.</p>
<p>Predicting customer age is valuable for Blackwell because age data may not always be available for every customer. A reliable predictive model would allow the business to estimate the age profile of new customers from transaction data alone, enabling more targeted marketing without requiring customers to explicitly provide their age.</p>
<p>It is worth acknowledging upfront that the EDA revealed only a weak negative correlation between age and amount spent (r = -0.282), and that age varies significantly by region. Predicting age from the available variables is therefore expected to be a challenging task, and this is reflected honestly in the results.</p>
<p><strong>Candidate predictor variables:</strong> channel, items, amount, region</p>
<section id="data-splitting-1" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="data-splitting-1"><span class="header-section-number">6.1</span> Data Splitting</h2>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 80/20 Train/Test Split ---</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>train_index_age <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(df<span class="sc">$</span>age, <span class="at">p =</span> <span class="fl">0.8</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a>train_age <span class="ot">&lt;-</span> df[train_index_age, ]</span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a>test_age  <span class="ot">&lt;-</span> df[<span class="sc">-</span>train_index_age, ]</span>
<span id="cb137-7"><a href="#cb137-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-8"><a href="#cb137-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Age Prediction — Data Split Summary:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Age Prediction — Data Split Summary:</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Training set:"</span>, <span class="fu">nrow</span>(train_age), <span class="st">"rows</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Training set: 63986 rows</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Test set:    "</span>, <span class="fu">nrow</span>(test_age), <span class="st">"rows</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Test set:     15993 rows</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Verify age distribution in split ---</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Training set age summary:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Training set age summary:</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(train_age<span class="sc">$</span>age))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  18.00   33.00   45.00   45.77   56.00   85.00 </code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Test set age summary:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Test set age summary:</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(test_age<span class="sc">$</span>age))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  18.00   33.00   45.00   45.73   56.00   85.00 </code></pre>
</div>
</div>
</section>
<section id="feature-selection-for-age-prediction" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="feature-selection-for-age-prediction"><span class="header-section-number">6.2</span> Feature Selection For Age Prediction</h2>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Recursive Feature Elimination for Age Prediction ---</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Using Random Forest as the estimator</span></span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>rfe_control_age <span class="ot">&lt;-</span> <span class="fu">rfeControl</span>(</span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">functions =</span> rfFuncs,</span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">method    =</span> <span class="st">"cv"</span>,</span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">number    =</span> <span class="dv">5</span>,</span>
<span id="cb151-7"><a href="#cb151-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">verbose   =</span> <span class="cn">FALSE</span></span>
<span id="cb151-8"><a href="#cb151-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb151-9"><a href="#cb151-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-10"><a href="#cb151-10" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Prepare features and target ---</span></span>
<span id="cb151-11"><a href="#cb151-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert factors to numeric for RFE compatibility</span></span>
<span id="cb151-12"><a href="#cb151-12" aria-hidden="true" tabindex="-1"></a>train_age_rfe <span class="ot">&lt;-</span> train_age <span class="sc">%&gt;%</span></span>
<span id="cb151-13"><a href="#cb151-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb151-14"><a href="#cb151-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">channel_num =</span> <span class="fu">as.numeric</span>(channel),</span>
<span id="cb151-15"><a href="#cb151-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">region_num  =</span> <span class="fu">as.numeric</span>(region)</span>
<span id="cb151-16"><a href="#cb151-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb151-17"><a href="#cb151-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-18"><a href="#cb151-18" aria-hidden="true" tabindex="-1"></a>rfe_features_age <span class="ot">&lt;-</span> train_age_rfe <span class="sc">%&gt;%</span></span>
<span id="cb151-19"><a href="#cb151-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(channel_num, items, amount, region_num)</span>
<span id="cb151-20"><a href="#cb151-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-21"><a href="#cb151-21" aria-hidden="true" tabindex="-1"></a>rfe_target_age <span class="ot">&lt;-</span> train_age_rfe<span class="sc">$</span>age</span>
<span id="cb151-22"><a href="#cb151-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-23"><a href="#cb151-23" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Run RFE ---</span></span>
<span id="cb151-24"><a href="#cb151-24" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb151-25"><a href="#cb151-25" aria-hidden="true" tabindex="-1"></a>rfe_result_age <span class="ot">&lt;-</span> <span class="fu">rfe</span>(</span>
<span id="cb151-26"><a href="#cb151-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">x          =</span> rfe_features_age,</span>
<span id="cb151-27"><a href="#cb151-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">y          =</span> rfe_target_age,</span>
<span id="cb151-28"><a href="#cb151-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">sizes      =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>),</span>
<span id="cb151-29"><a href="#cb151-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">rfeControl =</span> rfe_control_age</span>
<span id="cb151-30"><a href="#cb151-30" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb151-31"><a href="#cb151-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-32"><a href="#cb151-32" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Results ---</span></span>
<span id="cb151-33"><a href="#cb151-33" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Optimal Features Selected:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Optimal Features Selected:</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">predictors</span>(rfe_result_age))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "channel_num" "region_num"  "amount"     </code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">RFE Performance Summary:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
RFE Performance Summary:</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(rfe_result_age)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Recursive feature selection

Outer resampling method: Cross-Validated (5 fold) 

Resampling performance over subset size:

 Variables  RMSE Rsquared   MAE  RMSESD RsquaredSD   MAESD Selected
         1 15.47  0.03125 12.81 0.05803  0.0009713 0.04078         
         2 14.20  0.19708 12.03 0.06319  0.0048224 0.05170         
         3 14.00  0.21197 11.90 0.05871  0.0034912 0.05244        *
         4 14.02  0.21140 11.92 0.04968  0.0030715 0.04578         

The top 3 variables (out of 3):
   channel_num, region_num, amount</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- RFE plot ---</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: age-rfe-plot</span></span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(rfe_result_age) <span class="sc">+</span></span>
<span id="cb159-5"><a href="#cb159-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb159-6"><a href="#cb159-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title    =</span> <span class="st">"Figure: RFE: Feature Selection for Age Prediction"</span>,</span>
<span id="cb159-7"><a href="#cb159-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"RMSE by number of features selected"</span>,</span>
<span id="cb159-8"><a href="#cb159-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x        =</span> <span class="st">"Number of Features"</span>,</span>
<span id="cb159-9"><a href="#cb159-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y        =</span> <span class="st">"RMSE (Cross-Validated)"</span></span>
<span id="cb159-10"><a href="#cb159-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb159-11"><a href="#cb159-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb159-12"><a href="#cb159-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb159-13"><a href="#cb159-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background  =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#12121a"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb159-14"><a href="#cb159-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#1e1e2e"</span>, <span class="at">color =</span> <span class="st">"#2a2a3a"</span>),</span>
<span id="cb159-15"><a href="#cb159-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#3a3a4a"</span>),</span>
<span id="cb159-16"><a href="#cb159-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#2a2a3a"</span>),</span>
<span id="cb159-17"><a href="#cb159-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title       =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#ffffff"</span>,</span>
<span id="cb159-18"><a href="#cb159-18" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">face  =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb159-19"><a href="#cb159-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle    =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb159-20"><a href="#cb159-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text        =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#e8e8e8"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb159-21"><a href="#cb159-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title       =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#e8e8e8"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb159-22"><a href="#cb159-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line        =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>),</span>
<span id="cb159-23"><a href="#cb159-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#1e1e2e"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb159-24"><a href="#cb159-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text       =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#e8e8e8"</span>),</span>
<span id="cb159-25"><a href="#cb159-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title      =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#e8e8e8"</span>)</span>
<span id="cb159-26"><a href="#cb159-26" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="blackwell-customer-analytics_files/figure-html/age-rfe-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="feature-selection-results-1" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="feature-selection-results-1"><span class="header-section-number">6.3</span> Feature Selection Results</h2>
<p>Recursive Feature Elimination identified <strong>three optimal features</strong> for predicting customer age: <strong>channel, region, and amount.</strong></p>
<p>The <code>items</code> variable was eliminated, contributing no meaningful predictive power, consistent with findings across both the EDA and the channel prediction task.</p>
<p>Performance improves progressively from an RMSE of 15.47 with one feature to <strong>14.00 with three features</strong>, with R² improving from 0.031 to 0.212. Adding the fourth feature (items) produces no improvement, confirming the three-feature model as optimal.</p>
<p>However, an R² of 0.212 indicates that the three selected features explain only <strong>21.2% of the variance in customer age</strong>, confirming the upfront acknowledgement that age is a difficult variable to predict from the available data. This is an honest and important finding that will be reflected in the model results.</p>
<p>All three models will be trained using channel, amount, and region as predictor variables.</p>
</section>
<section id="model-training-for-age-prediction" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="model-training-for-age-prediction"><span class="header-section-number">6.4</span> Model Training For Age Prediction</h2>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Prepare train and test sets with RFE selected features ---</span></span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>train_x_age <span class="ot">&lt;-</span> train_age <span class="sc">%&gt;%</span> <span class="fu">select</span>(channel, amount, region)</span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a>test_x_age  <span class="ot">&lt;-</span> test_age <span class="sc">%&gt;%</span> <span class="fu">select</span>(channel, amount, region)</span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-5"><a href="#cb160-5" aria-hidden="true" tabindex="-1"></a>train_y_age <span class="ot">&lt;-</span> train_age<span class="sc">$</span>age</span>
<span id="cb160-6"><a href="#cb160-6" aria-hidden="true" tabindex="-1"></a>test_y_age  <span class="ot">&lt;-</span> test_age<span class="sc">$</span>age</span>
<span id="cb160-7"><a href="#cb160-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-8"><a href="#cb160-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Training models with features: channel, amount, region</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Training models with features: channel, amount, region</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Model 1: Linear Regression ---</span></span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a>model_lr_age <span class="ot">&lt;-</span> <span class="fu">train</span>(</span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">x          =</span> train_x_age,</span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">y          =</span> train_y_age,</span>
<span id="cb162-6"><a href="#cb162-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">method     =</span> <span class="st">"lm"</span>,</span>
<span id="cb162-7"><a href="#cb162-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">trControl  =</span> train_control,</span>
<span id="cb162-8"><a href="#cb162-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">preProcess =</span> <span class="fu">c</span>(<span class="st">"center"</span>, <span class="st">"scale"</span>)</span>
<span id="cb162-9"><a href="#cb162-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb162-10"><a href="#cb162-10" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Linear Regression — Trained</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Linear Regression — Trained</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Model 2: Random Forest ---</span></span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a>model_rf_age <span class="ot">&lt;-</span> <span class="fu">train</span>(</span>
<span id="cb164-4"><a href="#cb164-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">x          =</span> train_x_age,</span>
<span id="cb164-5"><a href="#cb164-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">y          =</span> train_y_age,</span>
<span id="cb164-6"><a href="#cb164-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">method     =</span> <span class="st">"rf"</span>,</span>
<span id="cb164-7"><a href="#cb164-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">trControl  =</span> train_control,</span>
<span id="cb164-8"><a href="#cb164-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">preProcess =</span> <span class="fu">c</span>(<span class="st">"center"</span>, <span class="st">"scale"</span>),</span>
<span id="cb164-9"><a href="#cb164-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">tuneLength =</span> <span class="dv">3</span></span>
<span id="cb164-10"><a href="#cb164-10" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>note: only 2 unique complexity parameters in default grid. Truncating the grid to 2 .</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Random Forest — Trained</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Random Forest — Trained</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Model 3: Decision Tree ---</span></span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a>model_dt_age <span class="ot">&lt;-</span> <span class="fu">train</span>(</span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">x          =</span> train_x_age,</span>
<span id="cb168-5"><a href="#cb168-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">y          =</span> train_y_age,</span>
<span id="cb168-6"><a href="#cb168-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">method     =</span> <span class="st">"rpart"</span>,</span>
<span id="cb168-7"><a href="#cb168-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">trControl  =</span> train_control,</span>
<span id="cb168-8"><a href="#cb168-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">preProcess =</span> <span class="fu">c</span>(<span class="st">"center"</span>, <span class="st">"scale"</span>),</span>
<span id="cb168-9"><a href="#cb168-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">tuneLength =</span> <span class="dv">10</span></span>
<span id="cb168-10"><a href="#cb168-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb168-11"><a href="#cb168-11" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Decision Tree — Trained</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Decision Tree — Trained</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">All three models trained successfully.</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
All three models trained successfully.</code></pre>
</div>
</div>
</section>
<section id="age-comparison-table-and-best-model" class="level2" data-number="6.5">
<h2 data-number="6.5" class="anchored" data-anchor-id="age-comparison-table-and-best-model"><span class="header-section-number">6.5</span> Age Comparison Table And Best Model</h2>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Predictions on test set ---</span></span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a>pred_lr_age <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_lr_age, test_x_age)</span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a>pred_rf_age <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_rf_age, test_x_age)</span>
<span id="cb172-4"><a href="#cb172-4" aria-hidden="true" tabindex="-1"></a>pred_dt_age <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_dt_age, test_x_age)</span>
<span id="cb172-5"><a href="#cb172-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-6"><a href="#cb172-6" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Model comparison table ---</span></span>
<span id="cb172-7"><a href="#cb172-7" aria-hidden="true" tabindex="-1"></a>model_comparison_age <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb172-8"><a href="#cb172-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model =</span> <span class="fu">c</span>(<span class="st">"Linear Regression"</span>,</span>
<span id="cb172-9"><a href="#cb172-9" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Random Forest"</span>,</span>
<span id="cb172-10"><a href="#cb172-10" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Decision Tree"</span>),</span>
<span id="cb172-11"><a href="#cb172-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">RMSE  =</span> <span class="fu">c</span>(</span>
<span id="cb172-12"><a href="#cb172-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">RMSE</span>(pred_lr_age, test_y_age), <span class="dv">4</span>),</span>
<span id="cb172-13"><a href="#cb172-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">RMSE</span>(pred_rf_age, test_y_age), <span class="dv">4</span>),</span>
<span id="cb172-14"><a href="#cb172-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">RMSE</span>(pred_dt_age, test_y_age), <span class="dv">4</span>)</span>
<span id="cb172-15"><a href="#cb172-15" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb172-16"><a href="#cb172-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">MAE =</span> <span class="fu">c</span>(</span>
<span id="cb172-17"><a href="#cb172-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">MAE</span>(pred_lr_age, test_y_age), <span class="dv">4</span>),</span>
<span id="cb172-18"><a href="#cb172-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">MAE</span>(pred_rf_age, test_y_age), <span class="dv">4</span>),</span>
<span id="cb172-19"><a href="#cb172-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">MAE</span>(pred_dt_age, test_y_age), <span class="dv">4</span>)</span>
<span id="cb172-20"><a href="#cb172-20" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb172-21"><a href="#cb172-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">R_Squared =</span> <span class="fu">c</span>(</span>
<span id="cb172-22"><a href="#cb172-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">R2</span>(pred_lr_age, test_y_age), <span class="dv">4</span>),</span>
<span id="cb172-23"><a href="#cb172-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">R2</span>(pred_rf_age, test_y_age), <span class="dv">4</span>),</span>
<span id="cb172-24"><a href="#cb172-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">R2</span>(pred_dt_age, test_y_age), <span class="dv">4</span>)</span>
<span id="cb172-25"><a href="#cb172-25" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb172-26"><a href="#cb172-26" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb172-27"><a href="#cb172-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(RMSE)</span>
<span id="cb172-28"><a href="#cb172-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-29"><a href="#cb172-29" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Display comparison table ---</span></span>
<span id="cb172-30"><a href="#cb172-30" aria-hidden="true" tabindex="-1"></a>model_comparison_age <span class="sc">%&gt;%</span></span>
<span id="cb172-31"><a href="#cb172-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(</span>
<span id="cb172-32"><a href="#cb172-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Model"</span>, <span class="st">"RMSE"</span>, <span class="st">"MAE"</span>, <span class="st">"R-Squared"</span>),</span>
<span id="cb172-33"><a href="#cb172-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption   =</span> <span class="st">"Table: Model Comparison — Age Prediction"</span></span>
<span id="cb172-34"><a href="#cb172-34" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb172-35"><a href="#cb172-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb172-36"><a href="#cb172-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"#00d4ff"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb172-37"><a href="#cb172-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="dv">1</span>, <span class="at">background =</span> <span class="st">"rgba(0, 212, 255, 0.08)"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small">
<caption>Table: Model Comparison — Age Prediction</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Model</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">RMSE</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">MAE</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">R-Squared</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; font-weight: bold; color: rgba(0, 212, 255, 255) !important; background-color: rgba(0, 212, 255, 0.08) !important;">Decision Tree</td>
<td style="text-align: right; background-color: rgba(0, 212, 255, 0.08) !important;">13.8861</td>
<td style="text-align: right; background-color: rgba(0, 212, 255, 0.08) !important;">11.8376</td>
<td style="text-align: right; background-color: rgba(0, 212, 255, 0.08) !important;">0.2182</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold; color: rgba(0, 212, 255, 255) !important;">Random Forest</td>
<td style="text-align: right;">13.8890</td>
<td style="text-align: right;">11.8419</td>
<td style="text-align: right;">0.2179</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold; color: rgba(0, 212, 255, 255) !important;">Linear Regression</td>
<td style="text-align: right;">14.0959</td>
<td style="text-align: right;">11.9719</td>
<td style="text-align: right;">0.1944</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Best model statement ---</span></span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a>best_model_age     <span class="ot">&lt;-</span> model_comparison_age<span class="sc">$</span>Model[<span class="dv">1</span>]</span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a>best_rmse_age      <span class="ot">&lt;-</span> model_comparison_age<span class="sc">$</span>RMSE[<span class="dv">1</span>]</span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true" tabindex="-1"></a>best_mae_age       <span class="ot">&lt;-</span> model_comparison_age<span class="sc">$</span>MAE[<span class="dv">1</span>]</span>
<span id="cb173-5"><a href="#cb173-5" aria-hidden="true" tabindex="-1"></a>best_rsquared_age  <span class="ot">&lt;-</span> model_comparison_age<span class="sc">$</span>R_Squared[<span class="dv">1</span>]</span>
<span id="cb173-6"><a href="#cb173-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-7"><a href="#cb173-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Best Performing Model:"</span>, best_model_age, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Best Performing Model: Decision Tree </code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"RMSE:                 "</span>, best_rmse_age, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>RMSE:                  13.8861 </code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"MAE:                  "</span>, best_mae_age, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>MAE:                   11.8376 </code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"R-Squared:            "</span>, best_rsquared_age, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>R-Squared:             0.2182 </code></pre>
</div>
</div>
</section>
<section id="actual-vs-predicted-table-for-the-decision-tree" class="level2" data-number="6.6">
<h2 data-number="6.6" class="anchored" data-anchor-id="actual-vs-predicted-table-for-the-decision-tree"><span class="header-section-number">6.6</span> Actual vs Predicted Table For The Decision Tree</h2>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Actual vs Predicted comparison ---</span></span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a>age_results <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Actual    =</span> test_y_age,</span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Predicted =</span> <span class="fu">round</span>(pred_dt_age, <span class="dv">1</span>),</span>
<span id="cb181-5"><a href="#cb181-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Error     =</span> <span class="fu">round</span>(<span class="fu">abs</span>(test_y_age <span class="sc">-</span> pred_dt_age), <span class="dv">1</span>)</span>
<span id="cb181-6"><a href="#cb181-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb181-7"><a href="#cb181-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb181-8"><a href="#cb181-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Error_Band =</span> <span class="fu">case_when</span>(</span>
<span id="cb181-9"><a href="#cb181-9" aria-hidden="true" tabindex="-1"></a>      Error <span class="sc">&lt;=</span> <span class="dv">5</span>  <span class="sc">~</span> <span class="st">"Within 5 years"</span>,</span>
<span id="cb181-10"><a href="#cb181-10" aria-hidden="true" tabindex="-1"></a>      Error <span class="sc">&lt;=</span> <span class="dv">10</span> <span class="sc">~</span> <span class="st">"Within 10 years"</span>,</span>
<span id="cb181-11"><a href="#cb181-11" aria-hidden="true" tabindex="-1"></a>      Error <span class="sc">&lt;=</span> <span class="dv">15</span> <span class="sc">~</span> <span class="st">"Within 15 years"</span>,</span>
<span id="cb181-12"><a href="#cb181-12" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span>        <span class="sc">~</span> <span class="st">"More than 15 years"</span></span>
<span id="cb181-13"><a href="#cb181-13" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb181-14"><a href="#cb181-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb181-15"><a href="#cb181-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-16"><a href="#cb181-16" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Error band summary ---</span></span>
<span id="cb181-17"><a href="#cb181-17" aria-hidden="true" tabindex="-1"></a>error_summary <span class="ot">&lt;-</span> age_results <span class="sc">%&gt;%</span></span>
<span id="cb181-18"><a href="#cb181-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Error_Band) <span class="sc">%&gt;%</span></span>
<span id="cb181-19"><a href="#cb181-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb181-20"><a href="#cb181-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">Count      =</span> <span class="fu">n</span>(),</span>
<span id="cb181-21"><a href="#cb181-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">Percentage =</span> <span class="fu">round</span>(Count <span class="sc">/</span> <span class="fu">nrow</span>(age_results) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>)</span>
<span id="cb181-22"><a href="#cb181-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb181-23"><a href="#cb181-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Percentage <span class="sc">%&gt;%</span> <span class="fu">desc</span>())</span>
<span id="cb181-24"><a href="#cb181-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-25"><a href="#cb181-25" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Display error band table ---</span></span>
<span id="cb181-26"><a href="#cb181-26" aria-hidden="true" tabindex="-1"></a>error_summary <span class="sc">%&gt;%</span></span>
<span id="cb181-27"><a href="#cb181-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(</span>
<span id="cb181-28"><a href="#cb181-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Prediction Accuracy"</span>, <span class="st">"Count"</span>, <span class="st">"Percentage (%)"</span>),</span>
<span id="cb181-29"><a href="#cb181-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption   =</span> <span class="st">"Table: Actual vs Predicted Age — Error Band Summary"</span></span>
<span id="cb181-30"><a href="#cb181-30" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb181-31"><a href="#cb181-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb181-32"><a href="#cb181-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"#00d4ff"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small">
<caption>Table: Actual vs Predicted Age — Error Band Summary</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Prediction Accuracy</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Count</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Percentage (%)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; font-weight: bold; color: rgba(0, 212, 255, 255) !important;">More than 15 years</td>
<td style="text-align: right;">5506</td>
<td style="text-align: right;">34.43</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold; color: rgba(0, 212, 255, 255) !important;">Within 5 years</td>
<td style="text-align: right;">3567</td>
<td style="text-align: right;">22.30</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold; color: rgba(0, 212, 255, 255) !important;">Within 10 years</td>
<td style="text-align: right;">3515</td>
<td style="text-align: right;">21.98</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold; color: rgba(0, 212, 255, 255) !important;">Within 15 years</td>
<td style="text-align: right;">3405</td>
<td style="text-align: right;">21.29</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Overall prediction summary ---</span></span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Age Prediction Summary: Decision Tree:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Age Prediction Summary: Decision Tree:</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Mean Absolute Error:"</span>, <span class="fu">round</span>(<span class="fu">mean</span>(age_results<span class="sc">$</span>Error), <span class="dv">2</span>), <span class="st">"years</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Mean Absolute Error: 11.84 years</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Median Error:       "</span>, <span class="fu">round</span>(<span class="fu">median</span>(age_results<span class="sc">$</span>Error), <span class="dv">2</span>), <span class="st">"years</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Median Error:        11.5 years</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Min Error:          "</span>, <span class="fu">round</span>(<span class="fu">min</span>(age_results<span class="sc">$</span>Error), <span class="dv">2</span>), <span class="st">"years</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Min Error:           0 years</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Max Error:          "</span>, <span class="fu">round</span>(<span class="fu">max</span>(age_results<span class="sc">$</span>Error), <span class="dv">2</span>), <span class="st">"years</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Max Error:           28.6 years</code></pre>
</div>
</div>
</section>
<section id="save-the-best-age-model" class="level2" data-number="6.7">
<h2 data-number="6.7" class="anchored" data-anchor-id="save-the-best-age-model"><span class="header-section-number">6.7</span> Save The Best Age Model</h2>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Save best model for age prediction ---</span></span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(model_dt_age, <span class="st">"best_model_age.rds"</span>)</span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Best model for age prediction saved successfully.</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Best model for age prediction saved successfully.</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Model: Decision Tree</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Model: Decision Tree</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"File:  best_model_age.rds</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>File:  best_model_age.rds</code></pre>
</div>
</div>
</section>
<section id="interpretation-age-prediction" class="level2" data-number="6.8">
<h2 data-number="6.8" class="anchored" data-anchor-id="interpretation-age-prediction"><span class="header-section-number">6.8</span> Interpretation: Age Prediction</h2>
<p>The Decision Tree achieved the lowest RMSE of <strong>13.89 years</strong> and an R-Squared of <strong>0.2182</strong>, marginally outperforming Random Forest (RMSE = 13.89, R² = 0.2179) and comfortably ahead of Linear Regression (RMSE = 14.10, R² = 0.1944).</p>
<p>However, the error band analysis reveals the honest limitations of this model:</p>
<ul>
<li>Only <strong>22.30%</strong> of predictions fall within 5 years of the actual age</li>
<li><strong>34.43%</strong> of predictions are off by more than 15 years, the largest single category</li>
<li>The mean absolute error is <strong>11.84 years</strong>, meaning on average the model misjudges a customer’s age by nearly 12 years</li>
</ul>
<p>This confirms the upfront acknowledgement that age is a challenging variable to predict from the available data. With an R-Squared of just 0.2182, channel, amount, and region together explain only <strong>21.82% of the variance in customer age</strong>, the remaining 78.18% is driven by factors not captured in this dataset.</p>
<p><strong>Recommendation:</strong> This model is not reliable enough for operational use in its current form. Blackwell would need richer customer data, such as browsing behaviour, product categories purchased, or loyalty programme data, to build a meaningfully accurate age prediction model. The finding itself is valuable however, confirming that transaction data alone is insufficient to infer customer age.</p>
</section>
</section>
<section id="region-prediction" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Region Prediction</h1>
<p>The third and final modelling task investigates whether the region a customer belongs to can be predicted from their demographic and transaction data. This is a multi-class classification problem, the target variable has four possible outcomes: North, South, East, and West.</p>
<p>Successfully predicting customer region would allow Blackwell to infer the geographic location of new or anonymous customers from their transaction behaviour alone, enabling region-specific marketing without requiring customers to explicitly provide their location.</p>
<p><strong>Candidate predictor variables:</strong> age, channel, items, amount</p>
<section id="data-splitting-2" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="data-splitting-2"><span class="header-section-number">7.1</span> Data Splitting</h2>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 80/20 Train/Test Split ---</span></span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a>train_index_region <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(df<span class="sc">$</span>region, <span class="at">p =</span> <span class="fl">0.8</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb198-4"><a href="#cb198-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-5"><a href="#cb198-5" aria-hidden="true" tabindex="-1"></a>train_region <span class="ot">&lt;-</span> df[train_index_region, ]</span>
<span id="cb198-6"><a href="#cb198-6" aria-hidden="true" tabindex="-1"></a>test_region  <span class="ot">&lt;-</span> df[<span class="sc">-</span>train_index_region, ]</span>
<span id="cb198-7"><a href="#cb198-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-8"><a href="#cb198-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Region Prediction — Data Split Summary:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Region Prediction — Data Split Summary:</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Training set:"</span>, <span class="fu">nrow</span>(train_region), <span class="st">"rows</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Training set: 63985 rows</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb202"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Test set:    "</span>, <span class="fu">nrow</span>(test_region), <span class="st">"rows</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Test set:     15994 rows</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Verify class balance in split ---</span></span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Training set region distribution:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Training set region distribution:</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb206"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">prop.table</span>(<span class="fu">table</span>(train_region<span class="sc">$</span>region)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    North     South      East      West 
0.2000156 0.2499961 0.2250527 0.3249355 </code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb208"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Test set region distribution:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Test set region distribution:</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb210"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">prop.table</span>(<span class="fu">table</span>(test_region<span class="sc">$</span>region)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    North     South      East      West 
0.2000125 0.2499687 0.2250844 0.3249344 </code></pre>
</div>
</div>
</section>
<section id="feature-selection-1" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="feature-selection-1"><span class="header-section-number">7.2</span> Feature Selection</h2>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb212"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Recursive Feature Elimination for Region Prediction ---</span></span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a>rfe_control_region <span class="ot">&lt;-</span> <span class="fu">rfeControl</span>(</span>
<span id="cb212-3"><a href="#cb212-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">functions =</span> rfFuncs,</span>
<span id="cb212-4"><a href="#cb212-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">method    =</span> <span class="st">"cv"</span>,</span>
<span id="cb212-5"><a href="#cb212-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">number    =</span> <span class="dv">5</span>,</span>
<span id="cb212-6"><a href="#cb212-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">verbose   =</span> <span class="cn">FALSE</span></span>
<span id="cb212-7"><a href="#cb212-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb212-8"><a href="#cb212-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-9"><a href="#cb212-9" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Prepare features and target ---</span></span>
<span id="cb212-10"><a href="#cb212-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert factors to numeric for RFE compatibility</span></span>
<span id="cb212-11"><a href="#cb212-11" aria-hidden="true" tabindex="-1"></a>train_region_rfe <span class="ot">&lt;-</span> train_region <span class="sc">%&gt;%</span></span>
<span id="cb212-12"><a href="#cb212-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">channel_num =</span> <span class="fu">as.numeric</span>(channel))</span>
<span id="cb212-13"><a href="#cb212-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-14"><a href="#cb212-14" aria-hidden="true" tabindex="-1"></a>rfe_features_region <span class="ot">&lt;-</span> train_region_rfe <span class="sc">%&gt;%</span></span>
<span id="cb212-15"><a href="#cb212-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(age, channel_num, items, amount)</span>
<span id="cb212-16"><a href="#cb212-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-17"><a href="#cb212-17" aria-hidden="true" tabindex="-1"></a>rfe_target_region <span class="ot">&lt;-</span> train_region_rfe<span class="sc">$</span>region</span>
<span id="cb212-18"><a href="#cb212-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-19"><a href="#cb212-19" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Run RFE ---</span></span>
<span id="cb212-20"><a href="#cb212-20" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb212-21"><a href="#cb212-21" aria-hidden="true" tabindex="-1"></a>rfe_result_region <span class="ot">&lt;-</span> <span class="fu">rfe</span>(</span>
<span id="cb212-22"><a href="#cb212-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">x          =</span> rfe_features_region,</span>
<span id="cb212-23"><a href="#cb212-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">y          =</span> rfe_target_region,</span>
<span id="cb212-24"><a href="#cb212-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">sizes      =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>),</span>
<span id="cb212-25"><a href="#cb212-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">rfeControl =</span> rfe_control_region</span>
<span id="cb212-26"><a href="#cb212-26" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb212-27"><a href="#cb212-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-28"><a href="#cb212-28" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Results ---</span></span>
<span id="cb212-29"><a href="#cb212-29" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Optimal Features Selected:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Optimal Features Selected:</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb214"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">predictors</span>(rfe_result_region))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "channel_num" "amount"      "age"        </code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb216"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">RFE Performance Summary:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
RFE Performance Summary:</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb218"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(rfe_result_region)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Recursive feature selection

Outer resampling method: Cross-Validated (5 fold) 

Resampling performance over subset size:

 Variables Accuracy  Kappa AccuracySD   KappaSD Selected
         1   0.4500 0.2904  2.158e-05 0.0002476         
         2   0.6263 0.4970  1.235e-03 0.0018071         
         3   0.6427 0.5166  3.726e-03 0.0050547        *
         4   0.6315 0.5009  3.588e-03 0.0049032         

The top 3 variables (out of 3):
   channel_num, amount, age</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb220"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- RFE plot ---</span></span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(rfe_result_region) <span class="sc">+</span></span>
<span id="cb220-3"><a href="#cb220-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb220-4"><a href="#cb220-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">title    =</span> <span class="st">"Figure: RFE — Feature Selection for Region Prediction"</span>,</span>
<span id="cb220-5"><a href="#cb220-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Accuracy by number of features selected"</span>,</span>
<span id="cb220-6"><a href="#cb220-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x        =</span> <span class="st">"Number of Features"</span>,</span>
<span id="cb220-7"><a href="#cb220-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y        =</span> <span class="st">"Accuracy (Cross-Validated)"</span></span>
<span id="cb220-8"><a href="#cb220-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb220-9"><a href="#cb220-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb220-10"><a href="#cb220-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb220-11"><a href="#cb220-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background   =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#12121a"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb220-12"><a href="#cb220-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background  =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#1e1e2e"</span>, <span class="at">color =</span> <span class="st">"#2a2a3a"</span>),</span>
<span id="cb220-13"><a href="#cb220-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major  =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#3a3a4a"</span>),</span>
<span id="cb220-14"><a href="#cb220-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor  =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#2a2a3a"</span>),</span>
<span id="cb220-15"><a href="#cb220-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title        =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#ffffff"</span>,</span>
<span id="cb220-16"><a href="#cb220-16" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">face  =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb220-17"><a href="#cb220-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle     =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb220-18"><a href="#cb220-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text         =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#e8e8e8"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb220-19"><a href="#cb220-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title        =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#e8e8e8"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb220-20"><a href="#cb220-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line         =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>),</span>
<span id="cb220-21"><a href="#cb220-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#1e1e2e"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb220-22"><a href="#cb220-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text       =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#e8e8e8"</span>),</span>
<span id="cb220-23"><a href="#cb220-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title      =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#e8e8e8"</span>)</span>
<span id="cb220-24"><a href="#cb220-24" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="blackwell-customer-analytics_files/figure-html/region-rfe-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="feature-selection-results-2" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="feature-selection-results-2"><span class="header-section-number">7.3</span> Feature Selection Results</h2>
<p>Recursive Feature Elimination identified <strong>three optimal features</strong> for predicting customer region: <strong>channel, amount, and age.</strong></p>
<p>Notably, <code>items</code> has now been eliminated across all three modelling tasks, consistently contributing no meaningful predictive power throughout this entire analysis.</p>
<p>Accuracy improves from 0.45 with one feature to <strong>0.6427 with three features</strong>. Adding the fourth feature (items) actually reduces accuracy to 0.6315, confirming the three-feature model as optimal.</p>
<p>All three models will be trained using channel, amount, and age as predictor variables.</p>
</section>
<section id="region-model-training" class="level2" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="region-model-training"><span class="header-section-number">7.4</span> Region Model Training</h2>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb221"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Prepare train and test sets with RFE selected features ---</span></span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true" tabindex="-1"></a>train_x_region <span class="ot">&lt;-</span> train_region <span class="sc">%&gt;%</span> <span class="fu">select</span>(age, amount, channel)</span>
<span id="cb221-3"><a href="#cb221-3" aria-hidden="true" tabindex="-1"></a>test_x_region  <span class="ot">&lt;-</span> test_region <span class="sc">%&gt;%</span> <span class="fu">select</span>(age, amount, channel)</span>
<span id="cb221-4"><a href="#cb221-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-5"><a href="#cb221-5" aria-hidden="true" tabindex="-1"></a>train_y_region <span class="ot">&lt;-</span> train_region<span class="sc">$</span>region</span>
<span id="cb221-6"><a href="#cb221-6" aria-hidden="true" tabindex="-1"></a>test_y_region  <span class="ot">&lt;-</span> test_region<span class="sc">$</span>region</span>
<span id="cb221-7"><a href="#cb221-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-8"><a href="#cb221-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Training models with features: age, amount, channel</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Training models with features: age, amount, channel</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb223"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Model 1: Multinomial Logistic Regression ---</span></span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb223-3"><a href="#cb223-3" aria-hidden="true" tabindex="-1"></a>model_lr_region <span class="ot">&lt;-</span> <span class="fu">train</span>(</span>
<span id="cb223-4"><a href="#cb223-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">x          =</span> train_x_region,</span>
<span id="cb223-5"><a href="#cb223-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">y          =</span> train_y_region,</span>
<span id="cb223-6"><a href="#cb223-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">method     =</span> <span class="st">"multinom"</span>,</span>
<span id="cb223-7"><a href="#cb223-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">trControl  =</span> train_control,</span>
<span id="cb223-8"><a href="#cb223-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">preProcess =</span> <span class="fu">c</span>(<span class="st">"center"</span>, <span class="st">"scale"</span>),</span>
<span id="cb223-9"><a href="#cb223-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">trace      =</span> <span class="cn">FALSE</span></span>
<span id="cb223-10"><a href="#cb223-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb223-11"><a href="#cb223-11" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Multinomial Logistic Regression — Trained</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Multinomial Logistic Regression — Trained</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb225"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Model 2: Random Forest ---</span></span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb225-3"><a href="#cb225-3" aria-hidden="true" tabindex="-1"></a>model_rf_region <span class="ot">&lt;-</span> <span class="fu">train</span>(</span>
<span id="cb225-4"><a href="#cb225-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">x          =</span> train_x_region,</span>
<span id="cb225-5"><a href="#cb225-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">y          =</span> train_y_region,</span>
<span id="cb225-6"><a href="#cb225-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">method     =</span> <span class="st">"rf"</span>,</span>
<span id="cb225-7"><a href="#cb225-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">trControl  =</span> train_control,</span>
<span id="cb225-8"><a href="#cb225-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">preProcess =</span> <span class="fu">c</span>(<span class="st">"center"</span>, <span class="st">"scale"</span>),</span>
<span id="cb225-9"><a href="#cb225-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">tuneLength =</span> <span class="dv">3</span></span>
<span id="cb225-10"><a href="#cb225-10" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>note: only 2 unique complexity parameters in default grid. Truncating the grid to 2 .</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb227"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Random Forest — Trained</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Random Forest — Trained</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb229"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Model 3: Decision Tree ---</span></span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb229-3"><a href="#cb229-3" aria-hidden="true" tabindex="-1"></a>model_dt_region <span class="ot">&lt;-</span> <span class="fu">train</span>(</span>
<span id="cb229-4"><a href="#cb229-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">x          =</span> train_x_region,</span>
<span id="cb229-5"><a href="#cb229-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">y          =</span> train_y_region,</span>
<span id="cb229-6"><a href="#cb229-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">method     =</span> <span class="st">"rpart"</span>,</span>
<span id="cb229-7"><a href="#cb229-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">trControl  =</span> train_control,</span>
<span id="cb229-8"><a href="#cb229-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">preProcess =</span> <span class="fu">c</span>(<span class="st">"center"</span>, <span class="st">"scale"</span>),</span>
<span id="cb229-9"><a href="#cb229-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">tuneLength =</span> <span class="dv">10</span></span>
<span id="cb229-10"><a href="#cb229-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb229-11"><a href="#cb229-11" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Decision Tree — Trained</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Decision Tree — Trained</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb231"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">All three models trained successfully.</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
All three models trained successfully.</code></pre>
</div>
</div>
</section>
<section id="region-comparison-table-and-best-model" class="level2" data-number="7.5">
<h2 data-number="7.5" class="anchored" data-anchor-id="region-comparison-table-and-best-model"><span class="header-section-number">7.5</span> Region Comparison Table And Best Model</h2>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb233"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Predictions on test set ---</span></span>
<span id="cb233-2"><a href="#cb233-2" aria-hidden="true" tabindex="-1"></a>pred_lr_region <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_lr_region, test_x_region)</span>
<span id="cb233-3"><a href="#cb233-3" aria-hidden="true" tabindex="-1"></a>pred_rf_region <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_rf_region, test_x_region)</span>
<span id="cb233-4"><a href="#cb233-4" aria-hidden="true" tabindex="-1"></a>pred_dt_region <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_dt_region, test_x_region)</span>
<span id="cb233-5"><a href="#cb233-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-6"><a href="#cb233-6" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Confusion matrices ---</span></span>
<span id="cb233-7"><a href="#cb233-7" aria-hidden="true" tabindex="-1"></a>cm_lr_region <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_lr_region, test_y_region)</span>
<span id="cb233-8"><a href="#cb233-8" aria-hidden="true" tabindex="-1"></a>cm_rf_region <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_rf_region, test_y_region)</span>
<span id="cb233-9"><a href="#cb233-9" aria-hidden="true" tabindex="-1"></a>cm_dt_region <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_dt_region, test_y_region)</span>
<span id="cb233-10"><a href="#cb233-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-11"><a href="#cb233-11" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Model comparison table ---</span></span>
<span id="cb233-12"><a href="#cb233-12" aria-hidden="true" tabindex="-1"></a>model_comparison_region <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb233-13"><a href="#cb233-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model    =</span> <span class="fu">c</span>(<span class="st">"Multinomial Logistic Regression"</span>,</span>
<span id="cb233-14"><a href="#cb233-14" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Random Forest"</span>,</span>
<span id="cb233-15"><a href="#cb233-15" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Decision Tree"</span>),</span>
<span id="cb233-16"><a href="#cb233-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">Accuracy =</span> <span class="fu">c</span>(cm_lr_region<span class="sc">$</span>overall[<span class="st">"Accuracy"</span>],</span>
<span id="cb233-17"><a href="#cb233-17" aria-hidden="true" tabindex="-1"></a>               cm_rf_region<span class="sc">$</span>overall[<span class="st">"Accuracy"</span>],</span>
<span id="cb233-18"><a href="#cb233-18" aria-hidden="true" tabindex="-1"></a>               cm_dt_region<span class="sc">$</span>overall[<span class="st">"Accuracy"</span>]),</span>
<span id="cb233-19"><a href="#cb233-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">Kappa    =</span> <span class="fu">c</span>(cm_lr_region<span class="sc">$</span>overall[<span class="st">"Kappa"</span>],</span>
<span id="cb233-20"><a href="#cb233-20" aria-hidden="true" tabindex="-1"></a>               cm_rf_region<span class="sc">$</span>overall[<span class="st">"Kappa"</span>],</span>
<span id="cb233-21"><a href="#cb233-21" aria-hidden="true" tabindex="-1"></a>               cm_dt_region<span class="sc">$</span>overall[<span class="st">"Kappa"</span>])</span>
<span id="cb233-22"><a href="#cb233-22" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb233-23"><a href="#cb233-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span> <span class="fu">round</span>(., <span class="dv">4</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb233-24"><a href="#cb233-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Accuracy))</span>
<span id="cb233-25"><a href="#cb233-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-26"><a href="#cb233-26" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Display comparison table ---</span></span>
<span id="cb233-27"><a href="#cb233-27" aria-hidden="true" tabindex="-1"></a>model_comparison_region <span class="sc">%&gt;%</span></span>
<span id="cb233-28"><a href="#cb233-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(</span>
<span id="cb233-29"><a href="#cb233-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Model"</span>, <span class="st">"Accuracy"</span>, <span class="st">"Kappa"</span>),</span>
<span id="cb233-30"><a href="#cb233-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption   =</span> <span class="st">"Table: Model Comparison Region Prediction"</span></span>
<span id="cb233-31"><a href="#cb233-31" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb233-32"><a href="#cb233-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb233-33"><a href="#cb233-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"#00d4ff"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb233-34"><a href="#cb233-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="dv">1</span>, <span class="at">background =</span> <span class="st">"rgba(0, 212, 255, 0.08)"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small">
<caption>Table: Model Comparison Region Prediction</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Model</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Accuracy</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Kappa</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; font-weight: bold; color: rgba(0, 212, 255, 255) !important; background-color: rgba(0, 212, 255, 0.08) !important;">Decision Tree</td>
<td style="text-align: right; background-color: rgba(0, 212, 255, 0.08) !important;">0.6441</td>
<td style="text-align: right; background-color: rgba(0, 212, 255, 0.08) !important;">0.5175</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold; color: rgba(0, 212, 255, 255) !important;">Random Forest</td>
<td style="text-align: right;">0.6233</td>
<td style="text-align: right;">0.4892</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold; color: rgba(0, 212, 255, 255) !important;">Multinomial Logistic Regression</td>
<td style="text-align: right;">0.6090</td>
<td style="text-align: right;">0.4733</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb234"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Best model statement ---</span></span>
<span id="cb234-2"><a href="#cb234-2" aria-hidden="true" tabindex="-1"></a>best_model_region    <span class="ot">&lt;-</span> model_comparison_region<span class="sc">$</span>Model[<span class="dv">1</span>]</span>
<span id="cb234-3"><a href="#cb234-3" aria-hidden="true" tabindex="-1"></a>best_accuracy_region <span class="ot">&lt;-</span> <span class="fu">round</span>(model_comparison_region<span class="sc">$</span>Accuracy[<span class="dv">1</span>] <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>)</span>
<span id="cb234-4"><a href="#cb234-4" aria-hidden="true" tabindex="-1"></a>best_kappa_region    <span class="ot">&lt;-</span> model_comparison_region<span class="sc">$</span>Kappa[<span class="dv">1</span>]</span>
<span id="cb234-5"><a href="#cb234-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb234-6"><a href="#cb234-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Best Performing Model:"</span>, best_model_region, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Best Performing Model: Decision Tree </code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb236"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Test Set Accuracy:    "</span>, best_accuracy_region, <span class="st">"%</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Test Set Accuracy:     64.41 %</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb238"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Kappa Statistic:      "</span>, best_kappa_region, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Kappa Statistic:       0.5175 </code></pre>
</div>
</div>
</section>
<section id="actual-vs-predicted-table-decision-tree" class="level2" data-number="7.6">
<h2 data-number="7.6" class="anchored" data-anchor-id="actual-vs-predicted-table-decision-tree"><span class="header-section-number">7.6</span> Actual vs Predicted Table: Decision Tree</h2>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb240"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Actual vs Predicted comparison ---</span></span>
<span id="cb240-2"><a href="#cb240-2" aria-hidden="true" tabindex="-1"></a>region_results <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb240-3"><a href="#cb240-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Actual    =</span> test_y_region,</span>
<span id="cb240-4"><a href="#cb240-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Predicted =</span> pred_dt_region,</span>
<span id="cb240-5"><a href="#cb240-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Correct   =</span> test_y_region <span class="sc">==</span> pred_dt_region</span>
<span id="cb240-6"><a href="#cb240-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb240-7"><a href="#cb240-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb240-8"><a href="#cb240-8" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Actual vs Predicted summary table ---</span></span>
<span id="cb240-9"><a href="#cb240-9" aria-hidden="true" tabindex="-1"></a>region_summary <span class="ot">&lt;-</span> region_results <span class="sc">%&gt;%</span></span>
<span id="cb240-10"><a href="#cb240-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Actual, Predicted) <span class="sc">%&gt;%</span></span>
<span id="cb240-11"><a href="#cb240-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb240-12"><a href="#cb240-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb240-13"><a href="#cb240-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">Result =</span> <span class="fu">ifelse</span>(Actual <span class="sc">==</span> Predicted,</span>
<span id="cb240-14"><a href="#cb240-14" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"Correct"</span>, <span class="st">"Incorrect"</span>)</span>
<span id="cb240-15"><a href="#cb240-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb240-16"><a href="#cb240-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Actual, Predicted)</span>
<span id="cb240-17"><a href="#cb240-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb240-18"><a href="#cb240-18" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Display actual vs predicted table ---</span></span>
<span id="cb240-19"><a href="#cb240-19" aria-hidden="true" tabindex="-1"></a>region_summary <span class="sc">%&gt;%</span></span>
<span id="cb240-20"><a href="#cb240-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(</span>
<span id="cb240-21"><a href="#cb240-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Actual"</span>, <span class="st">"Predicted"</span>,</span>
<span id="cb240-22"><a href="#cb240-22" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Count"</span>, <span class="st">"Result"</span>),</span>
<span id="cb240-23"><a href="#cb240-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption   =</span> <span class="st">"Table: Actual vs Predicted: Region (Decision Tree)"</span></span>
<span id="cb240-24"><a href="#cb240-24" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb240-25"><a href="#cb240-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb240-26"><a href="#cb240-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"#00d4ff"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb240-27"><a href="#cb240-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">4</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>,</span>
<span id="cb240-28"><a href="#cb240-28" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="fu">ifelse</span>(region_summary<span class="sc">$</span>Result <span class="sc">==</span> <span class="st">"Correct"</span>,</span>
<span id="cb240-29"><a href="#cb240-29" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"#00ff9d"</span>, <span class="st">"#ff6b6b"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small">
<caption>Table: Actual vs Predicted: Region (Decision Tree)</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Actual</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Predicted</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Count</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; font-weight: bold; color: rgba(0, 212, 255, 255) !important;">North</td>
<td style="text-align: left;">North</td>
<td style="text-align: right;">1739</td>
<td style="text-align: left; font-weight: bold; color: rgba(0, 255, 157, 255) !important;">Correct</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold; color: rgba(0, 212, 255, 255) !important;">North</td>
<td style="text-align: left;">East</td>
<td style="text-align: right;">652</td>
<td style="text-align: left; font-weight: bold; color: rgba(255, 107, 107, 255) !important;">Incorrect</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold; color: rgba(0, 212, 255, 255) !important;">North</td>
<td style="text-align: left;">West</td>
<td style="text-align: right;">808</td>
<td style="text-align: left; font-weight: bold; color: rgba(255, 107, 107, 255) !important;">Incorrect</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold; color: rgba(0, 212, 255, 255) !important;">South</td>
<td style="text-align: left;">South</td>
<td style="text-align: right;">3995</td>
<td style="text-align: left; font-weight: bold; color: rgba(0, 255, 157, 255) !important;">Correct</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold; color: rgba(0, 212, 255, 255) !important;">South</td>
<td style="text-align: left;">West</td>
<td style="text-align: right;">3</td>
<td style="text-align: left; font-weight: bold; color: rgba(255, 107, 107, 255) !important;">Incorrect</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold; color: rgba(0, 212, 255, 255) !important;">East</td>
<td style="text-align: left;">North</td>
<td style="text-align: right;">1426</td>
<td style="text-align: left; font-weight: bold; color: rgba(255, 107, 107, 255) !important;">Incorrect</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold; color: rgba(0, 212, 255, 255) !important;">East</td>
<td style="text-align: left;">South</td>
<td style="text-align: right;">152</td>
<td style="text-align: left; font-weight: bold; color: rgba(255, 107, 107, 255) !important;">Incorrect</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold; color: rgba(0, 212, 255, 255) !important;">East</td>
<td style="text-align: left;">East</td>
<td style="text-align: right;">724</td>
<td style="text-align: left; font-weight: bold; color: rgba(0, 255, 157, 255) !important;">Correct</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold; color: rgba(0, 212, 255, 255) !important;">East</td>
<td style="text-align: left;">West</td>
<td style="text-align: right;">1298</td>
<td style="text-align: left; font-weight: bold; color: rgba(255, 107, 107, 255) !important;">Incorrect</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold; color: rgba(0, 212, 255, 255) !important;">West</td>
<td style="text-align: left;">North</td>
<td style="text-align: right;">1081</td>
<td style="text-align: left; font-weight: bold; color: rgba(255, 107, 107, 255) !important;">Incorrect</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold; color: rgba(0, 212, 255, 255) !important;">West</td>
<td style="text-align: left;">South</td>
<td style="text-align: right;">272</td>
<td style="text-align: left; font-weight: bold; color: rgba(255, 107, 107, 255) !important;">Incorrect</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold; color: rgba(0, 212, 255, 255) !important;">West</td>
<td style="text-align: left;">West</td>
<td style="text-align: right;">3844</td>
<td style="text-align: left; font-weight: bold; color: rgba(0, 255, 157, 255) !important;">Correct</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb241"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Overall prediction breakdown ---</span></span>
<span id="cb241-2"><a href="#cb241-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Region Prediction Breakdown:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Region Prediction Breakdown:</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb243"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Correctly classified:  "</span>, <span class="fu">sum</span>(region_results<span class="sc">$</span>Correct), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Correctly classified:   10302 </code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb245"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Incorrectly classified:"</span>, <span class="fu">sum</span>(<span class="sc">!</span>region_results<span class="sc">$</span>Correct), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Incorrectly classified: 5692 </code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb247"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Overall Accuracy:      "</span>,</span>
<span id="cb247-2"><a href="#cb247-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">mean</span>(region_results<span class="sc">$</span>Correct) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>), <span class="st">"%</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Overall Accuracy:       64.41 %</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb249"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb249-1"><a href="#cb249-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Per region accuracy ---</span></span>
<span id="cb249-2"><a href="#cb249-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Per Region Accuracy:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Per Region Accuracy:</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb251"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb251-1"><a href="#cb251-1" aria-hidden="true" tabindex="-1"></a>region_results <span class="sc">%&gt;%</span></span>
<span id="cb251-2"><a href="#cb251-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Actual) <span class="sc">%&gt;%</span></span>
<span id="cb251-3"><a href="#cb251-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb251-4"><a href="#cb251-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total   =</span> <span class="fu">n</span>(),</span>
<span id="cb251-5"><a href="#cb251-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Correct =</span> <span class="fu">sum</span>(Correct),</span>
<span id="cb251-6"><a href="#cb251-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Accuracy =</span> <span class="fu">round</span>(<span class="fu">mean</span>(Correct) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>)</span>
<span id="cb251-7"><a href="#cb251-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb251-8"><a href="#cb251-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 4
  Actual Total Correct Accuracy
  &lt;fct&gt;  &lt;int&gt;   &lt;int&gt;    &lt;dbl&gt;
1 North   3199    1739   173900
2 South   3998    3995   399500
3 East    3600     724    72400
4 West    5197    3844   384400</code></pre>
</div>
</div>
</section>
<section id="save-region-best-model" class="level2" data-number="7.7">
<h2 data-number="7.7" class="anchored" data-anchor-id="save-region-best-model"><span class="header-section-number">7.7</span> Save Region Best Model</h2>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb253"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb253-1"><a href="#cb253-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Save best model for region prediction ---</span></span>
<span id="cb253-2"><a href="#cb253-2" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(model_dt_region, <span class="st">"best_model_region.rds"</span>)</span>
<span id="cb253-3"><a href="#cb253-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb253-4"><a href="#cb253-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Best model for region prediction saved successfully.</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Best model for region prediction saved successfully.</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb255"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Model: Decision Tree</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Model: Decision Tree</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb257"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb257-1"><a href="#cb257-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"File:  best_model_region.rds</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>File:  best_model_region.rds</code></pre>
</div>
</div>
</section>
<section id="interpretation-region-prediction" class="level2" data-number="7.8">
<h2 data-number="7.8" class="anchored" data-anchor-id="interpretation-region-prediction"><span class="header-section-number">7.8</span> Interpretation: Region Prediction</h2>
<p>The Decision Tree outperformed both Random Forest and Multinomial Logistic Regression, achieving a test set accuracy of <strong>64.41%</strong> and a Kappa of <strong>0.5175</strong>, indicating moderate agreement beyond chance for a four-class prediction problem.</p>
<p>The per region accuracy reveals a striking performance imbalance:</p>
<ul>
<li><strong>South, 99.92% accuracy</strong>, virtually perfect. The South’s distinct customer profile, older age, low spending ceiling of $499.94, makes it uniquely identifiable from other regions.</li>
<li><strong>West ,73.96% accuracy</strong>, good performance, driven by the West’s young, high-spending customer profile.</li>
<li><strong>North, 54.36% accuracy</strong>, moderate. North customers share demographic overlap with both East and West, making them harder to distinguish.</li>
<li><strong>East, 20.11% accuracy</strong>, poor. The majority of East customers are misclassified as North (1,426 cases), suggesting the two regions have very similar demographic and spending profiles that the model cannot reliably separate.</li>
</ul>
<p>Overall, 10,302 out of 15,994 customers were correctly classified, with 5,692 misclassifications, concentrated almost entirely in the East region.</p>
<p><strong>Recommendation:</strong> The model is reliable for identifying South and West customers, but struggles significantly with East region customers. Blackwell should treat East region predictions with caution. Richer data such as product category preferences or browsing behaviour would likely improve East vs North discrimination considerably.</p>
</section>
</section>
<section id="conclusions-recommendations" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Conclusions &amp; Recommendations</h1>
<p>This section brings together the key findings from both the Exploratory Data Analysis and the Predictive Modelling phases into a concise, actionable summary for Danielle Sherman and Martin Goodrich. Every conclusion drawn here is grounded directly in the data, no assumptions, no generalisations.</p>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb259"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb259-1"><a href="#cb259-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Final findings summary table ---</span></span>
<span id="cb259-2"><a href="#cb259-2" aria-hidden="true" tabindex="-1"></a>conclusions <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb259-3"><a href="#cb259-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Business_Question =</span> <span class="fu">c</span>(</span>
<span id="cb259-4"><a href="#cb259-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Do customers in different regions spend more per transaction?"</span>,</span>
<span id="cb259-5"><a href="#cb259-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Is there a relationship between items purchased and amount spent?"</span>,</span>
<span id="cb259-6"><a href="#cb259-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Do older customers spend more than younger customers?"</span>,</span>
<span id="cb259-7"><a href="#cb259-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Are in-store customers older than online customers?"</span>,</span>
<span id="cb259-8"><a href="#cb259-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Are there age differences across regions?"</span>,</span>
<span id="cb259-9"><a href="#cb259-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Can purchase channel be predicted?"</span>,</span>
<span id="cb259-10"><a href="#cb259-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Can customer age be predicted?"</span>,</span>
<span id="cb259-11"><a href="#cb259-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Can customer region be predicted?"</span></span>
<span id="cb259-12"><a href="#cb259-12" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb259-13"><a href="#cb259-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Finding =</span> <span class="fu">c</span>(</span>
<span id="cb259-14"><a href="#cb259-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Yes, significant regional differences exist. West leads ($1,283.94), South trails ($252.10) with a spending ceiling of $499.94."</span>,</span>
<span id="cb259-15"><a href="#cb259-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"No, Pearson r = 0.0004. No meaningful relationship exists between items purchased and amount spent."</span>,</span>
<span id="cb259-16"><a href="#cb259-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">"No, the data contradicts this hypothesis. Younger customers spend more. Pearson r = -0.282."</span>,</span>
<span id="cb259-17"><a href="#cb259-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"No, the data contradicts this hypothesis. Online customers are older (mean 48.56) than in-store (mean 42.96)."</span>,</span>
<span id="cb259-18"><a href="#cb259-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Yes, statistically significant age differences exist across regions (F = 6,139.42, p &lt; 0.0001). South is oldest (56.6), West is youngest (38.8)."</span>,</span>
<span id="cb259-19"><a href="#cb259-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Yes — Decision Tree achieves 88.82% accuracy. Online customers identified with near-perfect precision."</span>,</span>
<span id="cb259-20"><a href="#cb259-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Partially Decision Tree RMSE = 13.89 years, R² = 0.22. Model explains only 21.82% of age variance. Not reliable for operational use."</span>,</span>
<span id="cb259-21"><a href="#cb259-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Partially, Decision Tree achieves 64.41% accuracy. South (99.92%) and West (73.96%) predicted well. East poorly predicted (20.11%)."</span></span>
<span id="cb259-22"><a href="#cb259-22" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb259-23"><a href="#cb259-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">Recommendation =</span> <span class="fu">c</span>(</span>
<span id="cb259-24"><a href="#cb259-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Allocate higher marketing budgets to West and East. Deploy value-oriented strategy for South. Investigate absence of high-value purchases in South."</span>,</span>
<span id="cb259-25"><a href="#cb259-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Bundling and volume-based pricing strategies are unlikely to drive higher revenue. Focus on product type and price point instead."</span>,</span>
<span id="cb259-26"><a href="#cb259-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Marketing campaigns targeting older customers as higher spenders are not justified. Focus high-value campaigns on younger demographics (18-39)."</span>,</span>
<span id="cb259-27"><a href="#cb259-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">"The website already attracts older customers. Focus should shift to understanding why younger in-store customers generate higher transaction values."</span>,</span>
<span id="cb259-28"><a href="#cb259-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Regional marketing should account for demographic differences. South needs trust-building, value-oriented messaging. West and East suit premium campaigns."</span>,</span>
<span id="cb259-29"><a href="#cb259-29" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Deploy the Decision Tree model to proactively segment customers by channel for targeted marketing communications."</span>,</span>
<span id="cb259-30"><a href="#cb259-30" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Transaction data alone is insufficient to predict age reliably. Richer data, browsing behaviour, product categories are needed."</span>,</span>
<span id="cb259-31"><a href="#cb259-31" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Model is reliable for South and West segmentation. East region predictions should be treated with caution until richer data is available."</span></span>
<span id="cb259-32"><a href="#cb259-32" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb259-33"><a href="#cb259-33" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb259-34"><a href="#cb259-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb259-35"><a href="#cb259-35" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Display conclusions table ---</span></span>
<span id="cb259-36"><a href="#cb259-36" aria-hidden="true" tabindex="-1"></a>conclusions <span class="sc">%&gt;%</span></span>
<span id="cb259-37"><a href="#cb259-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(</span>
<span id="cb259-38"><a href="#cb259-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Business Question"</span>, </span>
<span id="cb259-39"><a href="#cb259-39" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Finding"</span>, </span>
<span id="cb259-40"><a href="#cb259-40" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Recommendation"</span>),</span>
<span id="cb259-41"><a href="#cb259-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption   =</span> <span class="st">"Table: Summary of Findings &amp; Recommendations"</span></span>
<span id="cb259-42"><a href="#cb259-42" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb259-43"><a href="#cb259-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb259-44"><a href="#cb259-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"#00d4ff"</span>, <span class="at">width =</span> <span class="st">"25%"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb259-45"><a href="#cb259-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">2</span>, <span class="at">width =</span> <span class="st">"40%"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb259-46"><a href="#cb259-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">3</span>, <span class="at">width =</span> <span class="st">"35%"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small">
<caption>Table: Summary of Findings &amp; Recommendations</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Business Question</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Finding</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Recommendation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; width: 25%; font-weight: bold; color: rgba(0, 212, 255, 255) !important;">Do customers in different regions spend more per transaction?</td>
<td style="text-align: left; width: 40%;">Yes, significant regional differences exist. West leads ($1,283.94), South trails ($252.10) with a spending ceiling of $499.94.</td>
<td style="text-align: left; width: 35%;">Allocate higher marketing budgets to West and East. Deploy value-oriented strategy for South. Investigate absence of high-value purchases in South.</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 25%; font-weight: bold; color: rgba(0, 212, 255, 255) !important;">Is there a relationship between items purchased and amount spent?</td>
<td style="text-align: left; width: 40%;">No, Pearson r = 0.0004. No meaningful relationship exists between items purchased and amount spent.</td>
<td style="text-align: left; width: 35%;">Bundling and volume-based pricing strategies are unlikely to drive higher revenue. Focus on product type and price point instead.</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 25%; font-weight: bold; color: rgba(0, 212, 255, 255) !important;">Do older customers spend more than younger customers?</td>
<td style="text-align: left; width: 40%;">No, the data contradicts this hypothesis. Younger customers spend more. Pearson r = -0.282.</td>
<td style="text-align: left; width: 35%;">Marketing campaigns targeting older customers as higher spenders are not justified. Focus high-value campaigns on younger demographics (18-39).</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 25%; font-weight: bold; color: rgba(0, 212, 255, 255) !important;">Are in-store customers older than online customers?</td>
<td style="text-align: left; width: 40%;">No, the data contradicts this hypothesis. Online customers are older (mean 48.56) than in-store (mean 42.96).</td>
<td style="text-align: left; width: 35%;">The website already attracts older customers. Focus should shift to understanding why younger in-store customers generate higher transaction values.</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 25%; font-weight: bold; color: rgba(0, 212, 255, 255) !important;">Are there age differences across regions?</td>
<td style="text-align: left; width: 40%;">Yes, statistically significant age differences exist across regions (F = 6,139.42, p &lt; 0.0001). South is oldest (56.6), West is youngest (38.8).</td>
<td style="text-align: left; width: 35%;">Regional marketing should account for demographic differences. South needs trust-building, value-oriented messaging. West and East suit premium campaigns.</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 25%; font-weight: bold; color: rgba(0, 212, 255, 255) !important;">Can purchase channel be predicted?</td>
<td style="text-align: left; width: 40%;">Yes — Decision Tree achieves 88.82% accuracy. Online customers identified with near-perfect precision.</td>
<td style="text-align: left; width: 35%;">Deploy the Decision Tree model to proactively segment customers by channel for targeted marketing communications.</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 25%; font-weight: bold; color: rgba(0, 212, 255, 255) !important;">Can customer age be predicted?</td>
<td style="text-align: left; width: 40%;">Partially Decision Tree RMSE = 13.89 years, R² = 0.22. Model explains only 21.82% of age variance. Not reliable for operational use.</td>
<td style="text-align: left; width: 35%;">Transaction data alone is insufficient to predict age reliably. Richer data, browsing behaviour, product categories are needed.</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 25%; font-weight: bold; color: rgba(0, 212, 255, 255) !important;">Can customer region be predicted?</td>
<td style="text-align: left; width: 40%;">Partially, Decision Tree achieves 64.41% accuracy. South (99.92%) and West (73.96%) predicted well. East poorly predicted (20.11%).</td>
<td style="text-align: left; width: 35%;">Model is reliable for South and West segmentation. East region predictions should be treated with caution until richer data is available.</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="closing-remarks" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="closing-remarks"><span class="header-section-number">8.1</span> Closing Remarks</h2>
<p>This analysis has delivered data-driven answers to every business question posed by Danielle Sherman and tested both hypotheses raised by Martin Goodrich. The findings are clear:</p>
<p><strong>Martin’s hypotheses are not supported by the data.</strong> Older customers do not spend more, and in-store customers are not older than online customers. Any business decisions based on these assumptions would be misdirected.</p>
<p><strong>Regional differences are the most actionable insight.</strong> The West and East regions represent Blackwell’s highest-value customer segments, while the South presents a fundamentally different and more constrained spending profile that warrants its own dedicated strategy.</p>
<p><strong>The Decision Tree model is the strongest performer</strong> across all three prediction tasks achieving 88.82% accuracy for channel prediction, and providing reliable region segmentation for South and West customers.</p>
<p><strong>The most important limitation</strong> identified in this analysis is data richness. Transaction data alone, five variables across 80,000 records has clear predictive limits, particularly for age prediction. Blackwell’s next step should be enriching their customer data collection to include browsing behaviour, product category preferences, and loyalty programme engagement. This would unlock significantly more powerful predictive models and deeper customer insights.</p>
<p><strong><em>Analysis conducted by Freda Erinmwingbovo ; February 2026</em></strong></p>
<!-- -->

</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb260" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb260-2"><a href="#cb260-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Blackwell Electronics"</span></span>
<span id="cb260-3"><a href="#cb260-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "Customer Analytics Report — Purchasing Behaviour &amp; Demographics"</span></span>
<span id="cb260-4"><a href="#cb260-4" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Freda Erinmwingbovo"</span></span>
<span id="cb260-5"><a href="#cb260-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> today</span></span>
<span id="cb260-6"><a href="#cb260-6" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb260-7"><a href="#cb260-7" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb260-8"><a href="#cb260-8" aria-hidden="true" tabindex="-1"></a><span class="co">    theme: [darkly, custom.scss]</span></span>
<span id="cb260-9"><a href="#cb260-9" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb260-10"><a href="#cb260-10" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-depth: 3</span></span>
<span id="cb260-11"><a href="#cb260-11" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-title: "Report Contents"</span></span>
<span id="cb260-12"><a href="#cb260-12" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-location: left</span></span>
<span id="cb260-13"><a href="#cb260-13" aria-hidden="true" tabindex="-1"></a><span class="co">    number-sections: true</span></span>
<span id="cb260-14"><a href="#cb260-14" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb260-15"><a href="#cb260-15" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb260-16"><a href="#cb260-16" aria-hidden="true" tabindex="-1"></a><span class="co">    code-summary: "Show Code"</span></span>
<span id="cb260-17"><a href="#cb260-17" aria-hidden="true" tabindex="-1"></a><span class="co">    df-print: paged</span></span>
<span id="cb260-18"><a href="#cb260-18" aria-hidden="true" tabindex="-1"></a><span class="co">    page-layout: article</span></span>
<span id="cb260-19"><a href="#cb260-19" aria-hidden="true" tabindex="-1"></a><span class="co">    smooth-scroll: true</span></span>
<span id="cb260-20"><a href="#cb260-20" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb260-21"><a href="#cb260-21" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb260-22"><a href="#cb260-22" aria-hidden="true" tabindex="-1"></a><span class="co">  message: false</span></span>
<span id="cb260-23"><a href="#cb260-23" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb260-24"><a href="#cb260-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-25"><a href="#cb260-25" aria-hidden="true" tabindex="-1"></a><span class="in">```{=html}</span></span>
<span id="cb260-26"><a href="#cb260-26" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;div class="cover-header"&gt;</span></span>
<span id="cb260-27"><a href="#cb260-27" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;div class="cover-top-bar"&gt;</span></span>
<span id="cb260-28"><a href="#cb260-28" aria-hidden="true" tabindex="-1"></a><span class="in">    &lt;span class="cover-company"&gt;BLACKWELL ELECTRONICS&lt;/span&gt;</span></span>
<span id="cb260-29"><a href="#cb260-29" aria-hidden="true" tabindex="-1"></a><span class="in">    &lt;span class="cover-tag"&gt;CONFIDENTIAL INTERNAL REPORT&lt;/span&gt;</span></span>
<span id="cb260-30"><a href="#cb260-30" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;/div&gt;</span></span>
<span id="cb260-31"><a href="#cb260-31" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;div class="cover-main"&gt;</span></span>
<span id="cb260-32"><a href="#cb260-32" aria-hidden="true" tabindex="-1"></a><span class="in">    &lt;div class="cover-label"&gt;Customer Analytics&lt;/div&gt;</span></span>
<span id="cb260-33"><a href="#cb260-33" aria-hidden="true" tabindex="-1"></a><span class="in">    &lt;h1 class="cover-title"&gt;Purchasing Behaviour&lt;br/&gt;&amp;amp; Demographics&lt;/h1&gt;</span></span>
<span id="cb260-34"><a href="#cb260-34" aria-hidden="true" tabindex="-1"></a><span class="in">    &lt;p class="cover-subtitle"&gt;</span></span>
<span id="cb260-35"><a href="#cb260-35" aria-hidden="true" tabindex="-1"></a><span class="in">      An investigation into regional spending patterns, customer demographics,</span></span>
<span id="cb260-36"><a href="#cb260-36" aria-hidden="true" tabindex="-1"></a><span class="in">      and predictive modelling of purchase behaviour across 80,000 transactions.</span></span>
<span id="cb260-37"><a href="#cb260-37" aria-hidden="true" tabindex="-1"></a><span class="in">    &lt;/p&gt;</span></span>
<span id="cb260-38"><a href="#cb260-38" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;/div&gt;</span></span>
<span id="cb260-39"><a href="#cb260-39" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;div class="cover-bottom-bar"&gt;</span></span>
<span id="cb260-40"><a href="#cb260-40" aria-hidden="true" tabindex="-1"></a><span class="in">    &lt;div class="cover-meta"&gt;</span></span>
<span id="cb260-41"><a href="#cb260-41" aria-hidden="true" tabindex="-1"></a><span class="in">      &lt;span class="meta-label"&gt;PREPARED BY&lt;/span&gt;</span></span>
<span id="cb260-42"><a href="#cb260-42" aria-hidden="true" tabindex="-1"></a><span class="in">      &lt;span class="meta-value"&gt;Freda Erinmwingbovo&lt;/span&gt;</span></span>
<span id="cb260-43"><a href="#cb260-43" aria-hidden="true" tabindex="-1"></a><span class="in">    &lt;/div&gt;</span></span>
<span id="cb260-44"><a href="#cb260-44" aria-hidden="true" tabindex="-1"></a><span class="in">    &lt;div class="cover-meta"&gt;</span></span>
<span id="cb260-45"><a href="#cb260-45" aria-hidden="true" tabindex="-1"></a><span class="in">      &lt;span class="meta-label"&gt;PREPARED FOR&lt;/span&gt;</span></span>
<span id="cb260-46"><a href="#cb260-46" aria-hidden="true" tabindex="-1"></a><span class="in">      &lt;span class="meta-value"&gt;Danielle Sherman, CTO&lt;/span&gt;</span></span>
<span id="cb260-47"><a href="#cb260-47" aria-hidden="true" tabindex="-1"></a><span class="in">    &lt;/div&gt;</span></span>
<span id="cb260-48"><a href="#cb260-48" aria-hidden="true" tabindex="-1"></a><span class="in">    &lt;div class="cover-meta"&gt;</span></span>
<span id="cb260-49"><a href="#cb260-49" aria-hidden="true" tabindex="-1"></a><span class="in">      &lt;span class="meta-label"&gt;DATE&lt;/span&gt;</span></span>
<span id="cb260-50"><a href="#cb260-50" aria-hidden="true" tabindex="-1"></a><span class="in">      &lt;span class="meta-value"&gt;February 2026&lt;/span&gt;</span></span>
<span id="cb260-51"><a href="#cb260-51" aria-hidden="true" tabindex="-1"></a><span class="in">    &lt;/div&gt;</span></span>
<span id="cb260-52"><a href="#cb260-52" aria-hidden="true" tabindex="-1"></a><span class="in">    &lt;div class="cover-meta"&gt;</span></span>
<span id="cb260-53"><a href="#cb260-53" aria-hidden="true" tabindex="-1"></a><span class="in">      &lt;span class="meta-label"&gt;RECORDS ANALYSED&lt;/span&gt;</span></span>
<span id="cb260-54"><a href="#cb260-54" aria-hidden="true" tabindex="-1"></a><span class="in">      &lt;span class="meta-value"&gt;80,000 Transactions&lt;/span&gt;</span></span>
<span id="cb260-55"><a href="#cb260-55" aria-hidden="true" tabindex="-1"></a><span class="in">    &lt;/div&gt;</span></span>
<span id="cb260-56"><a href="#cb260-56" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;/div&gt;</span></span>
<span id="cb260-57"><a href="#cb260-57" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;/div&gt;</span></span>
<span id="cb260-58"><a href="#cb260-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-59"><a href="#cb260-59" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;style&gt;</span></span>
<span id="cb260-60"><a href="#cb260-60" aria-hidden="true" tabindex="-1"></a><span class="in">.cover-header {</span></span>
<span id="cb260-61"><a href="#cb260-61" aria-hidden="true" tabindex="-1"></a><span class="in">  background: linear-gradient(135deg, #0a0a0f 0%, #12121a 50%, #0d0d1f 100%);</span></span>
<span id="cb260-62"><a href="#cb260-62" aria-hidden="true" tabindex="-1"></a><span class="in">  border: 1px solid #2a2a3a;</span></span>
<span id="cb260-63"><a href="#cb260-63" aria-hidden="true" tabindex="-1"></a><span class="in">  border-left: 4px solid #00d4ff;</span></span>
<span id="cb260-64"><a href="#cb260-64" aria-hidden="true" tabindex="-1"></a><span class="in">  border-radius: 8px;</span></span>
<span id="cb260-65"><a href="#cb260-65" aria-hidden="true" tabindex="-1"></a><span class="in">  margin: 0 0 3rem 0;</span></span>
<span id="cb260-66"><a href="#cb260-66" aria-hidden="true" tabindex="-1"></a><span class="in">  overflow: hidden;</span></span>
<span id="cb260-67"><a href="#cb260-67" aria-hidden="true" tabindex="-1"></a><span class="in">  position: relative;</span></span>
<span id="cb260-68"><a href="#cb260-68" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb260-69"><a href="#cb260-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-70"><a href="#cb260-70" aria-hidden="true" tabindex="-1"></a><span class="in">.cover-header::before {</span></span>
<span id="cb260-71"><a href="#cb260-71" aria-hidden="true" tabindex="-1"></a><span class="in">  content: 'BWE';</span></span>
<span id="cb260-72"><a href="#cb260-72" aria-hidden="true" tabindex="-1"></a><span class="in">  position: absolute;</span></span>
<span id="cb260-73"><a href="#cb260-73" aria-hidden="true" tabindex="-1"></a><span class="in">  right: -10px;</span></span>
<span id="cb260-74"><a href="#cb260-74" aria-hidden="true" tabindex="-1"></a><span class="in">  top: 50%;</span></span>
<span id="cb260-75"><a href="#cb260-75" aria-hidden="true" tabindex="-1"></a><span class="in">  transform: translateY(-50%);</span></span>
<span id="cb260-76"><a href="#cb260-76" aria-hidden="true" tabindex="-1"></a><span class="in">  font-size: 12rem;</span></span>
<span id="cb260-77"><a href="#cb260-77" aria-hidden="true" tabindex="-1"></a><span class="in">  font-weight: 900;</span></span>
<span id="cb260-78"><a href="#cb260-78" aria-hidden="true" tabindex="-1"></a><span class="in">  color: rgba(0, 212, 255, 0.03);</span></span>
<span id="cb260-79"><a href="#cb260-79" aria-hidden="true" tabindex="-1"></a><span class="in">  font-family: 'Cormorant Garamond', serif;</span></span>
<span id="cb260-80"><a href="#cb260-80" aria-hidden="true" tabindex="-1"></a><span class="in">  line-height: 1;</span></span>
<span id="cb260-81"><a href="#cb260-81" aria-hidden="true" tabindex="-1"></a><span class="in">  pointer-events: none;</span></span>
<span id="cb260-82"><a href="#cb260-82" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb260-83"><a href="#cb260-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-84"><a href="#cb260-84" aria-hidden="true" tabindex="-1"></a><span class="in">.cover-top-bar {</span></span>
<span id="cb260-85"><a href="#cb260-85" aria-hidden="true" tabindex="-1"></a><span class="in">  display: flex;</span></span>
<span id="cb260-86"><a href="#cb260-86" aria-hidden="true" tabindex="-1"></a><span class="in">  justify-content: space-between;</span></span>
<span id="cb260-87"><a href="#cb260-87" aria-hidden="true" tabindex="-1"></a><span class="in">  align-items: center;</span></span>
<span id="cb260-88"><a href="#cb260-88" aria-hidden="true" tabindex="-1"></a><span class="in">  padding: 14px 32px;</span></span>
<span id="cb260-89"><a href="#cb260-89" aria-hidden="true" tabindex="-1"></a><span class="in">  background: rgba(0, 212, 255, 0.05);</span></span>
<span id="cb260-90"><a href="#cb260-90" aria-hidden="true" tabindex="-1"></a><span class="in">  border-bottom: 1px solid #2a2a3a;</span></span>
<span id="cb260-91"><a href="#cb260-91" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb260-92"><a href="#cb260-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-93"><a href="#cb260-93" aria-hidden="true" tabindex="-1"></a><span class="in">.cover-company {</span></span>
<span id="cb260-94"><a href="#cb260-94" aria-hidden="true" tabindex="-1"></a><span class="in">  font-family: 'JetBrains Mono', monospace;</span></span>
<span id="cb260-95"><a href="#cb260-95" aria-hidden="true" tabindex="-1"></a><span class="in">  font-size: 0.72rem;</span></span>
<span id="cb260-96"><a href="#cb260-96" aria-hidden="true" tabindex="-1"></a><span class="in">  letter-spacing: 4px;</span></span>
<span id="cb260-97"><a href="#cb260-97" aria-hidden="true" tabindex="-1"></a><span class="in">  color: #00d4ff;</span></span>
<span id="cb260-98"><a href="#cb260-98" aria-hidden="true" tabindex="-1"></a><span class="in">  font-weight: 500;</span></span>
<span id="cb260-99"><a href="#cb260-99" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb260-100"><a href="#cb260-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-101"><a href="#cb260-101" aria-hidden="true" tabindex="-1"></a><span class="in">.cover-tag {</span></span>
<span id="cb260-102"><a href="#cb260-102" aria-hidden="true" tabindex="-1"></a><span class="in">  font-family: 'JetBrains Mono', monospace;</span></span>
<span id="cb260-103"><a href="#cb260-103" aria-hidden="true" tabindex="-1"></a><span class="in">  font-size: 0.65rem;</span></span>
<span id="cb260-104"><a href="#cb260-104" aria-hidden="true" tabindex="-1"></a><span class="in">  letter-spacing: 2px;</span></span>
<span id="cb260-105"><a href="#cb260-105" aria-hidden="true" tabindex="-1"></a><span class="in">  color: #8a8a9a;</span></span>
<span id="cb260-106"><a href="#cb260-106" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb260-107"><a href="#cb260-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-108"><a href="#cb260-108" aria-hidden="true" tabindex="-1"></a><span class="in">.cover-main {</span></span>
<span id="cb260-109"><a href="#cb260-109" aria-hidden="true" tabindex="-1"></a><span class="in">  padding: 52px 32px 40px;</span></span>
<span id="cb260-110"><a href="#cb260-110" aria-hidden="true" tabindex="-1"></a><span class="in">  text-align: center;</span></span>
<span id="cb260-111"><a href="#cb260-111" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb260-112"><a href="#cb260-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-113"><a href="#cb260-113" aria-hidden="true" tabindex="-1"></a><span class="in">.cover-label {</span></span>
<span id="cb260-114"><a href="#cb260-114" aria-hidden="true" tabindex="-1"></a><span class="in">  font-family: 'JetBrains Mono', monospace;</span></span>
<span id="cb260-115"><a href="#cb260-115" aria-hidden="true" tabindex="-1"></a><span class="in">  font-size: 0.7rem;</span></span>
<span id="cb260-116"><a href="#cb260-116" aria-hidden="true" tabindex="-1"></a><span class="in">  letter-spacing: 4px;</span></span>
<span id="cb260-117"><a href="#cb260-117" aria-hidden="true" tabindex="-1"></a><span class="in">  text-transform: uppercase;</span></span>
<span id="cb260-118"><a href="#cb260-118" aria-hidden="true" tabindex="-1"></a><span class="in">  color: #7b61ff;</span></span>
<span id="cb260-119"><a href="#cb260-119" aria-hidden="true" tabindex="-1"></a><span class="in">  margin-bottom: 16px;</span></span>
<span id="cb260-120"><a href="#cb260-120" aria-hidden="true" tabindex="-1"></a><span class="in">  text-align: center;</span></span>
<span id="cb260-121"><a href="#cb260-121" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb260-122"><a href="#cb260-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-123"><a href="#cb260-123" aria-hidden="true" tabindex="-1"></a><span class="in">.cover-title {</span></span>
<span id="cb260-124"><a href="#cb260-124" aria-hidden="true" tabindex="-1"></a><span class="in">  font-family: 'Cormorant Garamond', serif !important;</span></span>
<span id="cb260-125"><a href="#cb260-125" aria-hidden="true" tabindex="-1"></a><span class="in">  font-size: clamp(2.2rem, 5vw, 3.4rem) !important;</span></span>
<span id="cb260-126"><a href="#cb260-126" aria-hidden="true" tabindex="-1"></a><span class="in">  font-weight: 700 !important;</span></span>
<span id="cb260-127"><a href="#cb260-127" aria-hidden="true" tabindex="-1"></a><span class="in">  line-height: 1.15 !important;</span></span>
<span id="cb260-128"><a href="#cb260-128" aria-hidden="true" tabindex="-1"></a><span class="in">  color: #ffffff !important;</span></span>
<span id="cb260-129"><a href="#cb260-129" aria-hidden="true" tabindex="-1"></a><span class="in">  margin-bottom: 24px !important;</span></span>
<span id="cb260-130"><a href="#cb260-130" aria-hidden="true" tabindex="-1"></a><span class="in">  border: none !important;</span></span>
<span id="cb260-131"><a href="#cb260-131" aria-hidden="true" tabindex="-1"></a><span class="in">  padding: 0 !important;</span></span>
<span id="cb260-132"><a href="#cb260-132" aria-hidden="true" tabindex="-1"></a><span class="in">  text-align: center;</span></span>
<span id="cb260-133"><a href="#cb260-133" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb260-134"><a href="#cb260-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-135"><a href="#cb260-135" aria-hidden="true" tabindex="-1"></a><span class="in">.cover-subtitle {</span></span>
<span id="cb260-136"><a href="#cb260-136" aria-hidden="true" tabindex="-1"></a><span class="in">  font-size: 0.95rem;</span></span>
<span id="cb260-137"><a href="#cb260-137" aria-hidden="true" tabindex="-1"></a><span class="in">  color: #8a8a9a;</span></span>
<span id="cb260-138"><a href="#cb260-138" aria-hidden="true" tabindex="-1"></a><span class="in">  max-width: 580px;</span></span>
<span id="cb260-139"><a href="#cb260-139" aria-hidden="true" tabindex="-1"></a><span class="in">  line-height: 1.8;</span></span>
<span id="cb260-140"><a href="#cb260-140" aria-hidden="true" tabindex="-1"></a><span class="in">  margin: 0 auto;</span></span>
<span id="cb260-141"><a href="#cb260-141" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb260-142"><a href="#cb260-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-143"><a href="#cb260-143" aria-hidden="true" tabindex="-1"></a><span class="in">.cover-bottom-bar {</span></span>
<span id="cb260-144"><a href="#cb260-144" aria-hidden="true" tabindex="-1"></a><span class="in">  display: flex;</span></span>
<span id="cb260-145"><a href="#cb260-145" aria-hidden="true" tabindex="-1"></a><span class="in">  gap: 0;</span></span>
<span id="cb260-146"><a href="#cb260-146" aria-hidden="true" tabindex="-1"></a><span class="in">  border-top: 1px solid #2a2a3a;</span></span>
<span id="cb260-147"><a href="#cb260-147" aria-hidden="true" tabindex="-1"></a><span class="in">  flex-wrap: wrap;</span></span>
<span id="cb260-148"><a href="#cb260-148" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb260-149"><a href="#cb260-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-150"><a href="#cb260-150" aria-hidden="true" tabindex="-1"></a><span class="in">.cover-meta {</span></span>
<span id="cb260-151"><a href="#cb260-151" aria-hidden="true" tabindex="-1"></a><span class="in">  display: flex;</span></span>
<span id="cb260-152"><a href="#cb260-152" aria-hidden="true" tabindex="-1"></a><span class="in">  flex-direction: column;</span></span>
<span id="cb260-153"><a href="#cb260-153" aria-hidden="true" tabindex="-1"></a><span class="in">  gap: 5px;</span></span>
<span id="cb260-154"><a href="#cb260-154" aria-hidden="true" tabindex="-1"></a><span class="in">  padding: 20px 32px;</span></span>
<span id="cb260-155"><a href="#cb260-155" aria-hidden="true" tabindex="-1"></a><span class="in">  border-right: 1px solid #2a2a3a;</span></span>
<span id="cb260-156"><a href="#cb260-156" aria-hidden="true" tabindex="-1"></a><span class="in">  flex: 1;</span></span>
<span id="cb260-157"><a href="#cb260-157" aria-hidden="true" tabindex="-1"></a><span class="in">  min-width: 160px;</span></span>
<span id="cb260-158"><a href="#cb260-158" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb260-159"><a href="#cb260-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-160"><a href="#cb260-160" aria-hidden="true" tabindex="-1"></a><span class="in">.meta-label {</span></span>
<span id="cb260-161"><a href="#cb260-161" aria-hidden="true" tabindex="-1"></a><span class="in">  font-family: 'JetBrains Mono', monospace;</span></span>
<span id="cb260-162"><a href="#cb260-162" aria-hidden="true" tabindex="-1"></a><span class="in">  font-size: 0.62rem;</span></span>
<span id="cb260-163"><a href="#cb260-163" aria-hidden="true" tabindex="-1"></a><span class="in">  letter-spacing: 2.5px;</span></span>
<span id="cb260-164"><a href="#cb260-164" aria-hidden="true" tabindex="-1"></a><span class="in">  color: #8a8a9a;</span></span>
<span id="cb260-165"><a href="#cb260-165" aria-hidden="true" tabindex="-1"></a><span class="in">  text-transform: uppercase;</span></span>
<span id="cb260-166"><a href="#cb260-166" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb260-167"><a href="#cb260-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-168"><a href="#cb260-168" aria-hidden="true" tabindex="-1"></a><span class="in">.meta-value {</span></span>
<span id="cb260-169"><a href="#cb260-169" aria-hidden="true" tabindex="-1"></a><span class="in">  font-size: 0.88rem;</span></span>
<span id="cb260-170"><a href="#cb260-170" aria-hidden="true" tabindex="-1"></a><span class="in">  font-weight: 500;</span></span>
<span id="cb260-171"><a href="#cb260-171" aria-hidden="true" tabindex="-1"></a><span class="in">  color: #e8e8e8;</span></span>
<span id="cb260-172"><a href="#cb260-172" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb260-173"><a href="#cb260-173" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;/style&gt;</span></span>
<span id="cb260-174"><a href="#cb260-174" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb260-175"><a href="#cb260-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-176"><a href="#cb260-176" aria-hidden="true" tabindex="-1"></a><span class="fu"># Introduction and Data Loading</span></span>
<span id="cb260-177"><a href="#cb260-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-178"><a href="#cb260-178" aria-hidden="true" tabindex="-1"></a><span class="fu">## Background &amp; Objectives</span></span>
<span id="cb260-179"><a href="#cb260-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-180"><a href="#cb260-180" aria-hidden="true" tabindex="-1"></a>Blackwell Electronics has operated as a successful electronics retailer for over three decades. Following the launch of their eCommerce platform just over a year ago, the business has begun accumulating valuable customer transaction data, both online and in-store.</span>
<span id="cb260-181"><a href="#cb260-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-182"><a href="#cb260-182" aria-hidden="true" tabindex="-1"></a>This report presents a data-driven investigation into customer purchasing behaviour, commissioned by Danielle Sherman (CTO) and informed by the business questions raised by VP of Sales, Martin Goodrich. The analysis is structured around three core questions:</span>
<span id="cb260-183"><a href="#cb260-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-184"><a href="#cb260-184" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Regional Spending**: Do customers in different regions spend more per transaction? Which regions spend the most and least?</span>
<span id="cb260-185"><a href="#cb260-185" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Demographics &amp; Channel**: Are older customers more likely to shop in-store than online? What factors predict how a customer shops?</span>
<span id="cb260-186"><a href="#cb260-186" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>**Predictive Modelling**: Can we predict a customer's region, their purchase channel, or their age from the available data?</span>
<span id="cb260-187"><a href="#cb260-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-188"><a href="#cb260-188" aria-hidden="true" tabindex="-1"></a>The dataset contains **80,000 customer transactions**, capturing age, number of items purchased, transaction amount, purchase channel (online vs. in-store), and region.</span>
<span id="cb260-189"><a href="#cb260-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-190"><a href="#cb260-190" aria-hidden="true" tabindex="-1"></a><span class="fu">## The Libraries Installed</span></span>
<span id="cb260-191"><a href="#cb260-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-192"><a href="#cb260-192" aria-hidden="true" tabindex="-1"></a>The analysis draws on R's <span class="in">`tidyverse`</span> ecosystem for data manipulation and visualisation, and the <span class="in">`caret`</span> framework for machine learning; an industry-standard approach for building and evaluating predictive models.</span>
<span id="cb260-193"><a href="#cb260-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-196"><a href="#cb260-196" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb260-197"><a href="#cb260-197" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: load-libraries</span></span>
<span id="cb260-198"><a href="#cb260-198" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb260-199"><a href="#cb260-199" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb260-200"><a href="#cb260-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-201"><a href="#cb260-201" aria-hidden="true" tabindex="-1"></a><span class="co"># Data manipulation and visualisation</span></span>
<span id="cb260-202"><a href="#cb260-202" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)   <span class="co"># Core suite: dplyr, ggplot2, readr, tidyr etc.</span></span>
<span id="cb260-203"><a href="#cb260-203" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)      <span class="co"># For formatting axes (currency, percentages)</span></span>
<span id="cb260-204"><a href="#cb260-204" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)       <span class="co"># For clean tables in the report</span></span>
<span id="cb260-205"><a href="#cb260-205" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)  <span class="co"># For styled, professional tables</span></span>
<span id="cb260-206"><a href="#cb260-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-207"><a href="#cb260-207" aria-hidden="true" tabindex="-1"></a><span class="co"># Machine learning</span></span>
<span id="cb260-208"><a href="#cb260-208" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)       <span class="co"># Classification and regression training framework</span></span>
<span id="cb260-209"><a href="#cb260-209" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randomForest) <span class="co"># Random Forest algorithm</span></span>
<span id="cb260-210"><a href="#cb260-210" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nnet)        <span class="co"># Multinomial logistic regression (for region prediction)</span></span>
<span id="cb260-211"><a href="#cb260-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-212"><a href="#cb260-212" aria-hidden="true" tabindex="-1"></a><span class="co"># Report styling</span></span>
<span id="cb260-213"><a href="#cb260-213" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggthemes)    <span class="co"># Additional ggplot2 themes</span></span>
<span id="cb260-214"><a href="#cb260-214" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb260-215"><a href="#cb260-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-216"><a href="#cb260-216" aria-hidden="true" tabindex="-1"></a><span class="fu">## Importing the Data</span></span>
<span id="cb260-217"><a href="#cb260-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-220"><a href="#cb260-220" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb260-221"><a href="#cb260-221" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: load-data</span></span>
<span id="cb260-222"><a href="#cb260-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-223"><a href="#cb260-223" aria-hidden="true" tabindex="-1"></a><span class="co"># Import the customer transaction dataset</span></span>
<span id="cb260-224"><a href="#cb260-224" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"Demographic_Data.csv"</span>)</span>
<span id="cb260-225"><a href="#cb260-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-226"><a href="#cb260-226" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename columns for clarity and consistency</span></span>
<span id="cb260-227"><a href="#cb260-227" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb260-228"><a href="#cb260-228" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb260-229"><a href="#cb260-229" aria-hidden="true" tabindex="-1"></a>    <span class="at">channel  =</span> <span class="st">`</span><span class="at">in-store</span><span class="st">`</span>,</span>
<span id="cb260-230"><a href="#cb260-230" aria-hidden="true" tabindex="-1"></a>    <span class="at">age      =</span> age,</span>
<span id="cb260-231"><a href="#cb260-231" aria-hidden="true" tabindex="-1"></a>    <span class="at">items    =</span> items,</span>
<span id="cb260-232"><a href="#cb260-232" aria-hidden="true" tabindex="-1"></a>    <span class="at">amount   =</span> amount,</span>
<span id="cb260-233"><a href="#cb260-233" aria-hidden="true" tabindex="-1"></a>    <span class="at">region   =</span> region</span>
<span id="cb260-234"><a href="#cb260-234" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb260-235"><a href="#cb260-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-236"><a href="#cb260-236" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert categorical variables to factors with meaningful labels</span></span>
<span id="cb260-237"><a href="#cb260-237" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb260-238"><a href="#cb260-238" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb260-239"><a href="#cb260-239" aria-hidden="true" tabindex="-1"></a>    <span class="at">channel =</span> <span class="fu">factor</span>(channel, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), </span>
<span id="cb260-240"><a href="#cb260-240" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Online"</span>, <span class="st">"In-Store"</span>)),</span>
<span id="cb260-241"><a href="#cb260-241" aria-hidden="true" tabindex="-1"></a>    <span class="at">region  =</span> <span class="fu">factor</span>(region, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>),</span>
<span id="cb260-242"><a href="#cb260-242" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"North"</span>, <span class="st">"South"</span>, <span class="st">"East"</span>, <span class="st">"West"</span>))</span>
<span id="cb260-243"><a href="#cb260-243" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb260-244"><a href="#cb260-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-245"><a href="#cb260-245" aria-hidden="true" tabindex="-1"></a><span class="co"># Preview the data</span></span>
<span id="cb260-246"><a href="#cb260-246" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(df)</span>
<span id="cb260-247"><a href="#cb260-247" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb260-248"><a href="#cb260-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-249"><a href="#cb260-249" aria-hidden="true" tabindex="-1"></a><span class="fu"># Data Preprocessing</span></span>
<span id="cb260-250"><a href="#cb260-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-251"><a href="#cb260-251" aria-hidden="true" tabindex="-1"></a>Before any analysis can begin, it is essential to examine the quality and structure of the data. Raw data even from internal systems can contain errors, inconsistencies, missing values, or extreme observations that could distort results and lead to misleading conclusions.</span>
<span id="cb260-252"><a href="#cb260-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-253"><a href="#cb260-253" aria-hidden="true" tabindex="-1"></a>This section documents every step taken to inspect, clean, and validate the dataset prior to analysis. All decisions made during preprocessing are explicitly justified so that the analytical process is fully transparent and reproducible.</span>
<span id="cb260-254"><a href="#cb260-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-255"><a href="#cb260-255" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data Inspection</span></span>
<span id="cb260-256"><a href="#cb260-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-257"><a href="#cb260-257" aria-hidden="true" tabindex="-1"></a>The first step is simply to look at the data carefully: its dimensions, structure, data types, and a statistical snapshot of every variable. This gives us an immediate sense of what we are working with and flags anything that needs attention before we proceed.</span>
<span id="cb260-258"><a href="#cb260-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-261"><a href="#cb260-261" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb260-262"><a href="#cb260-262" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: data-inspection</span></span>
<span id="cb260-263"><a href="#cb260-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-264"><a href="#cb260-264" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Dimensions ---</span></span>
<span id="cb260-265"><a href="#cb260-265" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Rows:"</span>, <span class="fu">nrow</span>(df), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-266"><a href="#cb260-266" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Columns:"</span>, <span class="fu">ncol</span>(df), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-267"><a href="#cb260-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-268"><a href="#cb260-268" aria-hidden="true" tabindex="-1"></a><span class="co"># --- First 6 rows ---</span></span>
<span id="cb260-269"><a href="#cb260-269" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">head</span>() <span class="sc">%&gt;%</span> <span class="fu">kable</span>() <span class="sc">%&gt;%</span> <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">TRUE</span>)</span>
<span id="cb260-270"><a href="#cb260-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-271"><a href="#cb260-271" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Clean styled summary table ---</span></span>
<span id="cb260-272"><a href="#cb260-272" aria-hidden="true" tabindex="-1"></a>summary_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb260-273"><a href="#cb260-273" aria-hidden="true" tabindex="-1"></a>  <span class="at">Variable =</span> <span class="fu">c</span>(<span class="st">"channel"</span>, <span class="st">"age"</span>, <span class="st">"items"</span>, <span class="st">"amount"</span>, <span class="st">"region"</span>),</span>
<span id="cb260-274"><a href="#cb260-274" aria-hidden="true" tabindex="-1"></a>  <span class="at">Type     =</span> <span class="fu">c</span>(<span class="st">"Factor"</span>, <span class="st">"Numeric"</span>, <span class="st">"Numeric"</span>, <span class="st">"Numeric"</span>, <span class="st">"Factor"</span>),</span>
<span id="cb260-275"><a href="#cb260-275" aria-hidden="true" tabindex="-1"></a>  <span class="at">Min      =</span> <span class="fu">c</span>(<span class="st">"—"</span>, <span class="st">"18"</span>, <span class="st">"1"</span>, <span class="st">"$5.01"</span>, <span class="st">"—"</span>),</span>
<span id="cb260-276"><a href="#cb260-276" aria-hidden="true" tabindex="-1"></a>  <span class="at">Mean     =</span> <span class="fu">c</span>(<span class="st">"—"</span>, <span class="st">"45.76"</span>, <span class="st">"4.51"</span>, <span class="st">"$835.92"</span>, <span class="st">"—"</span>),</span>
<span id="cb260-277"><a href="#cb260-277" aria-hidden="true" tabindex="-1"></a>  <span class="at">Median   =</span> <span class="fu">c</span>(<span class="st">"—"</span>, <span class="st">"45"</span>, <span class="st">"4"</span>, <span class="st">"$582.32"</span>, <span class="st">"—"</span>),</span>
<span id="cb260-278"><a href="#cb260-278" aria-hidden="true" tabindex="-1"></a>  <span class="at">Max      =</span> <span class="fu">c</span>(<span class="st">"—"</span>, <span class="st">"85"</span>, <span class="st">"8"</span>, <span class="st">"$3,000"</span>, <span class="st">"—"</span>)</span>
<span id="cb260-279"><a href="#cb260-279" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb260-280"><a href="#cb260-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-281"><a href="#cb260-281" aria-hidden="true" tabindex="-1"></a>summary_table <span class="sc">%&gt;%</span></span>
<span id="cb260-282"><a href="#cb260-282" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>,<span class="st">"l"</span>,<span class="st">"r"</span>,<span class="st">"r"</span>,<span class="st">"r"</span>,<span class="st">"r"</span>,<span class="st">"l"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb260-283"><a href="#cb260-283" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">TRUE</span>)</span>
<span id="cb260-284"><a href="#cb260-284" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb260-285"><a href="#cb260-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-286"><a href="#cb260-286" aria-hidden="true" tabindex="-1"></a><span class="fu">### Interpretation</span></span>
<span id="cb260-287"><a href="#cb260-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-288"><a href="#cb260-288" aria-hidden="true" tabindex="-1"></a>The dataset contains 80,000 rows and 5 columns. Each row represents a single customer transaction. A statistical summary reveals the following initial observations:</span>
<span id="cb260-289"><a href="#cb260-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-290"><a href="#cb260-290" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Age** ranges from 18 to 85, with a mean of approximately 46 years.</span>
<span id="cb260-291"><a href="#cb260-291" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Items** purchased per transaction ranges from 1 to 8, averaging around 4 to 5 items.</span>
<span id="cb260-292"><a href="#cb260-292" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Amount** spent ranges from near zero to several thousand dollars, suggesting potential outliers at both ends that will need investigation.</span>
<span id="cb260-293"><a href="#cb260-293" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Channel** and **Region** are correctly encoded as factors with their respective labels.</span>
<span id="cb260-294"><a href="#cb260-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-295"><a href="#cb260-295" aria-hidden="true" tabindex="-1"></a>No immediately obvious structural issues are visible, but we will now systematically check for missing values, duplicates, and outliers.</span>
<span id="cb260-296"><a href="#cb260-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-297"><a href="#cb260-297" aria-hidden="true" tabindex="-1"></a><span class="fu">## Missing Values</span></span>
<span id="cb260-298"><a href="#cb260-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-299"><a href="#cb260-299" aria-hidden="true" tabindex="-1"></a>Missing data is one of the most common data quality issues in real-world datasets. If left unaddressed, missing values can cause errors in statistical functions and machine learning models, or silently produce biased results. We systematically check every column for the presence of NA values before proceeding.</span>
<span id="cb260-300"><a href="#cb260-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-303"><a href="#cb260-303" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb260-304"><a href="#cb260-304" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: missing-values</span></span>
<span id="cb260-305"><a href="#cb260-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-306"><a href="#cb260-306" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Count of missing values per column ---</span></span>
<span id="cb260-307"><a href="#cb260-307" aria-hidden="true" tabindex="-1"></a>missing_summary <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb260-308"><a href="#cb260-308" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), <span class="sc">~</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(.)))) <span class="sc">%&gt;%</span></span>
<span id="cb260-309"><a href="#cb260-309" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(),</span>
<span id="cb260-310"><a href="#cb260-310" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to  =</span> <span class="st">"Variable"</span>,</span>
<span id="cb260-311"><a href="#cb260-311" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"Missing_Count"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb260-312"><a href="#cb260-312" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb260-313"><a href="#cb260-313" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Rows      =</span> <span class="fu">nrow</span>(df),</span>
<span id="cb260-314"><a href="#cb260-314" aria-hidden="true" tabindex="-1"></a>    <span class="at">Missing_Percent =</span> <span class="fu">round</span>((Missing_Count <span class="sc">/</span> Total_Rows) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>)</span>
<span id="cb260-315"><a href="#cb260-315" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb260-316"><a href="#cb260-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-317"><a href="#cb260-317" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Display as a clean table ---</span></span>
<span id="cb260-318"><a href="#cb260-318" aria-hidden="true" tabindex="-1"></a>missing_summary <span class="sc">%&gt;%</span></span>
<span id="cb260-319"><a href="#cb260-319" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(</span>
<span id="cb260-320"><a href="#cb260-320" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Variable"</span>, <span class="st">"Missing Count"</span>, <span class="st">"Total Rows"</span>, <span class="st">"Missing (%)"</span>),</span>
<span id="cb260-321"><a href="#cb260-321" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption   =</span> <span class="st">"Table: Missing Value Summary"</span></span>
<span id="cb260-322"><a href="#cb260-322" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb260-323"><a href="#cb260-323" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb260-324"><a href="#cb260-324" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb260-325"><a href="#cb260-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-326"><a href="#cb260-326" aria-hidden="true" tabindex="-1"></a><span class="fu">### Interpretation</span></span>
<span id="cb260-327"><a href="#cb260-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-328"><a href="#cb260-328" aria-hidden="true" tabindex="-1"></a>The missing value check confirms that the dataset is complete. Every column registers zero missing values across all 80,000 records. This is an important quality indicator, as it means no imputation strategy is required and we can proceed to the next preprocessing step with confidence that no records will be silently dropped during analysis.</span>
<span id="cb260-329"><a href="#cb260-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-330"><a href="#cb260-330" aria-hidden="true" tabindex="-1"></a><span class="fu">## Duplicate Records</span></span>
<span id="cb260-331"><a href="#cb260-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-332"><a href="#cb260-332" aria-hidden="true" tabindex="-1"></a>Duplicate records occur when the same transaction is captured more than once in a dataset. This can happen due to system errors, data entry mistakes, or merging of multiple data sources. Duplicates artificially inflate sample sizes and can bias both descriptive statistics and machine learning models. We identify and remove any exact duplicate rows before proceeding.</span>
<span id="cb260-333"><a href="#cb260-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-336"><a href="#cb260-336" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb260-337"><a href="#cb260-337" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: duplicates</span></span>
<span id="cb260-338"><a href="#cb260-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-339"><a href="#cb260-339" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Identify and save duplicates before removal ---</span></span>
<span id="cb260-340"><a href="#cb260-340" aria-hidden="true" tabindex="-1"></a>dupes <span class="ot">&lt;-</span> df[<span class="fu">duplicated</span>(df), ]</span>
<span id="cb260-341"><a href="#cb260-341" aria-hidden="true" tabindex="-1"></a>duplicate_count <span class="ot">&lt;-</span> <span class="fu">nrow</span>(dupes)</span>
<span id="cb260-342"><a href="#cb260-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-343"><a href="#cb260-343" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Remove duplicates ---</span></span>
<span id="cb260-344"><a href="#cb260-344" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">distinct</span>()</span>
<span id="cb260-345"><a href="#cb260-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-346"><a href="#cb260-346" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Print counts together ---</span></span>
<span id="cb260-347"><a href="#cb260-347" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Duplicate rows detected:"</span>, duplicate_count, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb260-348"><a href="#cb260-348" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Rows after deduplication:"</span>, <span class="fu">nrow</span>(df), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb260-349"><a href="#cb260-349" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Columns:"</span>, <span class="fu">ncol</span>(df))</span>
<span id="cb260-350"><a href="#cb260-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-351"><a href="#cb260-351" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Preview of removed duplicates as styled table ---</span></span>
<span id="cb260-352"><a href="#cb260-352" aria-hidden="true" tabindex="-1"></a>dupes <span class="sc">%&gt;%</span></span>
<span id="cb260-353"><a href="#cb260-353" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() <span class="sc">%&gt;%</span></span>
<span id="cb260-354"><a href="#cb260-354" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Table: Preview of Duplicate Records Removed"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb260-355"><a href="#cb260-355" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb260-356"><a href="#cb260-356" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb260-357"><a href="#cb260-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-358"><a href="#cb260-358" aria-hidden="true" tabindex="-1"></a><span class="fu">### Interpretation</span></span>
<span id="cb260-359"><a href="#cb260-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-360"><a href="#cb260-360" aria-hidden="true" tabindex="-1"></a>The duplicate check identified 21 exact duplicate records within the dataset. These rows were identical across all five variables, suggesting they are most likely the result of a data entry or system logging error rather than genuine repeat transactions. It is statistically improbable that 21 different customers would independently purchase the exact same number of items for the exact same amount in the same region through the same channel.</span>
<span id="cb260-361"><a href="#cb260-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-362"><a href="#cb260-362" aria-hidden="true" tabindex="-1"></a>All 21 duplicate rows were removed using <span class="in">`distinct()`</span>, reducing the dataset from 80,000 to 79,979 records. This is a negligible reduction of just 0.026% and will have no meaningful impact on the analysis, but it ensures the integrity of every subsequent step.</span>
<span id="cb260-363"><a href="#cb260-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-364"><a href="#cb260-364" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data Types Validation</span></span>
<span id="cb260-365"><a href="#cb260-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-366"><a href="#cb260-366" aria-hidden="true" tabindex="-1"></a>Every variable in a dataset must be stored as the correct data type. A variable stored in the wrong type can cause silent errors. For example, a categorical variable stored as a numeric will be treated as a continuous measurement by statistical functions and machine learning algorithms, producing nonsensical results. We verify that each variable is correctly typed before proceeding.</span>
<span id="cb260-367"><a href="#cb260-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-370"><a href="#cb260-370" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb260-371"><a href="#cb260-371" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: data-types</span></span>
<span id="cb260-372"><a href="#cb260-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-373"><a href="#cb260-373" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Check data types of all columns ---</span></span>
<span id="cb260-374"><a href="#cb260-374" aria-hidden="true" tabindex="-1"></a>data_types <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb260-375"><a href="#cb260-375" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), class)) <span class="sc">%&gt;%</span></span>
<span id="cb260-376"><a href="#cb260-376" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(),</span>
<span id="cb260-377"><a href="#cb260-377" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to  =</span> <span class="st">"Variable"</span>,</span>
<span id="cb260-378"><a href="#cb260-378" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"Data_Type"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb260-379"><a href="#cb260-379" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb260-380"><a href="#cb260-380" aria-hidden="true" tabindex="-1"></a>    <span class="at">Expected_Type =</span> <span class="fu">c</span>(<span class="st">"Factor"</span>, <span class="st">"Numeric"</span>, <span class="st">"Numeric"</span>, <span class="st">"Numeric"</span>, <span class="st">"Factor"</span>),</span>
<span id="cb260-381"><a href="#cb260-381" aria-hidden="true" tabindex="-1"></a>    <span class="at">Status =</span> <span class="fu">ifelse</span>(Data_Type <span class="sc">==</span> <span class="fu">c</span>(<span class="st">"factor"</span>, <span class="st">"numeric"</span>, </span>
<span id="cb260-382"><a href="#cb260-382" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"numeric"</span>, <span class="st">"numeric"</span>, <span class="st">"factor"</span>),</span>
<span id="cb260-383"><a href="#cb260-383" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"✔ Correct"</span>, <span class="st">"✘ Incorrect"</span>)</span>
<span id="cb260-384"><a href="#cb260-384" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb260-385"><a href="#cb260-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-386"><a href="#cb260-386" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Display as clean table ---</span></span>
<span id="cb260-387"><a href="#cb260-387" aria-hidden="true" tabindex="-1"></a>data_types <span class="sc">%&gt;%</span></span>
<span id="cb260-388"><a href="#cb260-388" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(</span>
<span id="cb260-389"><a href="#cb260-389" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Variable"</span>, <span class="st">"Current Type"</span>, <span class="st">"Expected Type"</span>, <span class="st">"Status"</span>),</span>
<span id="cb260-390"><a href="#cb260-390" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption   =</span> <span class="st">"Table: Data Types Validation"</span></span>
<span id="cb260-391"><a href="#cb260-391" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb260-392"><a href="#cb260-392" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb260-393"><a href="#cb260-393" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb260-394"><a href="#cb260-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-395"><a href="#cb260-395" aria-hidden="true" tabindex="-1"></a><span class="fu">### Interpretation</span></span>
<span id="cb260-396"><a href="#cb260-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-397"><a href="#cb260-397" aria-hidden="true" tabindex="-1"></a>All five variables are correctly typed:</span>
<span id="cb260-398"><a href="#cb260-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-399"><a href="#cb260-399" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Channel** and **Region** are stored as factors, meaning R treats them as discrete categories rather than continuous numbers. This is critical, for without this, a region coded 1 to 4 would be interpreted as a measurement where West (4) is somehow "greater than" North (1), which is meaningless.</span>
<span id="cb260-400"><a href="#cb260-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-401"><a href="#cb260-401" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Age**, **Items**, and **Amount** are stored as numeric, which is appropriate as they represent measurable quantities that can be averaged, summed, and used in regression models.</span>
<span id="cb260-402"><a href="#cb260-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-403"><a href="#cb260-403" aria-hidden="true" tabindex="-1"></a>No data type corrections are required. We proceed to outlier detection.</span>
<span id="cb260-404"><a href="#cb260-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-405"><a href="#cb260-405" aria-hidden="true" tabindex="-1"></a><span class="fu">## Outlier Detection</span></span>
<span id="cb260-406"><a href="#cb260-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-407"><a href="#cb260-407" aria-hidden="true" tabindex="-1"></a>Outliers are observations that fall unusually far from the rest of the data. They can arise from genuine extreme behaviour, such as a customer making a very large purchase or from data entry errors. Either way, they require careful investigation because they can heavily distort statistical measures like the mean, and can negatively impact the performance of machine learning models.</span>
<span id="cb260-408"><a href="#cb260-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-409"><a href="#cb260-409" aria-hidden="true" tabindex="-1"></a>We use two complementary approaches to detect outliers:</span>
<span id="cb260-410"><a href="#cb260-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-411"><a href="#cb260-411" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Visual inspection**: boxplots to see the distribution of each numeric variable and immediately spot extreme values</span>
<span id="cb260-412"><a href="#cb260-412" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**The IQR Method**: a statistical rule that flags any observation falling below Q1 − 1.5×IQR or above Q3 + 1.5×IQR as a potential outlier. This is the industry standard for outlier detection.</span>
<span id="cb260-413"><a href="#cb260-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-414"><a href="#cb260-414" aria-hidden="true" tabindex="-1"></a>We examine the three numeric variables: **age**, **items**, and **amount**.</span>
<span id="cb260-415"><a href="#cb260-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-418"><a href="#cb260-418" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb260-419"><a href="#cb260-419" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: outlier-detection</span></span>
<span id="cb260-420"><a href="#cb260-420" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb260-421"><a href="#cb260-421" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb260-422"><a href="#cb260-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-423"><a href="#cb260-423" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Define a consistent colour palette ---</span></span>
<span id="cb260-424"><a href="#cb260-424" aria-hidden="true" tabindex="-1"></a>palette <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb260-425"><a href="#cb260-425" aria-hidden="true" tabindex="-1"></a>  <span class="st">"age"</span>    <span class="ot">=</span> <span class="st">"#00d4ff"</span>,</span>
<span id="cb260-426"><a href="#cb260-426" aria-hidden="true" tabindex="-1"></a>  <span class="st">"items"</span>  <span class="ot">=</span> <span class="st">"#7b61ff"</span>,</span>
<span id="cb260-427"><a href="#cb260-427" aria-hidden="true" tabindex="-1"></a>  <span class="st">"amount"</span> <span class="ot">=</span> <span class="st">"#f0c040"</span></span>
<span id="cb260-428"><a href="#cb260-428" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb260-429"><a href="#cb260-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-430"><a href="#cb260-430" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Reshape data for faceted boxplots ---</span></span>
<span id="cb260-431"><a href="#cb260-431" aria-hidden="true" tabindex="-1"></a>df_long <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb260-432"><a href="#cb260-432" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(age, items, amount) <span class="sc">%&gt;%</span></span>
<span id="cb260-433"><a href="#cb260-433" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(),</span>
<span id="cb260-434"><a href="#cb260-434" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to  =</span> <span class="st">"Variable"</span>,</span>
<span id="cb260-435"><a href="#cb260-435" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"Value"</span>)</span>
<span id="cb260-436"><a href="#cb260-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-437"><a href="#cb260-437" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Boxplots ---</span></span>
<span id="cb260-438"><a href="#cb260-438" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_long, <span class="fu">aes</span>(<span class="at">x =</span> Variable, <span class="at">y =</span> Value, <span class="at">fill =</span> Variable)) <span class="sc">+</span></span>
<span id="cb260-439"><a href="#cb260-439" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.colour =</span> <span class="st">"#ff4d4d"</span>,</span>
<span id="cb260-440"><a href="#cb260-440" aria-hidden="true" tabindex="-1"></a>               <span class="at">outlier.alpha  =</span> <span class="fl">0.3</span>,</span>
<span id="cb260-441"><a href="#cb260-441" aria-hidden="true" tabindex="-1"></a>               <span class="at">outlier.size   =</span> <span class="fl">0.8</span>,</span>
<span id="cb260-442"><a href="#cb260-442" aria-hidden="true" tabindex="-1"></a>               <span class="at">width          =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb260-443"><a href="#cb260-443" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Variable, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">nrow =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb260-444"><a href="#cb260-444" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> palette) <span class="sc">+</span></span>
<span id="cb260-445"><a href="#cb260-445" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb260-446"><a href="#cb260-446" aria-hidden="true" tabindex="-1"></a>    <span class="at">title    =</span> <span class="st">"Figure: Boxplot Distribution of Numeric Variables"</span>,</span>
<span id="cb260-447"><a href="#cb260-447" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Red dots indicate potential outliers flagged by the IQR method"</span>,</span>
<span id="cb260-448"><a href="#cb260-448" aria-hidden="true" tabindex="-1"></a>    <span class="at">x        =</span> <span class="cn">NULL</span>,</span>
<span id="cb260-449"><a href="#cb260-449" aria-hidden="true" tabindex="-1"></a>    <span class="at">y        =</span> <span class="st">"Value"</span></span>
<span id="cb260-450"><a href="#cb260-450" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb260-451"><a href="#cb260-451" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">13</span>) <span class="sc">+</span></span>
<span id="cb260-452"><a href="#cb260-452" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb260-453"><a href="#cb260-453" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background    =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#0a0a0f"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb260-454"><a href="#cb260-454" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background   =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#12121a"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb260-455"><a href="#cb260-455" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major   =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#2a2a3a"</span>),</span>
<span id="cb260-456"><a href="#cb260-456" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor   =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb260-457"><a href="#cb260-457" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background   =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#1a1a2e"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb260-458"><a href="#cb260-458" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text         =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#00d4ff"</span>, </span>
<span id="cb260-459"><a href="#cb260-459" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">face  =</span> <span class="st">"bold"</span>, </span>
<span id="cb260-460"><a href="#cb260-460" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">size  =</span> <span class="dv">10</span>),</span>
<span id="cb260-461"><a href="#cb260-461" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title         =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#ffffff"</span>, </span>
<span id="cb260-462"><a href="#cb260-462" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">face  =</span> <span class="st">"bold"</span>, </span>
<span id="cb260-463"><a href="#cb260-463" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">size  =</span> <span class="dv">13</span>),</span>
<span id="cb260-464"><a href="#cb260-464" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle      =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb260-465"><a href="#cb260-465" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text          =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>),</span>
<span id="cb260-466"><a href="#cb260-466" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title         =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>),</span>
<span id="cb260-467"><a href="#cb260-467" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position    =</span> <span class="st">"none"</span></span>
<span id="cb260-468"><a href="#cb260-468" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb260-469"><a href="#cb260-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-470"><a href="#cb260-470" aria-hidden="true" tabindex="-1"></a><span class="co"># --- IQR Method: Count outliers per variable ---</span></span>
<span id="cb260-471"><a href="#cb260-471" aria-hidden="true" tabindex="-1"></a>count_outliers <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb260-472"><a href="#cb260-472" aria-hidden="true" tabindex="-1"></a>  Q1  <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x, <span class="fl">0.25</span>)</span>
<span id="cb260-473"><a href="#cb260-473" aria-hidden="true" tabindex="-1"></a>  Q3  <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x, <span class="fl">0.75</span>)</span>
<span id="cb260-474"><a href="#cb260-474" aria-hidden="true" tabindex="-1"></a>  IQR <span class="ot">&lt;-</span> Q3 <span class="sc">-</span> Q1</span>
<span id="cb260-475"><a href="#cb260-475" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(x <span class="sc">&lt;</span> (Q1 <span class="sc">-</span> <span class="fl">1.5</span> <span class="sc">*</span> IQR) <span class="sc">|</span> x <span class="sc">&gt;</span> (Q3 <span class="sc">+</span> <span class="fl">1.5</span> <span class="sc">*</span> IQR))</span>
<span id="cb260-476"><a href="#cb260-476" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb260-477"><a href="#cb260-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-478"><a href="#cb260-478" aria-hidden="true" tabindex="-1"></a>outlier_summary <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb260-479"><a href="#cb260-479" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb260-480"><a href="#cb260-480" aria-hidden="true" tabindex="-1"></a>    <span class="at">Age    =</span> <span class="fu">count_outliers</span>(age),</span>
<span id="cb260-481"><a href="#cb260-481" aria-hidden="true" tabindex="-1"></a>    <span class="at">Items  =</span> <span class="fu">count_outliers</span>(items),</span>
<span id="cb260-482"><a href="#cb260-482" aria-hidden="true" tabindex="-1"></a>    <span class="at">Amount =</span> <span class="fu">count_outliers</span>(amount)</span>
<span id="cb260-483"><a href="#cb260-483" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb260-484"><a href="#cb260-484" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(),</span>
<span id="cb260-485"><a href="#cb260-485" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to  =</span> <span class="st">"Variable"</span>,</span>
<span id="cb260-486"><a href="#cb260-486" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"Outlier_Count"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb260-487"><a href="#cb260-487" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb260-488"><a href="#cb260-488" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Rows      =</span> <span class="fu">nrow</span>(df),</span>
<span id="cb260-489"><a href="#cb260-489" aria-hidden="true" tabindex="-1"></a>    <span class="at">Outlier_Percent =</span> <span class="fu">round</span>((Outlier_Count <span class="sc">/</span> Total_Rows) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>)</span>
<span id="cb260-490"><a href="#cb260-490" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb260-491"><a href="#cb260-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-492"><a href="#cb260-492" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Display outlier summary table ---</span></span>
<span id="cb260-493"><a href="#cb260-493" aria-hidden="true" tabindex="-1"></a>outlier_summary <span class="sc">%&gt;%</span></span>
<span id="cb260-494"><a href="#cb260-494" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(</span>
<span id="cb260-495"><a href="#cb260-495" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Variable"</span>, <span class="st">"Outlier Count"</span>, </span>
<span id="cb260-496"><a href="#cb260-496" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Total Rows"</span>, <span class="st">"Outliers (%)"</span>),</span>
<span id="cb260-497"><a href="#cb260-497" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption   =</span> <span class="st">"Table: Outlier Count by Variable (IQR Method)"</span></span>
<span id="cb260-498"><a href="#cb260-498" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb260-499"><a href="#cb260-499" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb260-500"><a href="#cb260-500" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb260-501"><a href="#cb260-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-502"><a href="#cb260-502" aria-hidden="true" tabindex="-1"></a><span class="fu">### Interpretation</span></span>
<span id="cb260-503"><a href="#cb260-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-504"><a href="#cb260-504" aria-hidden="true" tabindex="-1"></a>The boxplots and IQR analysis reveal a clear and important finding:</span>
<span id="cb260-505"><a href="#cb260-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-506"><a href="#cb260-506" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Age**: Zero outliers detected. The age range of 18 to 85 years is entirely plausible for a retail electronics customer base. The distribution is clean and requires no intervention.</span>
<span id="cb260-507"><a href="#cb260-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-508"><a href="#cb260-508" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Items** : Zero outliers detected. With a natural ceiling of 8 items per transaction, this variable is tightly bounded and consistent throughout the dataset.</span>
<span id="cb260-509"><a href="#cb260-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-510"><a href="#cb260-510" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Amount** : **2,320 outliers detected, representing 2.9% of all transactions.** The boxplot clearly shows a right-skewed distribution, with a cluster of transactions at the higher end of the spending range pulling the mean (\$835.92) significantly above the median (\$582.32). These are transactions where customers spent considerably more than the typical customer.</span>
<span id="cb260-511"><a href="#cb260-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-512"><a href="#cb260-512" aria-hidden="true" tabindex="-1"></a>The critical question is: are these outliers errors, or are they real? In an electronics retail context, high-value transactions are entirely plausible. A customer purchasing a high-end television, laptop, or multiple premium devices in a single transaction could legitimately spend at the upper end of the range. The minimum amount of \$5.00 and maximum of \$3,000.00 are both realistic for an electronics retailer.</span>
<span id="cb260-513"><a href="#cb260-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-514"><a href="#cb260-514" aria-hidden="true" tabindex="-1"></a>These outliers are therefore likely **genuine extreme values** rather than data entry errors, and the decision of how to treat them will be addressed in the next step.</span>
<span id="cb260-515"><a href="#cb260-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-516"><a href="#cb260-516" aria-hidden="true" tabindex="-1"></a><span class="fu">## Outlier Treatment</span></span>
<span id="cb260-517"><a href="#cb260-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-518"><a href="#cb260-518" aria-hidden="true" tabindex="-1"></a>Having identified 2,320 outliers in the <span class="in">`amount`</span> variable, we must now decide how to handle them. There are three common approaches:</span>
<span id="cb260-519"><a href="#cb260-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-520"><a href="#cb260-520" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Remove them**: delete all flagged rows from the dataset. This is appropriate when outliers are confirmed errors. However, removing 2.9% of genuine transactions would mean discarding real customer behaviour and potentially biasing our analysis against high-value customers.</span>
<span id="cb260-521"><a href="#cb260-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-522"><a href="#cb260-522" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Cap them (Winsorisation)**: replace values beyond the IQR boundaries with the boundary value itself. This retains all records but reduces the influence of extreme values.</span>
<span id="cb260-523"><a href="#cb260-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-524"><a href="#cb260-524" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>**Retain them**: keep the outliers as-is, on the basis that they represent genuine behaviour. This is appropriate when the data generating process naturally produces extreme values.</span>
<span id="cb260-525"><a href="#cb260-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-526"><a href="#cb260-526" aria-hidden="true" tabindex="-1"></a>Given the business context, an electronics retailer where high-value purchases are entirely expected, a **retain and document** strategy is adopted. The outliers in <span class="in">`amount`</span> reflect real purchasing behaviour from high-spending customers, which is precisely the kind of insight Blackwell's marketing team needs to understand. Removing or capping these values would obscure an important segment of their customer base.</span>
<span id="cb260-527"><a href="#cb260-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-528"><a href="#cb260-528" aria-hidden="true" tabindex="-1"></a>However, to ensure the statistical models are not unduly distorted, a **log transformation** is applied to <span class="in">`amount`</span> where appropriate during the modelling phase. For now, the outliers is documented and proceed with the full dataset intact.</span>
<span id="cb260-529"><a href="#cb260-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-532"><a href="#cb260-532" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb260-533"><a href="#cb260-533" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: outlier-treatment</span></span>
<span id="cb260-534"><a href="#cb260-534" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb260-535"><a href="#cb260-535" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb260-536"><a href="#cb260-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-537"><a href="#cb260-537" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Define IQR boundaries for amount ---</span></span>
<span id="cb260-538"><a href="#cb260-538" aria-hidden="true" tabindex="-1"></a>Q1  <span class="ot">&lt;-</span> <span class="fu">quantile</span>(df<span class="sc">$</span>amount, <span class="fl">0.25</span>)</span>
<span id="cb260-539"><a href="#cb260-539" aria-hidden="true" tabindex="-1"></a>Q3  <span class="ot">&lt;-</span> <span class="fu">quantile</span>(df<span class="sc">$</span>amount, <span class="fl">0.75</span>)</span>
<span id="cb260-540"><a href="#cb260-540" aria-hidden="true" tabindex="-1"></a>IQR <span class="ot">&lt;-</span> Q3 <span class="sc">-</span> Q1</span>
<span id="cb260-541"><a href="#cb260-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-542"><a href="#cb260-542" aria-hidden="true" tabindex="-1"></a>lower_bound <span class="ot">&lt;-</span> Q1 <span class="sc">-</span> <span class="fl">1.5</span> <span class="sc">*</span> IQR</span>
<span id="cb260-543"><a href="#cb260-543" aria-hidden="true" tabindex="-1"></a>upper_bound <span class="ot">&lt;-</span> Q3 <span class="sc">+</span> <span class="fl">1.5</span> <span class="sc">*</span> IQR</span>
<span id="cb260-544"><a href="#cb260-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-545"><a href="#cb260-545" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Amount IQR Boundaries:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-546"><a href="#cb260-546" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Lower Bound: $"</span>, <span class="fu">round</span>(lower_bound, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-547"><a href="#cb260-547" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Upper Bound: $"</span>, <span class="fu">round</span>(upper_bound, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-548"><a href="#cb260-548" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Outliers below lower bound:"</span>, <span class="fu">sum</span>(df<span class="sc">$</span>amount <span class="sc">&lt;</span> lower_bound), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-549"><a href="#cb260-549" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Outliers above upper bound:"</span>, <span class="fu">sum</span>(df<span class="sc">$</span>amount <span class="sc">&gt;</span> upper_bound), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb260-550"><a href="#cb260-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-551"><a href="#cb260-551" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Decision: Retain outliers ---</span></span>
<span id="cb260-552"><a href="#cb260-552" aria-hidden="true" tabindex="-1"></a><span class="co"># We retain all records. Log-transformed amount created for </span></span>
<span id="cb260-553"><a href="#cb260-553" aria-hidden="true" tabindex="-1"></a><span class="co"># modelling use later.</span></span>
<span id="cb260-554"><a href="#cb260-554" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb260-555"><a href="#cb260-555" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">amount_log =</span> <span class="fu">log1p</span>(amount))</span>
<span id="cb260-556"><a href="#cb260-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-557"><a href="#cb260-557" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Log-transformed amount column added.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-558"><a href="#cb260-558" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Final dataset dimensions:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-559"><a href="#cb260-559" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Rows:"</span>, <span class="fu">nrow</span>(df), <span class="st">"| Columns:"</span>, <span class="fu">ncol</span>(df), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-560"><a href="#cb260-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-561"><a href="#cb260-561" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Visual: Original vs Log-transformed amount ---</span></span>
<span id="cb260-562"><a href="#cb260-562" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> amount)) <span class="sc">+</span></span>
<span id="cb260-563"><a href="#cb260-563" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">"#f0c040"</span>, <span class="at">color =</span> <span class="cn">NA</span>, <span class="at">bins =</span> <span class="dv">60</span>, <span class="at">alpha =</span> <span class="fl">0.85</span>) <span class="sc">+</span></span>
<span id="cb260-564"><a href="#cb260-564" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Original Amount"</span>, <span class="at">x =</span> <span class="st">"Amount ($)"</span>, <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb260-565"><a href="#cb260-565" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">11</span>) <span class="sc">+</span></span>
<span id="cb260-566"><a href="#cb260-566" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb260-567"><a href="#cb260-567" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background  =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#0a0a0f"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb260-568"><a href="#cb260-568" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#12121a"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb260-569"><a href="#cb260-569" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#2a2a3a"</span>),</span>
<span id="cb260-570"><a href="#cb260-570" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb260-571"><a href="#cb260-571" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title       =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#ffffff"</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb260-572"><a href="#cb260-572" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text        =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>),</span>
<span id="cb260-573"><a href="#cb260-573" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title       =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>)</span>
<span id="cb260-574"><a href="#cb260-574" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb260-575"><a href="#cb260-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-576"><a href="#cb260-576" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> amount_log)) <span class="sc">+</span></span>
<span id="cb260-577"><a href="#cb260-577" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">"#00d4ff"</span>, <span class="at">color =</span> <span class="cn">NA</span>, <span class="at">bins =</span> <span class="dv">60</span>, <span class="at">alpha =</span> <span class="fl">0.85</span>) <span class="sc">+</span></span>
<span id="cb260-578"><a href="#cb260-578" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Log-Transformed Amount"</span>, <span class="at">x =</span> <span class="st">"Log(Amount + 1)"</span>, <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb260-579"><a href="#cb260-579" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">11</span>) <span class="sc">+</span></span>
<span id="cb260-580"><a href="#cb260-580" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb260-581"><a href="#cb260-581" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background  =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#0a0a0f"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb260-582"><a href="#cb260-582" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#12121a"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb260-583"><a href="#cb260-583" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#2a2a3a"</span>),</span>
<span id="cb260-584"><a href="#cb260-584" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb260-585"><a href="#cb260-585" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title       =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#ffffff"</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb260-586"><a href="#cb260-586" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text        =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>),</span>
<span id="cb260-587"><a href="#cb260-587" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title       =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>)</span>
<span id="cb260-588"><a href="#cb260-588" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb260-589"><a href="#cb260-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-590"><a href="#cb260-590" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Display side by side ---</span></span>
<span id="cb260-591"><a href="#cb260-591" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb260-592"><a href="#cb260-592" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span></span>
<span id="cb260-593"><a href="#cb260-593" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb260-594"><a href="#cb260-594" aria-hidden="true" tabindex="-1"></a>    <span class="at">title   =</span> <span class="st">"Figure : Amount Distribution: Original vs Log-Transformed"</span>,</span>
<span id="cb260-595"><a href="#cb260-595" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Log transformation compresses the right skew for modelling use"</span>,</span>
<span id="cb260-596"><a href="#cb260-596" aria-hidden="true" tabindex="-1"></a>    <span class="at">theme   =</span> <span class="fu">theme</span>(</span>
<span id="cb260-597"><a href="#cb260-597" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#0a0a0f"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb260-598"><a href="#cb260-598" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title      =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#ffffff"</span>, </span>
<span id="cb260-599"><a href="#cb260-599" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb260-600"><a href="#cb260-600" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.subtitle   =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>, <span class="at">size =</span> <span class="dv">10</span>)</span>
<span id="cb260-601"><a href="#cb260-601" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb260-602"><a href="#cb260-602" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb260-603"><a href="#cb260-603" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb260-604"><a href="#cb260-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-605"><a href="#cb260-605" aria-hidden="true" tabindex="-1"></a><span class="fu">### Interpretation</span></span>
<span id="cb260-606"><a href="#cb260-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-607"><a href="#cb260-607" aria-hidden="true" tabindex="-1"></a>The IQR analysis calculates a lower bound of **-\$1,137.30** and an upper bound of **\$2,655.82** for the <span class="in">`amount`</span> variable.</span>
<span id="cb260-608"><a href="#cb260-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-609"><a href="#cb260-609" aria-hidden="true" tabindex="-1"></a>The negative lower bound is mathematically produced by the IQR formula but is practically meaningless in this context, a transaction amount cannot be negative. This tells us that the data is heavily right-skewed, causing the IQR formula to push the lower boundary into impossible territory. Unsurprisingly, zero outliers were detected below the lower bound.</span>
<span id="cb260-610"><a href="#cb260-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-611"><a href="#cb260-611" aria-hidden="true" tabindex="-1"></a>All 2,320 outliers fall **above** the upper bound of \$2,655.82. These are high-value transactions where customers spent between \$2,655.82 and \$3,000.00 in a single purchase. In the context of an electronics retailer, this is entirely plausible. A customer purchasing a premium laptop, large-screen television, or multiple devices in one transaction could easily reach this spending level.</span>
<span id="cb260-612"><a href="#cb260-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-613"><a href="#cb260-613" aria-hidden="true" tabindex="-1"></a>The original distribution histogram confirms the right skew clearly, the majority of transactions cluster at lower amounts, with a long tail stretching toward \$3,000.</span>
<span id="cb260-614"><a href="#cb260-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-615"><a href="#cb260-615" aria-hidden="true" tabindex="-1"></a>The log-transformed distribution, however, does not produce the smooth bell curve typically expected. Instead it reveals a **multimodal pattern**, multiple peaks across the distribution, suggesting that customer spending may naturally cluster around distinct price points. This is actually a meaningful business insight in itself: Blackwell's customers do not spend randomly across a continuous range, but appear to gravitate toward particular spending brackets, possibly corresponding to different product categories such as accessories, mid-range electronics, and premium devices.</span>
<span id="cb260-616"><a href="#cb260-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-617"><a href="#cb260-617" aria-hidden="true" tabindex="-1"></a>While the log transformation reduces the right skew, the multimodal nature of the data means it will not perfectly satisfy the normality assumptions of some statistical models. This will be kept in mind during the modelling phase.</span>
<span id="cb260-618"><a href="#cb260-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-619"><a href="#cb260-619" aria-hidden="true" tabindex="-1"></a>All **79,979 records are retained**. The dataset is now fully preprocessed and ready for exploratory data analysis.</span>
<span id="cb260-620"><a href="#cb260-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-621"><a href="#cb260-621" aria-hidden="true" tabindex="-1"></a><span class="fu">## Preprocessing Summary</span></span>
<span id="cb260-622"><a href="#cb260-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-623"><a href="#cb260-623" aria-hidden="true" tabindex="-1"></a>This section summarises every step taken during the preprocessing phase. A clean, documented audit trail of data preparation decisions is a hallmark of professional analytical work. It ensures transparency, reproducibility, and gives any reader full confidence in the integrity of the dataset before conclusions are drawn.</span>
<span id="cb260-624"><a href="#cb260-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-627"><a href="#cb260-627" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb260-628"><a href="#cb260-628" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: preprocessing-summary</span></span>
<span id="cb260-629"><a href="#cb260-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-630"><a href="#cb260-630" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Build the preprocessing audit table ---</span></span>
<span id="cb260-631"><a href="#cb260-631" aria-hidden="true" tabindex="-1"></a>preprocessing_log <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb260-632"><a href="#cb260-632" aria-hidden="true" tabindex="-1"></a>  <span class="at">Step =</span> <span class="fu">c</span>(</span>
<span id="cb260-633"><a href="#cb260-633" aria-hidden="true" tabindex="-1"></a>    <span class="st">"1. Data Inspection"</span>,</span>
<span id="cb260-634"><a href="#cb260-634" aria-hidden="true" tabindex="-1"></a>    <span class="st">"2. Missing Values"</span>,</span>
<span id="cb260-635"><a href="#cb260-635" aria-hidden="true" tabindex="-1"></a>    <span class="st">"3. Duplicate Records"</span>,</span>
<span id="cb260-636"><a href="#cb260-636" aria-hidden="true" tabindex="-1"></a>    <span class="st">"4. Data Types Validation"</span>,</span>
<span id="cb260-637"><a href="#cb260-637" aria-hidden="true" tabindex="-1"></a>    <span class="st">"5. Outlier Detection"</span>,</span>
<span id="cb260-638"><a href="#cb260-638" aria-hidden="true" tabindex="-1"></a>    <span class="st">"6. Outlier Treatment"</span></span>
<span id="cb260-639"><a href="#cb260-639" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb260-640"><a href="#cb260-640" aria-hidden="true" tabindex="-1"></a>  <span class="at">Finding =</span> <span class="fu">c</span>(</span>
<span id="cb260-641"><a href="#cb260-641" aria-hidden="true" tabindex="-1"></a>    <span class="st">"80,000 rows, 5 columns. All variables present and accounted for."</span>,</span>
<span id="cb260-642"><a href="#cb260-642" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Zero missing values detected across all 5 columns."</span>,</span>
<span id="cb260-643"><a href="#cb260-643" aria-hidden="true" tabindex="-1"></a>    <span class="st">"21 exact duplicate rows identified."</span>,</span>
<span id="cb260-644"><a href="#cb260-644" aria-hidden="true" tabindex="-1"></a>    <span class="st">"All variables correctly typed; channel &amp; region as factors, age, items &amp; amount as numeric."</span>,</span>
<span id="cb260-645"><a href="#cb260-645" aria-hidden="true" tabindex="-1"></a>    <span class="st">"2,320 outliers detected in amount (2.9%). Zero outliers in age and items."</span>,</span>
<span id="cb260-646"><a href="#cb260-646" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Outliers retained — consistent with electronics retail context. Log transformation applied to amount."</span></span>
<span id="cb260-647"><a href="#cb260-647" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb260-648"><a href="#cb260-648" aria-hidden="true" tabindex="-1"></a>  <span class="at">Action_Taken =</span> <span class="fu">c</span>(</span>
<span id="cb260-649"><a href="#cb260-649" aria-hidden="true" tabindex="-1"></a>    <span class="st">"No action required."</span>,</span>
<span id="cb260-650"><a href="#cb260-650" aria-hidden="true" tabindex="-1"></a>    <span class="st">"No action required."</span>,</span>
<span id="cb260-651"><a href="#cb260-651" aria-hidden="true" tabindex="-1"></a>    <span class="st">"21 duplicate rows removed. Dataset reduced to 79,979 records."</span>,</span>
<span id="cb260-652"><a href="#cb260-652" aria-hidden="true" tabindex="-1"></a>    <span class="st">"No action required."</span>,</span>
<span id="cb260-653"><a href="#cb260-653" aria-hidden="true" tabindex="-1"></a>    <span class="st">"No action required. Outliers confirmed as genuine high-value transactions."</span>,</span>
<span id="cb260-654"><a href="#cb260-654" aria-hidden="true" tabindex="-1"></a>    <span class="st">"amount_log column added. All 79,979 records retained."</span></span>
<span id="cb260-655"><a href="#cb260-655" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb260-656"><a href="#cb260-656" aria-hidden="true" tabindex="-1"></a>  <span class="at">Status =</span> <span class="fu">c</span>(</span>
<span id="cb260-657"><a href="#cb260-657" aria-hidden="true" tabindex="-1"></a>    <span class="st">"✔ Complete"</span>,</span>
<span id="cb260-658"><a href="#cb260-658" aria-hidden="true" tabindex="-1"></a>    <span class="st">"✔ Complete"</span>,</span>
<span id="cb260-659"><a href="#cb260-659" aria-hidden="true" tabindex="-1"></a>    <span class="st">"✔ Complete"</span>,</span>
<span id="cb260-660"><a href="#cb260-660" aria-hidden="true" tabindex="-1"></a>    <span class="st">"✔ Complete"</span>,</span>
<span id="cb260-661"><a href="#cb260-661" aria-hidden="true" tabindex="-1"></a>    <span class="st">"✔ Complete"</span>,</span>
<span id="cb260-662"><a href="#cb260-662" aria-hidden="true" tabindex="-1"></a>    <span class="st">"✔ Complete"</span></span>
<span id="cb260-663"><a href="#cb260-663" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb260-664"><a href="#cb260-664" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb260-665"><a href="#cb260-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-666"><a href="#cb260-666" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Display as styled table ---</span></span>
<span id="cb260-667"><a href="#cb260-667" aria-hidden="true" tabindex="-1"></a>preprocessing_log <span class="sc">%&gt;%</span></span>
<span id="cb260-668"><a href="#cb260-668" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(</span>
<span id="cb260-669"><a href="#cb260-669" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Step"</span>, <span class="st">"Finding"</span>, <span class="st">"Action Taken"</span>, <span class="st">"Status"</span>),</span>
<span id="cb260-670"><a href="#cb260-670" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption   =</span> <span class="st">"Table: Data Preprocessing Audit Log"</span></span>
<span id="cb260-671"><a href="#cb260-671" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb260-672"><a href="#cb260-672" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb260-673"><a href="#cb260-673" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"#00d4ff"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb260-674"><a href="#cb260-674" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">4</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"#00d4ff"</span>)</span>
<span id="cb260-675"><a href="#cb260-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-676"><a href="#cb260-676" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb260-677"><a href="#cb260-677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-678"><a href="#cb260-678" aria-hidden="true" tabindex="-1"></a><span class="fu">## Clean Dataset, Ready for Analysis</span></span>
<span id="cb260-679"><a href="#cb260-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-680"><a href="#cb260-680" aria-hidden="true" tabindex="-1"></a>The preprocessing phase is now complete. The following summarises the final state of the dataset entering the analysis phase:</span>
<span id="cb260-681"><a href="#cb260-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-682"><a href="#cb260-682" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Attribute       <span class="pp">|</span> Detail                   <span class="pp">|</span></span>
<span id="cb260-683"><a href="#cb260-683" aria-hidden="true" tabindex="-1"></a><span class="pp">|-----------------|--------------------------|</span></span>
<span id="cb260-684"><a href="#cb260-684" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Total Records   <span class="pp">|</span> 79,979 transactions      <span class="pp">|</span></span>
<span id="cb260-685"><a href="#cb260-685" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Total Variables <span class="pp">|</span> 6 (including amount_log) <span class="pp">|</span></span>
<span id="cb260-686"><a href="#cb260-686" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Missing Values  <span class="pp">|</span> None                     <span class="pp">|</span></span>
<span id="cb260-687"><a href="#cb260-687" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Duplicates      <span class="pp">|</span> Removed (21 rows)        <span class="pp">|</span></span>
<span id="cb260-688"><a href="#cb260-688" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Outliers        <span class="pp">|</span> Retained &amp; documented    <span class="pp">|</span></span>
<span id="cb260-689"><a href="#cb260-689" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Data Types      <span class="pp">|</span> All correctly assigned   <span class="pp">|</span></span>
<span id="cb260-690"><a href="#cb260-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-691"><a href="#cb260-691" aria-hidden="true" tabindex="-1"></a>The dataset is clean, validated, and fully documented. We now proceed to **Exploratory Data Analysis**, where we begin to answer the business questions posed by Danielle Sherman and Martin Goodrich.</span>
<span id="cb260-692"><a href="#cb260-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-693"><a href="#cb260-693" aria-hidden="true" tabindex="-1"></a><span class="fu"># Exploratory Data Analysis</span></span>
<span id="cb260-694"><a href="#cb260-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-695"><a href="#cb260-695" aria-hidden="true" tabindex="-1"></a>With a clean, validated dataset in hand, this analysis now turns to Exploratory Data Analysis (EDA), the process of visually and statistically examining the data to uncover patterns, relationships, and insights that directly address the business questions posed by Danielle Sherman and Martin Goodrich.</span>
<span id="cb260-696"><a href="#cb260-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-697"><a href="#cb260-697" aria-hidden="true" tabindex="-1"></a>EDA is not simply about producing charts. It is about telling a story with data, understanding who Blackwell's customers are, how they behave, and what factors drive their purchasing decisions. Every visualisation in this section is intentional and directly linked to a specific business question from the brief.</span>
<span id="cb260-698"><a href="#cb260-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-699"><a href="#cb260-699" aria-hidden="true" tabindex="-1"></a>This EDA is structured around five key themes:</span>
<span id="cb260-700"><a href="#cb260-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-701"><a href="#cb260-701" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Regional Spending Patterns**: Which regions spend the most and least per transaction? This directly addresses Danielle's first question about whether geography influences spending behaviour.</span>
<span id="cb260-702"><a href="#cb260-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-703"><a href="#cb260-703" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Items vs Amount**: Is there a relationship between the number of items purchased and the amount spent? A pattern here could inform decisions around bundling, promotions, and upselling.</span>
<span id="cb260-704"><a href="#cb260-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-705"><a href="#cb260-705" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>**Customer Age &amp; Spending**: How does customer age relate to transaction amount? This directly investigates Martin Goodrich's hypothesis that older customers spend more on electronics than younger customers.</span>
<span id="cb260-706"><a href="#cb260-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-707"><a href="#cb260-707" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>**Purchase Channel Analysis**: How do online and in-store customers differ in age and spending behaviour? This addresses Martin's second hypothesis that in-store customers tend to be older than online customers, a claim with significant implications for website design and digital marketing strategy.</span>
<span id="cb260-708"><a href="#cb260-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-709"><a href="#cb260-709" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>**Age Differences Across Regions**: Are there meaningful differences in the age profile of customers across the four regions? This addresses Danielle's question about whether region can be predicted from demographic data, and lays the foundation for the predictive modelling section that follows.</span>
<span id="cb260-710"><a href="#cb260-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-711"><a href="#cb260-711" aria-hidden="true" tabindex="-1"></a>Together, these five analyses form a comprehensive picture of Blackwell's customer base, one that will directly inform the marketing, website, and business strategy decisions under consideration by the leadership team.</span>
<span id="cb260-712"><a href="#cb260-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-713"><a href="#cb260-713" aria-hidden="true" tabindex="-1"></a><span class="fu">## Regional Spending Patterns</span></span>
<span id="cb260-714"><a href="#cb260-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-715"><a href="#cb260-715" aria-hidden="true" tabindex="-1"></a>The first business question posed by Danielle is whether customers in different regions spend different amounts per transaction, and which regions spend the most and least. Understanding regional spending is critical for directing marketing budgets. It makes little sense to invest equally across all regions if some consistently generate higher transaction values than others.</span>
<span id="cb260-716"><a href="#cb260-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-717"><a href="#cb260-717" aria-hidden="true" tabindex="-1"></a>Regional spending is examined here using three complementary views: a summary statistics table, a bar chart of mean spending by region, and a boxplot showing the full distribution of spending per region.</span>
<span id="cb260-718"><a href="#cb260-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-721"><a href="#cb260-721" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb260-722"><a href="#cb260-722" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: regional-spending</span></span>
<span id="cb260-723"><a href="#cb260-723" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb260-724"><a href="#cb260-724" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb260-725"><a href="#cb260-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-726"><a href="#cb260-726" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Summary statistics by region ---</span></span>
<span id="cb260-727"><a href="#cb260-727" aria-hidden="true" tabindex="-1"></a>regional_summary <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb260-728"><a href="#cb260-728" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(region) <span class="sc">%&gt;%</span></span>
<span id="cb260-729"><a href="#cb260-729" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb260-730"><a href="#cb260-730" aria-hidden="true" tabindex="-1"></a>    <span class="at">Transactions =</span> <span class="fu">n</span>(),</span>
<span id="cb260-731"><a href="#cb260-731" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mean_Amount  =</span> <span class="fu">round</span>(<span class="fu">mean</span>(amount), <span class="dv">2</span>),</span>
<span id="cb260-732"><a href="#cb260-732" aria-hidden="true" tabindex="-1"></a>    <span class="at">Median_Amount =</span> <span class="fu">round</span>(<span class="fu">median</span>(amount), <span class="dv">2</span>),</span>
<span id="cb260-733"><a href="#cb260-733" aria-hidden="true" tabindex="-1"></a>    <span class="at">SD_Amount    =</span> <span class="fu">round</span>(<span class="fu">sd</span>(amount), <span class="dv">2</span>),</span>
<span id="cb260-734"><a href="#cb260-734" aria-hidden="true" tabindex="-1"></a>    <span class="at">Min_Amount   =</span> <span class="fu">round</span>(<span class="fu">min</span>(amount), <span class="dv">2</span>),</span>
<span id="cb260-735"><a href="#cb260-735" aria-hidden="true" tabindex="-1"></a>    <span class="at">Max_Amount   =</span> <span class="fu">round</span>(<span class="fu">max</span>(amount), <span class="dv">2</span>)</span>
<span id="cb260-736"><a href="#cb260-736" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb260-737"><a href="#cb260-737" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Mean_Amount))</span>
<span id="cb260-738"><a href="#cb260-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-739"><a href="#cb260-739" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Display summary table ---</span></span>
<span id="cb260-740"><a href="#cb260-740" aria-hidden="true" tabindex="-1"></a>regional_summary <span class="sc">%&gt;%</span></span>
<span id="cb260-741"><a href="#cb260-741" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(</span>
<span id="cb260-742"><a href="#cb260-742" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Region"</span>, <span class="st">"Transactions"</span>, <span class="st">"Mean ($)"</span>, </span>
<span id="cb260-743"><a href="#cb260-743" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Median ($)"</span>, <span class="st">"Std Dev ($)"</span>, </span>
<span id="cb260-744"><a href="#cb260-744" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Min ($)"</span>, <span class="st">"Max ($)"</span>),</span>
<span id="cb260-745"><a href="#cb260-745" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption   =</span> <span class="st">"Table: Regional Spending Summary Statistics"</span></span>
<span id="cb260-746"><a href="#cb260-746" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb260-747"><a href="#cb260-747" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb260-748"><a href="#cb260-748" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"#00d4ff"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb260-749"><a href="#cb260-749" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="dv">1</span>, <span class="at">background =</span> <span class="st">"rgba(0, 212, 255, 0.08)"</span>)</span>
<span id="cb260-750"><a href="#cb260-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-751"><a href="#cb260-751" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Region colour palette ---</span></span>
<span id="cb260-752"><a href="#cb260-752" aria-hidden="true" tabindex="-1"></a>region_palette <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb260-753"><a href="#cb260-753" aria-hidden="true" tabindex="-1"></a>  <span class="st">"North"</span> <span class="ot">=</span> <span class="st">"#00d4ff"</span>,</span>
<span id="cb260-754"><a href="#cb260-754" aria-hidden="true" tabindex="-1"></a>  <span class="st">"South"</span> <span class="ot">=</span> <span class="st">"#7b61ff"</span>,</span>
<span id="cb260-755"><a href="#cb260-755" aria-hidden="true" tabindex="-1"></a>  <span class="st">"East"</span>  <span class="ot">=</span> <span class="st">"#f0c040"</span>,</span>
<span id="cb260-756"><a href="#cb260-756" aria-hidden="true" tabindex="-1"></a>  <span class="st">"West"</span>  <span class="ot">=</span> <span class="st">"#ff6b6b"</span></span>
<span id="cb260-757"><a href="#cb260-757" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb260-758"><a href="#cb260-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-759"><a href="#cb260-759" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Bar chart: Mean spending by region ---</span></span>
<span id="cb260-760"><a href="#cb260-760" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> regional_summary <span class="sc">%&gt;%</span></span>
<span id="cb260-761"><a href="#cb260-761" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(region, Mean_Amount), </span>
<span id="cb260-762"><a href="#cb260-762" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> Mean_Amount, </span>
<span id="cb260-763"><a href="#cb260-763" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> region)) <span class="sc">+</span></span>
<span id="cb260-764"><a href="#cb260-764" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">width =</span> <span class="fl">0.6</span>, <span class="at">alpha =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb260-765"><a href="#cb260-765" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">format</span>(Mean_Amount, <span class="at">big.mark =</span> <span class="st">","</span>))),</span>
<span id="cb260-766"><a href="#cb260-766" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust   =</span> <span class="sc">-</span><span class="fl">0.1</span>,</span>
<span id="cb260-767"><a href="#cb260-767" aria-hidden="true" tabindex="-1"></a>            <span class="at">color   =</span> <span class="st">"#e8e8e8"</span>,</span>
<span id="cb260-768"><a href="#cb260-768" aria-hidden="true" tabindex="-1"></a>            <span class="at">size    =</span> <span class="fl">3.8</span>,</span>
<span id="cb260-769"><a href="#cb260-769" aria-hidden="true" tabindex="-1"></a>            <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb260-770"><a href="#cb260-770" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> region_palette) <span class="sc">+</span></span>
<span id="cb260-771"><a href="#cb260-771" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb260-772"><a href="#cb260-772" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">dollar_format</span>(),</span>
<span id="cb260-773"><a href="#cb260-773" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>))</span>
<span id="cb260-774"><a href="#cb260-774" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb260-775"><a href="#cb260-775" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb260-776"><a href="#cb260-776" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb260-777"><a href="#cb260-777" aria-hidden="true" tabindex="-1"></a>    <span class="at">title    =</span> <span class="st">"Mean Transaction Amount by Region"</span>,</span>
<span id="cb260-778"><a href="#cb260-778" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"West region leads in average spend per transaction"</span>,</span>
<span id="cb260-779"><a href="#cb260-779" aria-hidden="true" tabindex="-1"></a>    <span class="at">x        =</span> <span class="cn">NULL</span>,</span>
<span id="cb260-780"><a href="#cb260-780" aria-hidden="true" tabindex="-1"></a>    <span class="at">y        =</span> <span class="st">"Mean Amount ($)"</span></span>
<span id="cb260-781"><a href="#cb260-781" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb260-782"><a href="#cb260-782" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb260-783"><a href="#cb260-783" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb260-784"><a href="#cb260-784" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background  =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#0a0a0f"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb260-785"><a href="#cb260-785" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#12121a"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb260-786"><a href="#cb260-786" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb260-787"><a href="#cb260-787" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#2a2a3a"</span>),</span>
<span id="cb260-788"><a href="#cb260-788" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb260-789"><a href="#cb260-789" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title       =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#ffffff"</span>, </span>
<span id="cb260-790"><a href="#cb260-790" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">face  =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb260-791"><a href="#cb260-791" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle    =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb260-792"><a href="#cb260-792" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text        =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>),</span>
<span id="cb260-793"><a href="#cb260-793" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title       =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>),</span>
<span id="cb260-794"><a href="#cb260-794" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position  =</span> <span class="st">"none"</span></span>
<span id="cb260-795"><a href="#cb260-795" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb260-796"><a href="#cb260-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-797"><a href="#cb260-797" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Boxplot: Full distribution by region ---</span></span>
<span id="cb260-798"><a href="#cb260-798" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb260-799"><a href="#cb260-799" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(region, amount, <span class="at">FUN =</span> mean),</span>
<span id="cb260-800"><a href="#cb260-800" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> amount,</span>
<span id="cb260-801"><a href="#cb260-801" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> region)) <span class="sc">+</span></span>
<span id="cb260-802"><a href="#cb260-802" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.colour =</span> <span class="st">"#ff4d4d"</span>,</span>
<span id="cb260-803"><a href="#cb260-803" aria-hidden="true" tabindex="-1"></a>               <span class="at">outlier.alpha  =</span> <span class="fl">0.2</span>,</span>
<span id="cb260-804"><a href="#cb260-804" aria-hidden="true" tabindex="-1"></a>               <span class="at">outlier.size   =</span> <span class="fl">0.6</span>,</span>
<span id="cb260-805"><a href="#cb260-805" aria-hidden="true" tabindex="-1"></a>               <span class="at">width          =</span> <span class="fl">0.5</span>,</span>
<span id="cb260-806"><a href="#cb260-806" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha          =</span> <span class="fl">0.85</span>) <span class="sc">+</span></span>
<span id="cb260-807"><a href="#cb260-807" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> region_palette) <span class="sc">+</span></span>
<span id="cb260-808"><a href="#cb260-808" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">dollar_format</span>()) <span class="sc">+</span></span>
<span id="cb260-809"><a href="#cb260-809" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb260-810"><a href="#cb260-810" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb260-811"><a href="#cb260-811" aria-hidden="true" tabindex="-1"></a>    <span class="at">title    =</span> <span class="st">"Spending Distribution by Region"</span>,</span>
<span id="cb260-812"><a href="#cb260-812" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Red dots indicate high-value transactions"</span>,</span>
<span id="cb260-813"><a href="#cb260-813" aria-hidden="true" tabindex="-1"></a>    <span class="at">x        =</span> <span class="cn">NULL</span>,</span>
<span id="cb260-814"><a href="#cb260-814" aria-hidden="true" tabindex="-1"></a>    <span class="at">y        =</span> <span class="st">"Transaction Amount ($)"</span></span>
<span id="cb260-815"><a href="#cb260-815" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb260-816"><a href="#cb260-816" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb260-817"><a href="#cb260-817" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb260-818"><a href="#cb260-818" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background  =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#0a0a0f"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb260-819"><a href="#cb260-819" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#12121a"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb260-820"><a href="#cb260-820" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb260-821"><a href="#cb260-821" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#2a2a3a"</span>),</span>
<span id="cb260-822"><a href="#cb260-822" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb260-823"><a href="#cb260-823" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title       =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#ffffff"</span>, </span>
<span id="cb260-824"><a href="#cb260-824" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">face  =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb260-825"><a href="#cb260-825" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle    =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb260-826"><a href="#cb260-826" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text        =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>),</span>
<span id="cb260-827"><a href="#cb260-827" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title       =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>),</span>
<span id="cb260-828"><a href="#cb260-828" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position  =</span> <span class="st">"none"</span></span>
<span id="cb260-829"><a href="#cb260-829" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb260-830"><a href="#cb260-830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-831"><a href="#cb260-831" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Display side by side ---</span></span>
<span id="cb260-832"><a href="#cb260-832" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span></span>
<span id="cb260-833"><a href="#cb260-833" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb260-834"><a href="#cb260-834" aria-hidden="true" tabindex="-1"></a>    <span class="at">title   =</span> <span class="st">"Figure : Regional Spending Analysis"</span>,</span>
<span id="cb260-835"><a href="#cb260-835" aria-hidden="true" tabindex="-1"></a>    <span class="at">theme   =</span> <span class="fu">theme</span>(</span>
<span id="cb260-836"><a href="#cb260-836" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#0a0a0f"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb260-837"><a href="#cb260-837" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title      =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#ffffff"</span>, </span>
<span id="cb260-838"><a href="#cb260-838" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">face  =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">13</span>)</span>
<span id="cb260-839"><a href="#cb260-839" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb260-840"><a href="#cb260-840" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb260-841"><a href="#cb260-841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-842"><a href="#cb260-842" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb260-843"><a href="#cb260-843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-844"><a href="#cb260-844" aria-hidden="true" tabindex="-1"></a><span class="fu">### Interpretation</span></span>
<span id="cb260-845"><a href="#cb260-845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-846"><a href="#cb260-846" aria-hidden="true" tabindex="-1"></a>Regional spending varies considerably across Blackwell's customer base. The West leads with a mean transaction value of **\$1,283.94**, followed by East (\$917.97), North (\$744.99), and South (\$252.10).</span>
<span id="cb260-847"><a href="#cb260-847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-848"><a href="#cb260-848" aria-hidden="true" tabindex="-1"></a>Most notably, the South region's maximum transaction value is just **\$499.94**, a ceiling no other region comes close to, suggesting Southern customers are exclusively purchasing lower-range products with no high-value purchasing behaviour present at all.</span>
<span id="cb260-849"><a href="#cb260-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-850"><a href="#cb260-850" aria-hidden="true" tabindex="-1"></a>**Recommendation:** Premium campaigns should target the West and East. The South requires a value-oriented strategy, and further investigation into why high-value purchases are entirely absent from this region.</span>
<span id="cb260-851"><a href="#cb260-851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-852"><a href="#cb260-852" aria-hidden="true" tabindex="-1"></a><span class="fu">## Items vs Amount Relationship</span></span>
<span id="cb260-853"><a href="#cb260-853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-854"><a href="#cb260-854" aria-hidden="true" tabindex="-1"></a>A key question for Blackwell's sales strategy is whether customers who purchase more items in a single transaction also spend more money. If a strong positive relationship exists, it would support strategies such as bundling, cross-selling, and volume discounts to drive revenue. The relationship between items purchased and transaction amount is examined here using a scatter plot and a correlation analysis.</span>
<span id="cb260-855"><a href="#cb260-855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-858"><a href="#cb260-858" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb260-859"><a href="#cb260-859" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: items-vs-amount</span></span>
<span id="cb260-860"><a href="#cb260-860" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb260-861"><a href="#cb260-861" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb260-862"><a href="#cb260-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-863"><a href="#cb260-863" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Pearson Correlation ---</span></span>
<span id="cb260-864"><a href="#cb260-864" aria-hidden="true" tabindex="-1"></a>correlation <span class="ot">&lt;-</span> <span class="fu">cor</span>(df<span class="sc">$</span>items, df<span class="sc">$</span>amount, <span class="at">method =</span> <span class="st">"pearson"</span>)</span>
<span id="cb260-865"><a href="#cb260-865" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Pearson Correlation (items vs amount):"</span>, <span class="fu">round</span>(correlation, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-866"><a href="#cb260-866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-867"><a href="#cb260-867" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Scatter plot with trend line ---</span></span>
<span id="cb260-868"><a href="#cb260-868" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb260-869"><a href="#cb260-869" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> items, <span class="at">y =</span> amount)) <span class="sc">+</span></span>
<span id="cb260-870"><a href="#cb260-870" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">alpha =</span> <span class="fl">0.08</span>, <span class="at">color =</span> <span class="st">"#00d4ff"</span>, <span class="at">size =</span> <span class="fl">0.6</span>, <span class="at">width =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb260-871"><a href="#cb260-871" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">color =</span> <span class="st">"#f0c040"</span>, </span>
<span id="cb260-872"><a href="#cb260-872" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb260-873"><a href="#cb260-873" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">dollar_format</span>()) <span class="sc">+</span></span>
<span id="cb260-874"><a href="#cb260-874" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb260-875"><a href="#cb260-875" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb260-876"><a href="#cb260-876" aria-hidden="true" tabindex="-1"></a>    <span class="at">title    =</span> <span class="st">"Items Purchased vs Transaction Amount"</span>,</span>
<span id="cb260-877"><a href="#cb260-877" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">paste0</span>(<span class="st">"Pearson r = "</span>, <span class="fu">round</span>(correlation, <span class="dv">4</span>),</span>
<span id="cb260-878"><a href="#cb260-878" aria-hidden="true" tabindex="-1"></a>                      <span class="st">" — negligible linear relationship"</span>),</span>
<span id="cb260-879"><a href="#cb260-879" aria-hidden="true" tabindex="-1"></a>    <span class="at">x        =</span> <span class="st">"Number of Items Purchased"</span>,</span>
<span id="cb260-880"><a href="#cb260-880" aria-hidden="true" tabindex="-1"></a>    <span class="at">y        =</span> <span class="st">"Transaction Amount ($)"</span></span>
<span id="cb260-881"><a href="#cb260-881" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb260-882"><a href="#cb260-882" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb260-883"><a href="#cb260-883" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb260-884"><a href="#cb260-884" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background  =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#0a0a0f"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb260-885"><a href="#cb260-885" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#12121a"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb260-886"><a href="#cb260-886" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#2a2a3a"</span>),</span>
<span id="cb260-887"><a href="#cb260-887" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb260-888"><a href="#cb260-888" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title       =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#ffffff"</span>, </span>
<span id="cb260-889"><a href="#cb260-889" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">face  =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb260-890"><a href="#cb260-890" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle    =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb260-891"><a href="#cb260-891" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text        =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>),</span>
<span id="cb260-892"><a href="#cb260-892" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title       =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>)</span>
<span id="cb260-893"><a href="#cb260-893" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb260-894"><a href="#cb260-894" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-895"><a href="#cb260-895" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Boxplot: Amount distribution per item count ---</span></span>
<span id="cb260-896"><a href="#cb260-896" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb260-897"><a href="#cb260-897" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(items), <span class="at">y =</span> amount, <span class="at">fill =</span> <span class="fu">factor</span>(items))) <span class="sc">+</span></span>
<span id="cb260-898"><a href="#cb260-898" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.colour =</span> <span class="st">"#ff4d4d"</span>,</span>
<span id="cb260-899"><a href="#cb260-899" aria-hidden="true" tabindex="-1"></a>               <span class="at">outlier.alpha  =</span> <span class="fl">0.2</span>,</span>
<span id="cb260-900"><a href="#cb260-900" aria-hidden="true" tabindex="-1"></a>               <span class="at">outlier.size   =</span> <span class="fl">0.6</span>,</span>
<span id="cb260-901"><a href="#cb260-901" aria-hidden="true" tabindex="-1"></a>               <span class="at">width          =</span> <span class="fl">0.6</span>,</span>
<span id="cb260-902"><a href="#cb260-902" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha          =</span> <span class="fl">0.85</span>) <span class="sc">+</span></span>
<span id="cb260-903"><a href="#cb260-903" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb260-904"><a href="#cb260-904" aria-hidden="true" tabindex="-1"></a>    <span class="st">"1"</span> <span class="ot">=</span> <span class="st">"#00d4ff"</span>, <span class="st">"2"</span> <span class="ot">=</span> <span class="st">"#7b61ff"</span>, <span class="st">"3"</span> <span class="ot">=</span> <span class="st">"#f0c040"</span>,</span>
<span id="cb260-905"><a href="#cb260-905" aria-hidden="true" tabindex="-1"></a>    <span class="st">"4"</span> <span class="ot">=</span> <span class="st">"#ff6b6b"</span>, <span class="st">"5"</span> <span class="ot">=</span> <span class="st">"#00ff9d"</span>, <span class="st">"6"</span> <span class="ot">=</span> <span class="st">"#ff9d00"</span>,</span>
<span id="cb260-906"><a href="#cb260-906" aria-hidden="true" tabindex="-1"></a>    <span class="st">"7"</span> <span class="ot">=</span> <span class="st">"#ff61d8"</span>, <span class="st">"8"</span> <span class="ot">=</span> <span class="st">"#61ffed"</span></span>
<span id="cb260-907"><a href="#cb260-907" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb260-908"><a href="#cb260-908" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">dollar_format</span>()) <span class="sc">+</span></span>
<span id="cb260-909"><a href="#cb260-909" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb260-910"><a href="#cb260-910" aria-hidden="true" tabindex="-1"></a>    <span class="at">title    =</span> <span class="st">"Amount Distribution by Items Purchased"</span>,</span>
<span id="cb260-911"><a href="#cb260-911" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Spending spread is consistent regardless of item count"</span>,</span>
<span id="cb260-912"><a href="#cb260-912" aria-hidden="true" tabindex="-1"></a>    <span class="at">x        =</span> <span class="st">"Number of Items Purchased"</span>,</span>
<span id="cb260-913"><a href="#cb260-913" aria-hidden="true" tabindex="-1"></a>    <span class="at">y        =</span> <span class="st">"Transaction Amount ($)"</span></span>
<span id="cb260-914"><a href="#cb260-914" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb260-915"><a href="#cb260-915" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb260-916"><a href="#cb260-916" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb260-917"><a href="#cb260-917" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background  =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#0a0a0f"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb260-918"><a href="#cb260-918" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#12121a"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb260-919"><a href="#cb260-919" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#2a2a3a"</span>),</span>
<span id="cb260-920"><a href="#cb260-920" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb260-921"><a href="#cb260-921" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title       =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#ffffff"</span>, </span>
<span id="cb260-922"><a href="#cb260-922" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">face  =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb260-923"><a href="#cb260-923" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle    =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb260-924"><a href="#cb260-924" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text        =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>),</span>
<span id="cb260-925"><a href="#cb260-925" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title       =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>),</span>
<span id="cb260-926"><a href="#cb260-926" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position  =</span> <span class="st">"none"</span></span>
<span id="cb260-927"><a href="#cb260-927" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb260-928"><a href="#cb260-928" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-929"><a href="#cb260-929" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Display side by side ---</span></span>
<span id="cb260-930"><a href="#cb260-930" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span></span>
<span id="cb260-931"><a href="#cb260-931" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb260-932"><a href="#cb260-932" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Figure: Relationship Between Items Purchased &amp; Amount Spent"</span>,</span>
<span id="cb260-933"><a href="#cb260-933" aria-hidden="true" tabindex="-1"></a>    <span class="at">theme =</span> <span class="fu">theme</span>(</span>
<span id="cb260-934"><a href="#cb260-934" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#0a0a0f"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb260-935"><a href="#cb260-935" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title      =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#ffffff"</span>,</span>
<span id="cb260-936"><a href="#cb260-936" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">face  =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">13</span>)</span>
<span id="cb260-937"><a href="#cb260-937" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb260-938"><a href="#cb260-938" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb260-939"><a href="#cb260-939" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb260-940"><a href="#cb260-940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-941"><a href="#cb260-941" aria-hidden="true" tabindex="-1"></a><span class="fu">### Interpretation</span></span>
<span id="cb260-942"><a href="#cb260-942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-943"><a href="#cb260-943" aria-hidden="true" tabindex="-1"></a>The Pearson correlation between items purchased and amount spent is virtually zero (r = 0.0004), confirming that **no meaningful linear relationship exists** between the two variables. The scatter plot and boxplots reinforce this: spending is widely and randomly distributed regardless of how many items a customer buys.</span>
<span id="cb260-944"><a href="#cb260-944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-945"><a href="#cb260-945" aria-hidden="true" tabindex="-1"></a>**Recommendation:** Bundling and volume-based pricing strategies are unlikely to drive higher revenue. Spending appears to be driven by product type and price point rather than quantity purchased.</span>
<span id="cb260-946"><a href="#cb260-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-947"><a href="#cb260-947" aria-hidden="true" tabindex="-1"></a><span class="fu">## Customer Age &amp; Spending</span></span>
<span id="cb260-948"><a href="#cb260-948" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-949"><a href="#cb260-949" aria-hidden="true" tabindex="-1"></a>Martin Goodrich hypothesises that older customers spend more on electronics than younger customers. This is a critical claim. If true, it would justify design changes to the website and targeted marketing campaigns aimed at older demographics. If false, such investments could be misdirected and costly.</span>
<span id="cb260-950"><a href="#cb260-950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-951"><a href="#cb260-951" aria-hidden="true" tabindex="-1"></a>This hypothesis is tested directly using a scatter plot of age against transaction amount, supported by a correlation analysis and a mean spending summary across age groups.</span>
<span id="cb260-952"><a href="#cb260-952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-955"><a href="#cb260-955" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb260-956"><a href="#cb260-956" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: age-vs-spending</span></span>
<span id="cb260-957"><a href="#cb260-957" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb260-958"><a href="#cb260-958" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb260-959"><a href="#cb260-959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-960"><a href="#cb260-960" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Pearson Correlation: Age vs Amount ---</span></span>
<span id="cb260-961"><a href="#cb260-961" aria-hidden="true" tabindex="-1"></a>age_corr <span class="ot">&lt;-</span> <span class="fu">cor</span>(df<span class="sc">$</span>age, df<span class="sc">$</span>amount, <span class="at">method =</span> <span class="st">"pearson"</span>)</span>
<span id="cb260-962"><a href="#cb260-962" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Pearson Correlation (age vs amount):"</span>, <span class="fu">round</span>(age_corr, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-963"><a href="#cb260-963" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-964"><a href="#cb260-964" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Create three age groups ---</span></span>
<span id="cb260-965"><a href="#cb260-965" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb260-966"><a href="#cb260-966" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age_group =</span> <span class="fu">cut</span>(age,</span>
<span id="cb260-967"><a href="#cb260-967" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">17</span>, <span class="dv">39</span>, <span class="dv">59</span>, <span class="dv">85</span>),</span>
<span id="cb260-968"><a href="#cb260-968" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Young Adults (18-39)"</span>, </span>
<span id="cb260-969"><a href="#cb260-969" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Middle-Aged (40-59)"</span>, </span>
<span id="cb260-970"><a href="#cb260-970" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Senior (60+)"</span>)</span>
<span id="cb260-971"><a href="#cb260-971" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb260-972"><a href="#cb260-972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-973"><a href="#cb260-973" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Mean spending by age group ---</span></span>
<span id="cb260-974"><a href="#cb260-974" aria-hidden="true" tabindex="-1"></a>age_group_summary <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb260-975"><a href="#cb260-975" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(age_group) <span class="sc">%&gt;%</span></span>
<span id="cb260-976"><a href="#cb260-976" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb260-977"><a href="#cb260-977" aria-hidden="true" tabindex="-1"></a>    <span class="at">Transactions  =</span> <span class="fu">n</span>(),</span>
<span id="cb260-978"><a href="#cb260-978" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mean_Amount   =</span> <span class="fu">round</span>(<span class="fu">mean</span>(amount), <span class="dv">2</span>),</span>
<span id="cb260-979"><a href="#cb260-979" aria-hidden="true" tabindex="-1"></a>    <span class="at">Median_Amount =</span> <span class="fu">round</span>(<span class="fu">median</span>(amount), <span class="dv">2</span>)</span>
<span id="cb260-980"><a href="#cb260-980" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb260-981"><a href="#cb260-981" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-982"><a href="#cb260-982" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Display summary table ---</span></span>
<span id="cb260-983"><a href="#cb260-983" aria-hidden="true" tabindex="-1"></a>age_group_summary <span class="sc">%&gt;%</span></span>
<span id="cb260-984"><a href="#cb260-984" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(</span>
<span id="cb260-985"><a href="#cb260-985" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Age Group"</span>, <span class="st">"Transactions"</span>,</span>
<span id="cb260-986"><a href="#cb260-986" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Mean ($)"</span>, <span class="st">"Median ($)"</span>),</span>
<span id="cb260-987"><a href="#cb260-987" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption   =</span> <span class="st">"Table: Mean Spending by Age Group"</span></span>
<span id="cb260-988"><a href="#cb260-988" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb260-989"><a href="#cb260-989" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb260-990"><a href="#cb260-990" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"#00d4ff"</span>)</span>
<span id="cb260-991"><a href="#cb260-991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-992"><a href="#cb260-992" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Scatter plot: Age vs Amount ---</span></span>
<span id="cb260-993"><a href="#cb260-993" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb260-994"><a href="#cb260-994" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> amount, <span class="at">color =</span> age_group)) <span class="sc">+</span></span>
<span id="cb260-995"><a href="#cb260-995" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.06</span>, <span class="at">size =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb260-996"><a href="#cb260-996" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">color =</span> <span class="st">"#f0c040"</span>,</span>
<span id="cb260-997"><a href="#cb260-997" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb260-998"><a href="#cb260-998" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb260-999"><a href="#cb260-999" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Young Adults (18-39)"</span> <span class="ot">=</span> <span class="st">"#00d4ff"</span>,</span>
<span id="cb260-1000"><a href="#cb260-1000" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Middle-Aged (40-59)"</span>  <span class="ot">=</span> <span class="st">"#7b61ff"</span>,</span>
<span id="cb260-1001"><a href="#cb260-1001" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Senior (60+)"</span>         <span class="ot">=</span> <span class="st">"#ff6b6b"</span></span>
<span id="cb260-1002"><a href="#cb260-1002" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb260-1003"><a href="#cb260-1003" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">dollar_format</span>()) <span class="sc">+</span></span>
<span id="cb260-1004"><a href="#cb260-1004" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb260-1005"><a href="#cb260-1005" aria-hidden="true" tabindex="-1"></a>    <span class="at">title    =</span> <span class="st">"Customer Age vs Transaction Amount"</span>,</span>
<span id="cb260-1006"><a href="#cb260-1006" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">paste0</span>(<span class="st">"Pearson r = "</span>, <span class="fu">round</span>(age_corr, <span class="dv">4</span>),</span>
<span id="cb260-1007"><a href="#cb260-1007" aria-hidden="true" tabindex="-1"></a>                      <span class="st">" — negligible relationship"</span>),</span>
<span id="cb260-1008"><a href="#cb260-1008" aria-hidden="true" tabindex="-1"></a>    <span class="at">x        =</span> <span class="st">"Customer Age"</span>,</span>
<span id="cb260-1009"><a href="#cb260-1009" aria-hidden="true" tabindex="-1"></a>    <span class="at">y        =</span> <span class="st">"Transaction Amount ($)"</span>,</span>
<span id="cb260-1010"><a href="#cb260-1010" aria-hidden="true" tabindex="-1"></a>    <span class="at">color    =</span> <span class="st">"Age Group"</span></span>
<span id="cb260-1011"><a href="#cb260-1011" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb260-1012"><a href="#cb260-1012" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb260-1013"><a href="#cb260-1013" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb260-1014"><a href="#cb260-1014" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background  =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#0a0a0f"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb260-1015"><a href="#cb260-1015" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#12121a"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb260-1016"><a href="#cb260-1016" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#2a2a3a"</span>),</span>
<span id="cb260-1017"><a href="#cb260-1017" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb260-1018"><a href="#cb260-1018" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title       =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#ffffff"</span>,</span>
<span id="cb260-1019"><a href="#cb260-1019" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">face  =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb260-1020"><a href="#cb260-1020" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle    =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb260-1021"><a href="#cb260-1021" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text        =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>),</span>
<span id="cb260-1022"><a href="#cb260-1022" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title       =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>),</span>
<span id="cb260-1023"><a href="#cb260-1023" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title     =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>, <span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb260-1024"><a href="#cb260-1024" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text      =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>, <span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb260-1025"><a href="#cb260-1025" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#12121a"</span>, <span class="at">color =</span> <span class="cn">NA</span>)</span>
<span id="cb260-1026"><a href="#cb260-1026" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb260-1027"><a href="#cb260-1027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1028"><a href="#cb260-1028" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Bar chart: Mean spending by age group ---</span></span>
<span id="cb260-1029"><a href="#cb260-1029" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> age_group_summary <span class="sc">%&gt;%</span></span>
<span id="cb260-1030"><a href="#cb260-1030" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age_group, <span class="at">y =</span> Mean_Amount, <span class="at">fill =</span> age_group)) <span class="sc">+</span></span>
<span id="cb260-1031"><a href="#cb260-1031" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">width =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb260-1032"><a href="#cb260-1032" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">format</span>(Mean_Amount, <span class="at">big.mark =</span> <span class="st">","</span>))),</span>
<span id="cb260-1033"><a href="#cb260-1033" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust    =</span> <span class="sc">-</span><span class="fl">0.5</span>,</span>
<span id="cb260-1034"><a href="#cb260-1034" aria-hidden="true" tabindex="-1"></a>            <span class="at">color    =</span> <span class="st">"#e8e8e8"</span>,</span>
<span id="cb260-1035"><a href="#cb260-1035" aria-hidden="true" tabindex="-1"></a>            <span class="at">size     =</span> <span class="fl">3.8</span>,</span>
<span id="cb260-1036"><a href="#cb260-1036" aria-hidden="true" tabindex="-1"></a>            <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb260-1037"><a href="#cb260-1037" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb260-1038"><a href="#cb260-1038" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Young Adults (18-39)"</span> <span class="ot">=</span> <span class="st">"#00d4ff"</span>,</span>
<span id="cb260-1039"><a href="#cb260-1039" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Middle-Aged (40-59)"</span>  <span class="ot">=</span> <span class="st">"#7b61ff"</span>,</span>
<span id="cb260-1040"><a href="#cb260-1040" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Senior (60+)"</span>         <span class="ot">=</span> <span class="st">"#ff6b6b"</span></span>
<span id="cb260-1041"><a href="#cb260-1041" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb260-1042"><a href="#cb260-1042" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb260-1043"><a href="#cb260-1043" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">dollar_format</span>(),</span>
<span id="cb260-1044"><a href="#cb260-1044" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.15</span>))</span>
<span id="cb260-1045"><a href="#cb260-1045" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb260-1046"><a href="#cb260-1046" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb260-1047"><a href="#cb260-1047" aria-hidden="true" tabindex="-1"></a>    <span class="at">title    =</span> <span class="st">"Mean Spending by Age Group"</span>,</span>
<span id="cb260-1048"><a href="#cb260-1048" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"No consistent upward trend with increasing age"</span>,</span>
<span id="cb260-1049"><a href="#cb260-1049" aria-hidden="true" tabindex="-1"></a>    <span class="at">x        =</span> <span class="cn">NULL</span>,</span>
<span id="cb260-1050"><a href="#cb260-1050" aria-hidden="true" tabindex="-1"></a>    <span class="at">y        =</span> <span class="st">"Mean Amount ($)"</span></span>
<span id="cb260-1051"><a href="#cb260-1051" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb260-1052"><a href="#cb260-1052" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb260-1053"><a href="#cb260-1053" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb260-1054"><a href="#cb260-1054" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background  =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#0a0a0f"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb260-1055"><a href="#cb260-1055" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#12121a"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb260-1056"><a href="#cb260-1056" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#2a2a3a"</span>),</span>
<span id="cb260-1057"><a href="#cb260-1057" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb260-1058"><a href="#cb260-1058" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title       =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#ffffff"</span>,</span>
<span id="cb260-1059"><a href="#cb260-1059" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">face  =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb260-1060"><a href="#cb260-1060" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle    =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb260-1061"><a href="#cb260-1061" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text        =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>),</span>
<span id="cb260-1062"><a href="#cb260-1062" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title       =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>),</span>
<span id="cb260-1063"><a href="#cb260-1063" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position  =</span> <span class="st">"none"</span></span>
<span id="cb260-1064"><a href="#cb260-1064" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb260-1065"><a href="#cb260-1065" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1066"><a href="#cb260-1066" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Display side by side ---</span></span>
<span id="cb260-1067"><a href="#cb260-1067" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span></span>
<span id="cb260-1068"><a href="#cb260-1068" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb260-1069"><a href="#cb260-1069" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Figure: Customer Age &amp; Spending Behaviour"</span>,</span>
<span id="cb260-1070"><a href="#cb260-1070" aria-hidden="true" tabindex="-1"></a>    <span class="at">theme =</span> <span class="fu">theme</span>(</span>
<span id="cb260-1071"><a href="#cb260-1071" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#0a0a0f"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb260-1072"><a href="#cb260-1072" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title      =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#ffffff"</span>,</span>
<span id="cb260-1073"><a href="#cb260-1073" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">face  =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">13</span>)</span>
<span id="cb260-1074"><a href="#cb260-1074" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb260-1075"><a href="#cb260-1075" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb260-1076"><a href="#cb260-1076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1077"><a href="#cb260-1077" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb260-1078"><a href="#cb260-1078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1079"><a href="#cb260-1079" aria-hidden="true" tabindex="-1"></a><span class="fu">### Interpretation Martin's Hypothesis #2</span></span>
<span id="cb260-1080"><a href="#cb260-1080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1081"><a href="#cb260-1081" aria-hidden="true" tabindex="-1"></a>The data directly **contradicts** Martin's hypothesis. Rather than older customers spending more, the analysis reveals the opposite; a **negative correlation (r = -0.282)** between age and transaction amount, meaning older customers actually tend to spend **less** than younger customers.</span>
<span id="cb260-1082"><a href="#cb260-1082" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1083"><a href="#cb260-1083" aria-hidden="true" tabindex="-1"></a>The age group summary confirms this clearly:</span>
<span id="cb260-1084"><a href="#cb260-1084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1085"><a href="#cb260-1085" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Age Group            <span class="pp">|</span> Mean Spend <span class="pp">|</span></span>
<span id="cb260-1086"><a href="#cb260-1086" aria-hidden="true" tabindex="-1"></a><span class="pp">|----------------------|------------|</span></span>
<span id="cb260-1087"><a href="#cb260-1087" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Young Adults (18-39) <span class="pp">|</span> \$991.08   <span class="pp">|</span></span>
<span id="cb260-1088"><a href="#cb260-1088" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Middle-Aged (40-59)  <span class="pp">|</span> \$869.77   <span class="pp">|</span></span>
<span id="cb260-1089"><a href="#cb260-1089" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Senior (60+)         <span class="pp">|</span> \$469.83   <span class="pp">|</span></span>
<span id="cb260-1090"><a href="#cb260-1090" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1091"><a href="#cb260-1091" aria-hidden="true" tabindex="-1"></a>Spending declines consistently as age increases — Young Adults spend on average more than **twice as much** as Senior customers (\$991.08 vs \$469.83).</span>
<span id="cb260-1092"><a href="#cb260-1092" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1093"><a href="#cb260-1093" aria-hidden="true" tabindex="-1"></a>**Recommendation:** Martin's proposed website design changes and marketing activities targeting older customers as higher spenders are not supported by the data. If anything, marketing efforts aimed at driving higher transaction values should focus on **younger demographics**, particularly the 18-39 age group, which consistently generates the highest average spend.</span>
<span id="cb260-1094"><a href="#cb260-1094" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1095"><a href="#cb260-1095" aria-hidden="true" tabindex="-1"></a><span class="fu">## Purchase Channel Analysis</span></span>
<span id="cb260-1096"><a href="#cb260-1096" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1097"><a href="#cb260-1097" aria-hidden="true" tabindex="-1"></a>Martin Goodrich's second hypothesis is that customers who shop in-store are older than customers who shop online. This claim has significant implications. If true, it would suggest the website should be redesigned to appeal to younger shoppers, while in-store experiences are tailored to older customers.</span>
<span id="cb260-1098"><a href="#cb260-1098" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1099"><a href="#cb260-1099" aria-hidden="true" tabindex="-1"></a>This hypothesis is tested directly by comparing the age distribution of online and in-store customers, supported by a statistical test to determine whether any observed difference is meaningful or simply due to chance.</span>
<span id="cb260-1100"><a href="#cb260-1100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1103"><a href="#cb260-1103" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb260-1104"><a href="#cb260-1104" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: channel-analysis</span></span>
<span id="cb260-1105"><a href="#cb260-1105" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb260-1106"><a href="#cb260-1106" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb260-1107"><a href="#cb260-1107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1108"><a href="#cb260-1108" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Summary statistics by channel ---</span></span>
<span id="cb260-1109"><a href="#cb260-1109" aria-hidden="true" tabindex="-1"></a>channel_summary <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb260-1110"><a href="#cb260-1110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(channel) <span class="sc">%&gt;%</span></span>
<span id="cb260-1111"><a href="#cb260-1111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb260-1112"><a href="#cb260-1112" aria-hidden="true" tabindex="-1"></a>    <span class="at">Transactions  =</span> <span class="fu">n</span>(),</span>
<span id="cb260-1113"><a href="#cb260-1113" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mean_Age      =</span> <span class="fu">round</span>(<span class="fu">mean</span>(age), <span class="dv">1</span>),</span>
<span id="cb260-1114"><a href="#cb260-1114" aria-hidden="true" tabindex="-1"></a>    <span class="at">Median_Age    =</span> <span class="fu">round</span>(<span class="fu">median</span>(age), <span class="dv">1</span>),</span>
<span id="cb260-1115"><a href="#cb260-1115" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mean_Amount   =</span> <span class="fu">round</span>(<span class="fu">mean</span>(amount), <span class="dv">2</span>),</span>
<span id="cb260-1116"><a href="#cb260-1116" aria-hidden="true" tabindex="-1"></a>    <span class="at">Median_Amount =</span> <span class="fu">round</span>(<span class="fu">median</span>(amount), <span class="dv">2</span>)</span>
<span id="cb260-1117"><a href="#cb260-1117" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb260-1118"><a href="#cb260-1118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1119"><a href="#cb260-1119" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Display summary table ---</span></span>
<span id="cb260-1120"><a href="#cb260-1120" aria-hidden="true" tabindex="-1"></a>channel_summary <span class="sc">%&gt;%</span></span>
<span id="cb260-1121"><a href="#cb260-1121" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(</span>
<span id="cb260-1122"><a href="#cb260-1122" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Channel"</span>, <span class="st">"Transactions"</span>, <span class="st">"Mean Age"</span>,</span>
<span id="cb260-1123"><a href="#cb260-1123" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Median Age"</span>, <span class="st">"Mean Amount ($)"</span>, </span>
<span id="cb260-1124"><a href="#cb260-1124" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Median Amount ($)"</span>),</span>
<span id="cb260-1125"><a href="#cb260-1125" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption   =</span> <span class="st">"Table: Customer Profile by Purchase Channel"</span></span>
<span id="cb260-1126"><a href="#cb260-1126" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb260-1127"><a href="#cb260-1127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb260-1128"><a href="#cb260-1128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"#00d4ff"</span>)</span>
<span id="cb260-1129"><a href="#cb260-1129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1130"><a href="#cb260-1130" aria-hidden="true" tabindex="-1"></a><span class="co"># --- T-test: Is the age difference statistically significant? ---</span></span>
<span id="cb260-1131"><a href="#cb260-1131" aria-hidden="true" tabindex="-1"></a>online_ages   <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(channel <span class="sc">==</span> <span class="st">"Online"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(age)</span>
<span id="cb260-1132"><a href="#cb260-1132" aria-hidden="true" tabindex="-1"></a>instore_ages  <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(channel <span class="sc">==</span> <span class="st">"In-Store"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(age)</span>
<span id="cb260-1133"><a href="#cb260-1133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1134"><a href="#cb260-1134" aria-hidden="true" tabindex="-1"></a>ttest_result <span class="ot">&lt;-</span> <span class="fu">t.test</span>(instore_ages, online_ages)</span>
<span id="cb260-1135"><a href="#cb260-1135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1136"><a href="#cb260-1136" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Welch Two-Sample T-Test: Age by Channel</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-1137"><a href="#cb260-1137" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  In-Store Mean Age:"</span>, <span class="fu">round</span>(<span class="fu">mean</span>(instore_ages), <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-1138"><a href="#cb260-1138" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Online Mean Age:  "</span>, <span class="fu">round</span>(<span class="fu">mean</span>(online_ages), <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-1139"><a href="#cb260-1139" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  t-statistic:      "</span>, <span class="fu">round</span>(ttest_result<span class="sc">$</span>statistic, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-1140"><a href="#cb260-1140" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  p-value:          "</span>, <span class="fu">round</span>(ttest_result<span class="sc">$</span>p.value, <span class="dv">6</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-1141"><a href="#cb260-1141" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Conclusion:       "</span>,</span>
<span id="cb260-1142"><a href="#cb260-1142" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ifelse</span>(ttest_result<span class="sc">$</span>p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>,</span>
<span id="cb260-1143"><a href="#cb260-1143" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Statistically significant difference (p &lt; 0.05)"</span>,</span>
<span id="cb260-1144"><a href="#cb260-1144" aria-hidden="true" tabindex="-1"></a>           <span class="st">"No statistically significant difference (p &gt;= 0.05)"</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-1145"><a href="#cb260-1145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1146"><a href="#cb260-1146" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Channel colour palette ---</span></span>
<span id="cb260-1147"><a href="#cb260-1147" aria-hidden="true" tabindex="-1"></a>channel_palette <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Online"</span> <span class="ot">=</span> <span class="st">"#00d4ff"</span>, <span class="st">"In-Store"</span> <span class="ot">=</span> <span class="st">"#ff6b6b"</span>)</span>
<span id="cb260-1148"><a href="#cb260-1148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1149"><a href="#cb260-1149" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Density plot: Age distribution by channel ---</span></span>
<span id="cb260-1150"><a href="#cb260-1150" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb260-1151"><a href="#cb260-1151" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">fill =</span> channel, <span class="at">color =</span> channel)) <span class="sc">+</span></span>
<span id="cb260-1152"><a href="#cb260-1152" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb260-1153"><a href="#cb260-1153" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values  =</span> channel_palette) <span class="sc">+</span></span>
<span id="cb260-1154"><a href="#cb260-1154" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> channel_palette) <span class="sc">+</span></span>
<span id="cb260-1155"><a href="#cb260-1155" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb260-1156"><a href="#cb260-1156" aria-hidden="true" tabindex="-1"></a>    <span class="at">title    =</span> <span class="st">"Age Distribution by Purchase Channel"</span>,</span>
<span id="cb260-1157"><a href="#cb260-1157" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Online vs In-Store customer age profiles"</span>,</span>
<span id="cb260-1158"><a href="#cb260-1158" aria-hidden="true" tabindex="-1"></a>    <span class="at">x        =</span> <span class="st">"Customer Age"</span>,</span>
<span id="cb260-1159"><a href="#cb260-1159" aria-hidden="true" tabindex="-1"></a>    <span class="at">y        =</span> <span class="st">"Density"</span>,</span>
<span id="cb260-1160"><a href="#cb260-1160" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill     =</span> <span class="st">"Channel"</span>,</span>
<span id="cb260-1161"><a href="#cb260-1161" aria-hidden="true" tabindex="-1"></a>    <span class="at">color    =</span> <span class="st">"Channel"</span></span>
<span id="cb260-1162"><a href="#cb260-1162" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb260-1163"><a href="#cb260-1163" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb260-1164"><a href="#cb260-1164" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb260-1165"><a href="#cb260-1165" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background   =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#0a0a0f"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb260-1166"><a href="#cb260-1166" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background  =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#12121a"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb260-1167"><a href="#cb260-1167" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major  =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#2a2a3a"</span>),</span>
<span id="cb260-1168"><a href="#cb260-1168" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor  =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb260-1169"><a href="#cb260-1169" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title        =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#ffffff"</span>,</span>
<span id="cb260-1170"><a href="#cb260-1170" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">face  =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb260-1171"><a href="#cb260-1171" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle     =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb260-1172"><a href="#cb260-1172" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text         =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>),</span>
<span id="cb260-1173"><a href="#cb260-1173" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title        =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>),</span>
<span id="cb260-1174"><a href="#cb260-1174" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#12121a"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb260-1175"><a href="#cb260-1175" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title      =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>, <span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb260-1176"><a href="#cb260-1176" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text       =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>, <span class="at">size =</span> <span class="dv">8</span>)</span>
<span id="cb260-1177"><a href="#cb260-1177" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb260-1178"><a href="#cb260-1178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1179"><a href="#cb260-1179" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Boxplot: Age by channel ---</span></span>
<span id="cb260-1180"><a href="#cb260-1180" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb260-1181"><a href="#cb260-1181" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> channel, <span class="at">y =</span> age, <span class="at">fill =</span> channel)) <span class="sc">+</span></span>
<span id="cb260-1182"><a href="#cb260-1182" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.colour =</span> <span class="st">"#ff4d4d"</span>,</span>
<span id="cb260-1183"><a href="#cb260-1183" aria-hidden="true" tabindex="-1"></a>               <span class="at">outlier.alpha  =</span> <span class="fl">0.3</span>,</span>
<span id="cb260-1184"><a href="#cb260-1184" aria-hidden="true" tabindex="-1"></a>               <span class="at">outlier.size   =</span> <span class="fl">0.8</span>,</span>
<span id="cb260-1185"><a href="#cb260-1185" aria-hidden="true" tabindex="-1"></a>               <span class="at">width          =</span> <span class="fl">0.5</span>,</span>
<span id="cb260-1186"><a href="#cb260-1186" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha          =</span> <span class="fl">0.85</span>) <span class="sc">+</span></span>
<span id="cb260-1187"><a href="#cb260-1187" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">alpha =</span> <span class="fl">0.02</span>, <span class="at">width =</span> <span class="fl">0.2</span>,</span>
<span id="cb260-1188"><a href="#cb260-1188" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"#ffffff"</span>, <span class="at">size =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb260-1189"><a href="#cb260-1189" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> channel_palette) <span class="sc">+</span></span>
<span id="cb260-1190"><a href="#cb260-1190" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb260-1191"><a href="#cb260-1191" aria-hidden="true" tabindex="-1"></a>    <span class="at">title    =</span> <span class="st">"Age Spread by Purchase Channel"</span>,</span>
<span id="cb260-1192"><a href="#cb260-1192" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Median age comparison between channels"</span>,</span>
<span id="cb260-1193"><a href="#cb260-1193" aria-hidden="true" tabindex="-1"></a>    <span class="at">x        =</span> <span class="cn">NULL</span>,</span>
<span id="cb260-1194"><a href="#cb260-1194" aria-hidden="true" tabindex="-1"></a>    <span class="at">y        =</span> <span class="st">"Customer Age"</span></span>
<span id="cb260-1195"><a href="#cb260-1195" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb260-1196"><a href="#cb260-1196" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb260-1197"><a href="#cb260-1197" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb260-1198"><a href="#cb260-1198" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background  =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#0a0a0f"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb260-1199"><a href="#cb260-1199" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#12121a"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb260-1200"><a href="#cb260-1200" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#2a2a3a"</span>),</span>
<span id="cb260-1201"><a href="#cb260-1201" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb260-1202"><a href="#cb260-1202" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title       =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#ffffff"</span>,</span>
<span id="cb260-1203"><a href="#cb260-1203" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">face  =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb260-1204"><a href="#cb260-1204" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle    =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb260-1205"><a href="#cb260-1205" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text        =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>),</span>
<span id="cb260-1206"><a href="#cb260-1206" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title       =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>),</span>
<span id="cb260-1207"><a href="#cb260-1207" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position  =</span> <span class="st">"none"</span></span>
<span id="cb260-1208"><a href="#cb260-1208" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb260-1209"><a href="#cb260-1209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1210"><a href="#cb260-1210" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Display side by side ---</span></span>
<span id="cb260-1211"><a href="#cb260-1211" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span></span>
<span id="cb260-1212"><a href="#cb260-1212" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb260-1213"><a href="#cb260-1213" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Figure: Purchase Channel: Age Analysis"</span>,</span>
<span id="cb260-1214"><a href="#cb260-1214" aria-hidden="true" tabindex="-1"></a>    <span class="at">theme =</span> <span class="fu">theme</span>(</span>
<span id="cb260-1215"><a href="#cb260-1215" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#0a0a0f"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb260-1216"><a href="#cb260-1216" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title      =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#ffffff"</span>,</span>
<span id="cb260-1217"><a href="#cb260-1217" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">face  =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">13</span>)</span>
<span id="cb260-1218"><a href="#cb260-1218" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb260-1219"><a href="#cb260-1219" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb260-1220"><a href="#cb260-1220" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb260-1221"><a href="#cb260-1221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1222"><a href="#cb260-1222" aria-hidden="true" tabindex="-1"></a><span class="fu">### Interpretation: Martin's Hypothesis #1</span></span>
<span id="cb260-1223"><a href="#cb260-1223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1224"><a href="#cb260-1224" aria-hidden="true" tabindex="-1"></a>The data **partially supports** Martin's hypothesis but in the opposite direction to what he expected.</span>
<span id="cb260-1225"><a href="#cb260-1225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1226"><a href="#cb260-1226" aria-hidden="true" tabindex="-1"></a>Online customers are actually **older** (mean age 48.56) than in-store customers (mean age 42.96), contradicting Martin's claim that in-store shoppers are older. The Welch t-test confirms this difference is **statistically significant** (t = -51.21, p <span class="sc">\&lt;</span> 0.0001), meaning it is extremely unlikely to be due to chance across 79,979 transactions.</span>
<span id="cb260-1227"><a href="#cb260-1227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1228"><a href="#cb260-1228" aria-hidden="true" tabindex="-1"></a>Additionally, in-store customers spend considerably more on average (**\$688.18**) compared to online customers (**\$441.89**), despite being younger, which further contradicts Martin's assumption that older customers are the higher spenders.</span>
<span id="cb260-1229"><a href="#cb260-1229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1230"><a href="#cb260-1230" aria-hidden="true" tabindex="-1"></a>**Recommendation:** The evidence does not support redesigning the website to attract older buyers, older customers are already the primary online shoppers. Instead, attention should focus on understanding why younger in-store customers are generating higher transaction values, and whether that behaviour can be replicated through the online channel to drive eCommerce revenue.</span>
<span id="cb260-1231"><a href="#cb260-1231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1232"><a href="#cb260-1232" aria-hidden="true" tabindex="-1"></a><span class="fu">## Age Differences Across Regions</span></span>
<span id="cb260-1233"><a href="#cb260-1233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1234"><a href="#cb260-1234" aria-hidden="true" tabindex="-1"></a>Danielle's second email raises an important question: are there meaningful differences in the age profile of customers across the four regions? Understanding whether age varies by region is valuable for two reasons: it informs region-specific marketing strategies, and it lays the analytical foundation for the predictive modelling section that follows, where age and other demographic variables are used to predict customer behaviour.</span>
<span id="cb260-1235"><a href="#cb260-1235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1236"><a href="#cb260-1236" aria-hidden="true" tabindex="-1"></a>Age distributions across the four regions are examined here using a combination of summary statistics, density plots, and boxplots.</span>
<span id="cb260-1237"><a href="#cb260-1237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1240"><a href="#cb260-1240" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb260-1241"><a href="#cb260-1241" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: age-by-region</span></span>
<span id="cb260-1242"><a href="#cb260-1242" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb260-1243"><a href="#cb260-1243" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb260-1244"><a href="#cb260-1244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1245"><a href="#cb260-1245" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Summary statistics: Age by region ---</span></span>
<span id="cb260-1246"><a href="#cb260-1246" aria-hidden="true" tabindex="-1"></a>region_age_summary <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb260-1247"><a href="#cb260-1247" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(region) <span class="sc">%&gt;%</span></span>
<span id="cb260-1248"><a href="#cb260-1248" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb260-1249"><a href="#cb260-1249" aria-hidden="true" tabindex="-1"></a>    <span class="at">Transactions =</span> <span class="fu">n</span>(),</span>
<span id="cb260-1250"><a href="#cb260-1250" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mean_Age     =</span> <span class="fu">round</span>(<span class="fu">mean</span>(age), <span class="dv">1</span>),</span>
<span id="cb260-1251"><a href="#cb260-1251" aria-hidden="true" tabindex="-1"></a>    <span class="at">Median_Age   =</span> <span class="fu">round</span>(<span class="fu">median</span>(age), <span class="dv">1</span>),</span>
<span id="cb260-1252"><a href="#cb260-1252" aria-hidden="true" tabindex="-1"></a>    <span class="at">SD_Age       =</span> <span class="fu">round</span>(<span class="fu">sd</span>(age), <span class="dv">1</span>),</span>
<span id="cb260-1253"><a href="#cb260-1253" aria-hidden="true" tabindex="-1"></a>    <span class="at">Min_Age      =</span> <span class="fu">min</span>(age),</span>
<span id="cb260-1254"><a href="#cb260-1254" aria-hidden="true" tabindex="-1"></a>    <span class="at">Max_Age      =</span> <span class="fu">max</span>(age)</span>
<span id="cb260-1255"><a href="#cb260-1255" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb260-1256"><a href="#cb260-1256" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Mean_Age))</span>
<span id="cb260-1257"><a href="#cb260-1257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1258"><a href="#cb260-1258" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Display summary table ---</span></span>
<span id="cb260-1259"><a href="#cb260-1259" aria-hidden="true" tabindex="-1"></a>region_age_summary <span class="sc">%&gt;%</span></span>
<span id="cb260-1260"><a href="#cb260-1260" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(</span>
<span id="cb260-1261"><a href="#cb260-1261" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Region"</span>, <span class="st">"Transactions"</span>, <span class="st">"Mean Age"</span>,</span>
<span id="cb260-1262"><a href="#cb260-1262" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Median Age"</span>, <span class="st">"Std Dev"</span>, </span>
<span id="cb260-1263"><a href="#cb260-1263" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Min Age"</span>, <span class="st">"Max Age"</span>),</span>
<span id="cb260-1264"><a href="#cb260-1264" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption   =</span> <span class="st">"Table: Customer Age Profile by Region"</span></span>
<span id="cb260-1265"><a href="#cb260-1265" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb260-1266"><a href="#cb260-1266" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb260-1267"><a href="#cb260-1267" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"#00d4ff"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb260-1268"><a href="#cb260-1268" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="dv">1</span>, <span class="at">background =</span> <span class="st">"rgba(0, 212, 255, 0.08)"</span>)</span>
<span id="cb260-1269"><a href="#cb260-1269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1270"><a href="#cb260-1270" aria-hidden="true" tabindex="-1"></a><span class="co"># --- ANOVA: Is age difference across regions significant? ---</span></span>
<span id="cb260-1271"><a href="#cb260-1271" aria-hidden="true" tabindex="-1"></a>anova_result <span class="ot">&lt;-</span> <span class="fu">aov</span>(age <span class="sc">~</span> region, <span class="at">data =</span> df)</span>
<span id="cb260-1272"><a href="#cb260-1272" aria-hidden="true" tabindex="-1"></a>anova_summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(anova_result)</span>
<span id="cb260-1273"><a href="#cb260-1273" aria-hidden="true" tabindex="-1"></a>p_value <span class="ot">&lt;-</span> anova_summary[[<span class="dv">1</span>]][[<span class="st">"Pr(&gt;F)"</span>]][<span class="dv">1</span>]</span>
<span id="cb260-1274"><a href="#cb260-1274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1275"><a href="#cb260-1275" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">One-Way ANOVA: Age by Region</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-1276"><a href="#cb260-1276" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  F-statistic:"</span>, <span class="fu">round</span>(anova_summary[[<span class="dv">1</span>]][[<span class="st">"F value"</span>]][<span class="dv">1</span>], <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-1277"><a href="#cb260-1277" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  p-value:    "</span>, <span class="fu">round</span>(p_value, <span class="dv">6</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-1278"><a href="#cb260-1278" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Conclusion: "</span>,</span>
<span id="cb260-1279"><a href="#cb260-1279" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ifelse</span>(p_value <span class="sc">&lt;</span> <span class="fl">0.05</span>,</span>
<span id="cb260-1280"><a href="#cb260-1280" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Statistically significant age differences across regions (p &lt; 0.05)"</span>,</span>
<span id="cb260-1281"><a href="#cb260-1281" aria-hidden="true" tabindex="-1"></a>           <span class="st">"No statistically significant difference (p &gt;= 0.05)"</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-1282"><a href="#cb260-1282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1283"><a href="#cb260-1283" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Region colour palette ---</span></span>
<span id="cb260-1284"><a href="#cb260-1284" aria-hidden="true" tabindex="-1"></a>region_palette <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb260-1285"><a href="#cb260-1285" aria-hidden="true" tabindex="-1"></a>  <span class="st">"North"</span> <span class="ot">=</span> <span class="st">"#00d4ff"</span>,</span>
<span id="cb260-1286"><a href="#cb260-1286" aria-hidden="true" tabindex="-1"></a>  <span class="st">"South"</span> <span class="ot">=</span> <span class="st">"#7b61ff"</span>,</span>
<span id="cb260-1287"><a href="#cb260-1287" aria-hidden="true" tabindex="-1"></a>  <span class="st">"East"</span>  <span class="ot">=</span> <span class="st">"#f0c040"</span>,</span>
<span id="cb260-1288"><a href="#cb260-1288" aria-hidden="true" tabindex="-1"></a>  <span class="st">"West"</span>  <span class="ot">=</span> <span class="st">"#ff6b6b"</span></span>
<span id="cb260-1289"><a href="#cb260-1289" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb260-1290"><a href="#cb260-1290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1291"><a href="#cb260-1291" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Density plot: Age distribution by region ---</span></span>
<span id="cb260-1292"><a href="#cb260-1292" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb260-1293"><a href="#cb260-1293" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">fill =</span> region, <span class="at">color =</span> region)) <span class="sc">+</span></span>
<span id="cb260-1294"><a href="#cb260-1294" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb260-1295"><a href="#cb260-1295" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values  =</span> region_palette) <span class="sc">+</span></span>
<span id="cb260-1296"><a href="#cb260-1296" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> region_palette) <span class="sc">+</span></span>
<span id="cb260-1297"><a href="#cb260-1297" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb260-1298"><a href="#cb260-1298" aria-hidden="true" tabindex="-1"></a>    <span class="at">title    =</span> <span class="st">"Age Distribution by Region"</span>,</span>
<span id="cb260-1299"><a href="#cb260-1299" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Distinct age profiles visible across regions"</span>,</span>
<span id="cb260-1300"><a href="#cb260-1300" aria-hidden="true" tabindex="-1"></a>    <span class="at">x        =</span> <span class="st">"Customer Age"</span>,</span>
<span id="cb260-1301"><a href="#cb260-1301" aria-hidden="true" tabindex="-1"></a>    <span class="at">y        =</span> <span class="st">"Density"</span>,</span>
<span id="cb260-1302"><a href="#cb260-1302" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill     =</span> <span class="st">"Region"</span>,</span>
<span id="cb260-1303"><a href="#cb260-1303" aria-hidden="true" tabindex="-1"></a>    <span class="at">color    =</span> <span class="st">"Region"</span></span>
<span id="cb260-1304"><a href="#cb260-1304" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb260-1305"><a href="#cb260-1305" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb260-1306"><a href="#cb260-1306" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb260-1307"><a href="#cb260-1307" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background   =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#0a0a0f"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb260-1308"><a href="#cb260-1308" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background  =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#12121a"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb260-1309"><a href="#cb260-1309" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major  =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#2a2a3a"</span>),</span>
<span id="cb260-1310"><a href="#cb260-1310" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor  =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb260-1311"><a href="#cb260-1311" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title        =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#ffffff"</span>,</span>
<span id="cb260-1312"><a href="#cb260-1312" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">face  =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb260-1313"><a href="#cb260-1313" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle     =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb260-1314"><a href="#cb260-1314" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text         =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>),</span>
<span id="cb260-1315"><a href="#cb260-1315" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title        =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>),</span>
<span id="cb260-1316"><a href="#cb260-1316" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#12121a"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb260-1317"><a href="#cb260-1317" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title      =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>, <span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb260-1318"><a href="#cb260-1318" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text       =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>, <span class="at">size =</span> <span class="dv">8</span>)</span>
<span id="cb260-1319"><a href="#cb260-1319" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb260-1320"><a href="#cb260-1320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1321"><a href="#cb260-1321" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Boxplot: Age spread by region ---</span></span>
<span id="cb260-1322"><a href="#cb260-1322" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb260-1323"><a href="#cb260-1323" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(region, age, <span class="at">FUN =</span> mean),</span>
<span id="cb260-1324"><a href="#cb260-1324" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> age, <span class="at">fill =</span> region)) <span class="sc">+</span></span>
<span id="cb260-1325"><a href="#cb260-1325" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.colour =</span> <span class="st">"#ff4d4d"</span>,</span>
<span id="cb260-1326"><a href="#cb260-1326" aria-hidden="true" tabindex="-1"></a>               <span class="at">outlier.alpha  =</span> <span class="fl">0.3</span>,</span>
<span id="cb260-1327"><a href="#cb260-1327" aria-hidden="true" tabindex="-1"></a>               <span class="at">outlier.size   =</span> <span class="fl">0.8</span>,</span>
<span id="cb260-1328"><a href="#cb260-1328" aria-hidden="true" tabindex="-1"></a>               <span class="at">width          =</span> <span class="fl">0.5</span>,</span>
<span id="cb260-1329"><a href="#cb260-1329" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha          =</span> <span class="fl">0.85</span>) <span class="sc">+</span></span>
<span id="cb260-1330"><a href="#cb260-1330" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">alpha =</span> <span class="fl">0.015</span>, <span class="at">width =</span> <span class="fl">0.2</span>,</span>
<span id="cb260-1331"><a href="#cb260-1331" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"#ffffff"</span>, <span class="at">size =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb260-1332"><a href="#cb260-1332" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> region_palette) <span class="sc">+</span></span>
<span id="cb260-1333"><a href="#cb260-1333" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb260-1334"><a href="#cb260-1334" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb260-1335"><a href="#cb260-1335" aria-hidden="true" tabindex="-1"></a>    <span class="at">title    =</span> <span class="st">"Age Spread by Region"</span>,</span>
<span id="cb260-1336"><a href="#cb260-1336" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Ordered by mean age — South notably older"</span>,</span>
<span id="cb260-1337"><a href="#cb260-1337" aria-hidden="true" tabindex="-1"></a>    <span class="at">x        =</span> <span class="cn">NULL</span>,</span>
<span id="cb260-1338"><a href="#cb260-1338" aria-hidden="true" tabindex="-1"></a>    <span class="at">y        =</span> <span class="st">"Customer Age"</span></span>
<span id="cb260-1339"><a href="#cb260-1339" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb260-1340"><a href="#cb260-1340" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb260-1341"><a href="#cb260-1341" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb260-1342"><a href="#cb260-1342" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background  =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#0a0a0f"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb260-1343"><a href="#cb260-1343" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#12121a"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb260-1344"><a href="#cb260-1344" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#2a2a3a"</span>),</span>
<span id="cb260-1345"><a href="#cb260-1345" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb260-1346"><a href="#cb260-1346" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title       =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#ffffff"</span>,</span>
<span id="cb260-1347"><a href="#cb260-1347" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">face  =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb260-1348"><a href="#cb260-1348" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle    =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb260-1349"><a href="#cb260-1349" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text        =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>),</span>
<span id="cb260-1350"><a href="#cb260-1350" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title       =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>),</span>
<span id="cb260-1351"><a href="#cb260-1351" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position  =</span> <span class="st">"none"</span></span>
<span id="cb260-1352"><a href="#cb260-1352" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb260-1353"><a href="#cb260-1353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1354"><a href="#cb260-1354" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Display side by side ---</span></span>
<span id="cb260-1355"><a href="#cb260-1355" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span></span>
<span id="cb260-1356"><a href="#cb260-1356" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb260-1357"><a href="#cb260-1357" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Figure: Age Distribution Across Regions"</span>,</span>
<span id="cb260-1358"><a href="#cb260-1358" aria-hidden="true" tabindex="-1"></a>    <span class="at">theme =</span> <span class="fu">theme</span>(</span>
<span id="cb260-1359"><a href="#cb260-1359" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#0a0a0f"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb260-1360"><a href="#cb260-1360" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title      =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#ffffff"</span>,</span>
<span id="cb260-1361"><a href="#cb260-1361" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">face  =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">13</span>)</span>
<span id="cb260-1362"><a href="#cb260-1362" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb260-1363"><a href="#cb260-1363" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb260-1364"><a href="#cb260-1364" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb260-1365"><a href="#cb260-1365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1366"><a href="#cb260-1366" aria-hidden="true" tabindex="-1"></a><span class="fu">### Interpretation</span></span>
<span id="cb260-1367"><a href="#cb260-1367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1368"><a href="#cb260-1368" aria-hidden="true" tabindex="-1"></a>Significant age differences exist across Blackwell's four regions. The mean age ranking from oldest to youngest is:</span>
<span id="cb260-1369"><a href="#cb260-1369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1370"><a href="#cb260-1370" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**South**: 56.6 years (oldest)</span>
<span id="cb260-1371"><a href="#cb260-1371" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**East**: 45.6 years</span>
<span id="cb260-1372"><a href="#cb260-1372" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>**North**: 43.7 years</span>
<span id="cb260-1373"><a href="#cb260-1373" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>**West**: 38.8 years (youngest)</span>
<span id="cb260-1374"><a href="#cb260-1374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1375"><a href="#cb260-1375" aria-hidden="true" tabindex="-1"></a>The South region stands out strikingly. Iits customers are on average **17.8 years older** than West region customers. Combined with the earlier finding that the South has the lowest spending ceiling (\$499.94 maximum), this paints a consistent picture; the South has an older, more conservative spending customer base.</span>
<span id="cb260-1376"><a href="#cb260-1376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1377"><a href="#cb260-1377" aria-hidden="true" tabindex="-1"></a>The West, by contrast, has the youngest customer profile and the highest transaction values. Reinforcing the earlier finding that younger customers tend to spend more.</span>
<span id="cb260-1378"><a href="#cb260-1378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1379"><a href="#cb260-1379" aria-hidden="true" tabindex="-1"></a>The One-Way ANOVA confirms these differences are **statistically significant** (F = 6,139.42, p <span class="sc">\&lt;</span> 0.0001). The age gaps across regions are not due to chance.</span>
<span id="cb260-1380"><a href="#cb260-1380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1381"><a href="#cb260-1381" aria-hidden="true" tabindex="-1"></a>**Recommendation:** Regional marketing strategies should account for these demographic differences. The South may respond better to trust-building, value-oriented messaging suited to an older audience. The West and East, with younger and higher-spending customers, are better targets for premium and technology-forward campaigns.</span>
<span id="cb260-1382"><a href="#cb260-1382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1383"><a href="#cb260-1383" aria-hidden="true" tabindex="-1"></a><span class="fu"># Predictive Modelling</span></span>
<span id="cb260-1384"><a href="#cb260-1384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1385"><a href="#cb260-1385" aria-hidden="true" tabindex="-1"></a>The exploratory analysis has revealed clear patterns in Blackwell's customer data. This section builds on those findings by developing predictive models that can anticipate customer behaviour, moving beyond description into prediction.</span>
<span id="cb260-1386"><a href="#cb260-1386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1387"><a href="#cb260-1387" aria-hidden="true" tabindex="-1"></a>Three prediction tasks are addressed:</span>
<span id="cb260-1388"><a href="#cb260-1388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1389"><a href="#cb260-1389" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Purchase Channel Prediction**: Can a customer's likelihood of shopping online or in-store be predicted from their demographic and transaction data? *(Binary Classification)*</span>
<span id="cb260-1390"><a href="#cb260-1390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1391"><a href="#cb260-1391" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Customer Age Prediction**: Can the age of a customer be estimated from their purchasing behaviour and region? *(Regression)*</span>
<span id="cb260-1392"><a href="#cb260-1392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1393"><a href="#cb260-1393" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>**Region Prediction**: Can the region a customer belongs to be predicted from their demographic profile? *(Multi-Class Classification)*</span>
<span id="cb260-1394"><a href="#cb260-1394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1395"><a href="#cb260-1395" aria-hidden="true" tabindex="-1"></a>For each task, three models are trained and evaluated on a held-out test set, and the best performing model is selected for final interpretation and business recommendations.</span>
<span id="cb260-1396"><a href="#cb260-1396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1397"><a href="#cb260-1397" aria-hidden="true" tabindex="-1"></a><span class="fu">## Modelling Approach</span></span>
<span id="cb260-1398"><a href="#cb260-1398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1399"><a href="#cb260-1399" aria-hidden="true" tabindex="-1"></a>All three tasks follow a consistent workflow:</span>
<span id="cb260-1400"><a href="#cb260-1400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1401"><a href="#cb260-1401" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Data splitting**: 80% training, 20% test set</span>
<span id="cb260-1402"><a href="#cb260-1402" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Reproducibility**: a fixed random seed (set.seed(1234)) is used throughout to ensure results are fully reproducible</span>
<span id="cb260-1403"><a href="#cb260-1403" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Model training**: three candidate models trained per task</span>
<span id="cb260-1404"><a href="#cb260-1404" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Model selection**: best model chosen based on evaluation metrics on the test set</span>
<span id="cb260-1405"><a href="#cb260-1405" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Interpretation**: findings translated into actionable business recommendations</span>
<span id="cb260-1406"><a href="#cb260-1406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1407"><a href="#cb260-1407" aria-hidden="true" tabindex="-1"></a><span class="fu">## Features Available for Modelling</span></span>
<span id="cb260-1408"><a href="#cb260-1408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1409"><a href="#cb260-1409" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Task               <span class="pp">|</span> Target Variable <span class="pp">|</span> Predictor Variables            <span class="pp">|</span></span>
<span id="cb260-1410"><a href="#cb260-1410" aria-hidden="true" tabindex="-1"></a><span class="pp">|--------------------|-----------------|--------------------------------|</span></span>
<span id="cb260-1411"><a href="#cb260-1411" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Channel Prediction <span class="pp">|</span> channel         <span class="pp">|</span> age, items, amount, region     <span class="pp">|</span></span>
<span id="cb260-1412"><a href="#cb260-1412" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Age Prediction     <span class="pp">|</span> age             <span class="pp">|</span> channel, items, amount, region <span class="pp">|</span></span>
<span id="cb260-1413"><a href="#cb260-1413" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Region Prediction  <span class="pp">|</span> region          <span class="pp">|</span> age, channel, items, amount    <span class="pp">|</span></span>
<span id="cb260-1414"><a href="#cb260-1414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1417"><a href="#cb260-1417" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb260-1418"><a href="#cb260-1418" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: modelling-setup</span></span>
<span id="cb260-1419"><a href="#cb260-1419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1420"><a href="#cb260-1420" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Set seed for reproducibility ---</span></span>
<span id="cb260-1421"><a href="#cb260-1421" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb260-1422"><a href="#cb260-1422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1423"><a href="#cb260-1423" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Define reusable train control ---</span></span>
<span id="cb260-1424"><a href="#cb260-1424" aria-hidden="true" tabindex="-1"></a><span class="co"># 5-fold cross validation during training</span></span>
<span id="cb260-1425"><a href="#cb260-1425" aria-hidden="true" tabindex="-1"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(</span>
<span id="cb260-1426"><a href="#cb260-1426" aria-hidden="true" tabindex="-1"></a>  <span class="at">method          =</span> <span class="st">"cv"</span>,</span>
<span id="cb260-1427"><a href="#cb260-1427" aria-hidden="true" tabindex="-1"></a>  <span class="at">number          =</span> <span class="dv">5</span>,</span>
<span id="cb260-1428"><a href="#cb260-1428" aria-hidden="true" tabindex="-1"></a>  <span class="at">savePredictions =</span> <span class="st">"final"</span>,</span>
<span id="cb260-1429"><a href="#cb260-1429" aria-hidden="true" tabindex="-1"></a>  <span class="at">verboseIter     =</span> <span class="cn">FALSE</span></span>
<span id="cb260-1430"><a href="#cb260-1430" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb260-1431"><a href="#cb260-1431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1432"><a href="#cb260-1432" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Modelling setup complete.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-1433"><a href="#cb260-1433" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Random seed set to 1234 for full reproducibility.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-1434"><a href="#cb260-1434" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"5-fold cross-validation configured for all models.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-1435"><a href="#cb260-1435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1436"><a href="#cb260-1436" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb260-1437"><a href="#cb260-1437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1438"><a href="#cb260-1438" aria-hidden="true" tabindex="-1"></a>A 5-fold cross-validation strategy is applied during training. This means the training set is divided into five equal folds. The model trains on four folds and validates on the fifth, rotating until every fold has served as the validation set. This produces a more reliable estimate of model performance than a single train/validate split, and reduces the risk of overfitting.</span>
<span id="cb260-1439"><a href="#cb260-1439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1440"><a href="#cb260-1440" aria-hidden="true" tabindex="-1"></a><span class="fu"># Purchase Channel Prediction</span></span>
<span id="cb260-1441"><a href="#cb260-1441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1442"><a href="#cb260-1442" aria-hidden="true" tabindex="-1"></a>The first modelling task investigates whether a customer's purchase channel, **online or in-store**, can be predicted from their demographic and transaction data. This is a binary classification problem, where the target variable has two possible outcomes: Online or In-Store.</span>
<span id="cb260-1443"><a href="#cb260-1443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1444"><a href="#cb260-1444" aria-hidden="true" tabindex="-1"></a>Accurately predicting purchase channel would allow Blackwell to proactively identify customers likely to shop online versus in-store, enabling more targeted marketing, personalised communications, and smarter inventory decisions across channels.</span>
<span id="cb260-1445"><a href="#cb260-1445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1446"><a href="#cb260-1446" aria-hidden="true" tabindex="-1"></a>**Candidate predictor variables:** age, items, amount, region</span>
<span id="cb260-1447"><a href="#cb260-1447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1448"><a href="#cb260-1448" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data Splitting</span></span>
<span id="cb260-1449"><a href="#cb260-1449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1452"><a href="#cb260-1452" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb260-1453"><a href="#cb260-1453" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: channel-split</span></span>
<span id="cb260-1454"><a href="#cb260-1454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1455"><a href="#cb260-1455" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 80/20 Train/Test Split ---</span></span>
<span id="cb260-1456"><a href="#cb260-1456" aria-hidden="true" tabindex="-1"></a>train_index <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(df<span class="sc">$</span>channel, <span class="at">p =</span> <span class="fl">0.8</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb260-1457"><a href="#cb260-1457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1458"><a href="#cb260-1458" aria-hidden="true" tabindex="-1"></a>train_channel <span class="ot">&lt;-</span> df[train_index, ]</span>
<span id="cb260-1459"><a href="#cb260-1459" aria-hidden="true" tabindex="-1"></a>test_channel  <span class="ot">&lt;-</span> df[<span class="sc">-</span>train_index, ]</span>
<span id="cb260-1460"><a href="#cb260-1460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1461"><a href="#cb260-1461" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Channel Prediction: Data Split Summary:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-1462"><a href="#cb260-1462" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Training set:"</span>, <span class="fu">nrow</span>(train_channel), <span class="st">"rows</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-1463"><a href="#cb260-1463" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Test set:    "</span>, <span class="fu">nrow</span>(test_channel), <span class="st">"rows</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb260-1464"><a href="#cb260-1464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1465"><a href="#cb260-1465" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Verify class balance in split ---</span></span>
<span id="cb260-1466"><a href="#cb260-1466" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Training set channel distribution:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-1467"><a href="#cb260-1467" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">prop.table</span>(<span class="fu">table</span>(train_channel<span class="sc">$</span>channel)))</span>
<span id="cb260-1468"><a href="#cb260-1468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1469"><a href="#cb260-1469" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Test set channel distribution:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-1470"><a href="#cb260-1470" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">prop.table</span>(<span class="fu">table</span>(test_channel<span class="sc">$</span>channel)))</span>
<span id="cb260-1471"><a href="#cb260-1471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1472"><a href="#cb260-1472" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb260-1473"><a href="#cb260-1473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1474"><a href="#cb260-1474" aria-hidden="true" tabindex="-1"></a><span class="fu">## Feature Selection</span></span>
<span id="cb260-1475"><a href="#cb260-1475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1478"><a href="#cb260-1478" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb260-1479"><a href="#cb260-1479" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: channel-rfe</span></span>
<span id="cb260-1480"><a href="#cb260-1480" aria-hidden="true" tabindex="-1"></a><span class="co">#| cache: true</span></span>
<span id="cb260-1481"><a href="#cb260-1481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1482"><a href="#cb260-1482" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Recursive Feature Elimination ---</span></span>
<span id="cb260-1483"><a href="#cb260-1483" aria-hidden="true" tabindex="-1"></a><span class="co"># Using Random Forest as the estimator for feature importance</span></span>
<span id="cb260-1484"><a href="#cb260-1484" aria-hidden="true" tabindex="-1"></a>rfe_control <span class="ot">&lt;-</span> <span class="fu">rfeControl</span>(</span>
<span id="cb260-1485"><a href="#cb260-1485" aria-hidden="true" tabindex="-1"></a>  <span class="at">functions =</span> rfFuncs,</span>
<span id="cb260-1486"><a href="#cb260-1486" aria-hidden="true" tabindex="-1"></a>  <span class="at">method    =</span> <span class="st">"cv"</span>,</span>
<span id="cb260-1487"><a href="#cb260-1487" aria-hidden="true" tabindex="-1"></a>  <span class="at">number    =</span> <span class="dv">5</span>,</span>
<span id="cb260-1488"><a href="#cb260-1488" aria-hidden="true" tabindex="-1"></a>  <span class="at">verbose   =</span> <span class="cn">FALSE</span></span>
<span id="cb260-1489"><a href="#cb260-1489" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb260-1490"><a href="#cb260-1490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1491"><a href="#cb260-1491" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Prepare features and target ---</span></span>
<span id="cb260-1492"><a href="#cb260-1492" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert region to numeric for RFE compatibility</span></span>
<span id="cb260-1493"><a href="#cb260-1493" aria-hidden="true" tabindex="-1"></a>train_channel_rfe <span class="ot">&lt;-</span> train_channel <span class="sc">%&gt;%</span></span>
<span id="cb260-1494"><a href="#cb260-1494" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb260-1495"><a href="#cb260-1495" aria-hidden="true" tabindex="-1"></a>    <span class="at">region_num  =</span> <span class="fu">as.numeric</span>(region),</span>
<span id="cb260-1496"><a href="#cb260-1496" aria-hidden="true" tabindex="-1"></a>    <span class="at">channel_num =</span> <span class="fu">as.numeric</span>(channel)</span>
<span id="cb260-1497"><a href="#cb260-1497" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb260-1498"><a href="#cb260-1498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1499"><a href="#cb260-1499" aria-hidden="true" tabindex="-1"></a>rfe_features <span class="ot">&lt;-</span> train_channel_rfe <span class="sc">%&gt;%</span></span>
<span id="cb260-1500"><a href="#cb260-1500" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(age, items, amount, region_num)</span>
<span id="cb260-1501"><a href="#cb260-1501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1502"><a href="#cb260-1502" aria-hidden="true" tabindex="-1"></a>rfe_target <span class="ot">&lt;-</span> train_channel_rfe<span class="sc">$</span>channel</span>
<span id="cb260-1503"><a href="#cb260-1503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1504"><a href="#cb260-1504" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Run RFE ---</span></span>
<span id="cb260-1505"><a href="#cb260-1505" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb260-1506"><a href="#cb260-1506" aria-hidden="true" tabindex="-1"></a>rfe_result_channel <span class="ot">&lt;-</span> <span class="fu">rfe</span>(</span>
<span id="cb260-1507"><a href="#cb260-1507" aria-hidden="true" tabindex="-1"></a>  <span class="at">x          =</span> rfe_features,</span>
<span id="cb260-1508"><a href="#cb260-1508" aria-hidden="true" tabindex="-1"></a>  <span class="at">y          =</span> rfe_target,</span>
<span id="cb260-1509"><a href="#cb260-1509" aria-hidden="true" tabindex="-1"></a>  <span class="at">sizes      =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>),</span>
<span id="cb260-1510"><a href="#cb260-1510" aria-hidden="true" tabindex="-1"></a>  <span class="at">rfeControl =</span> rfe_control</span>
<span id="cb260-1511"><a href="#cb260-1511" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb260-1512"><a href="#cb260-1512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1513"><a href="#cb260-1513" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Results ---</span></span>
<span id="cb260-1514"><a href="#cb260-1514" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Optimal Features Selected:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-1515"><a href="#cb260-1515" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">predictors</span>(rfe_result_channel))</span>
<span id="cb260-1516"><a href="#cb260-1516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1517"><a href="#cb260-1517" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">RFE Performance Summary:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-1518"><a href="#cb260-1518" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(rfe_result_channel)</span>
<span id="cb260-1519"><a href="#cb260-1519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1520"><a href="#cb260-1520" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Extract RFE results for custom plot ---</span></span>
<span id="cb260-1521"><a href="#cb260-1521" aria-hidden="true" tabindex="-1"></a>rfe_results_df <span class="ot">&lt;-</span> rfe_result_channel<span class="sc">$</span>results</span>
<span id="cb260-1522"><a href="#cb260-1522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1523"><a href="#cb260-1523" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Custom readable RFE plot ---</span></span>
<span id="cb260-1524"><a href="#cb260-1524" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(rfe_results_df, <span class="fu">aes</span>(<span class="at">x =</span> Variables, <span class="at">y =</span> Accuracy)) <span class="sc">+</span></span>
<span id="cb260-1525"><a href="#cb260-1525" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"#00d4ff"</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb260-1526"><a href="#cb260-1526" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> Accuracy), </span>
<span id="cb260-1527"><a href="#cb260-1527" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"#f0c040"</span>, <span class="at">fill =</span> <span class="st">"#f0c040"</span>,</span>
<span id="cb260-1528"><a href="#cb260-1528" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">stroke =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb260-1529"><a href="#cb260-1529" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(Accuracy, <span class="dv">4</span>)),</span>
<span id="cb260-1530"><a href="#cb260-1530" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust  =</span> <span class="sc">-</span><span class="fl">1.2</span>,</span>
<span id="cb260-1531"><a href="#cb260-1531" aria-hidden="true" tabindex="-1"></a>            <span class="at">color  =</span> <span class="st">"#ffffff"</span>,</span>
<span id="cb260-1532"><a href="#cb260-1532" aria-hidden="true" tabindex="-1"></a>            <span class="at">size   =</span> <span class="fl">3.8</span>,</span>
<span id="cb260-1533"><a href="#cb260-1533" aria-hidden="true" tabindex="-1"></a>            <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb260-1534"><a href="#cb260-1534" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb260-1535"><a href="#cb260-1535" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb260-1536"><a href="#cb260-1536" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(</span>
<span id="cb260-1537"><a href="#cb260-1537" aria-hidden="true" tabindex="-1"></a>      <span class="fu">min</span>(rfe_results_df<span class="sc">$</span>Accuracy) <span class="sc">-</span> <span class="fl">0.01</span>,</span>
<span id="cb260-1538"><a href="#cb260-1538" aria-hidden="true" tabindex="-1"></a>      <span class="fu">max</span>(rfe_results_df<span class="sc">$</span>Accuracy) <span class="sc">+</span> <span class="fl">0.02</span></span>
<span id="cb260-1539"><a href="#cb260-1539" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb260-1540"><a href="#cb260-1540" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>(<span class="at">accuracy =</span> <span class="fl">0.1</span>)</span>
<span id="cb260-1541"><a href="#cb260-1541" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb260-1542"><a href="#cb260-1542" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb260-1543"><a href="#cb260-1543" aria-hidden="true" tabindex="-1"></a>    <span class="at">title    =</span> <span class="st">"Figure: RFE: Feature Selection for Channel Prediction"</span>,</span>
<span id="cb260-1544"><a href="#cb260-1544" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Cross-validated accuracy by number of features retained"</span>,</span>
<span id="cb260-1545"><a href="#cb260-1545" aria-hidden="true" tabindex="-1"></a>    <span class="at">x        =</span> <span class="st">"Number of Features"</span>,</span>
<span id="cb260-1546"><a href="#cb260-1546" aria-hidden="true" tabindex="-1"></a>    <span class="at">y        =</span> <span class="st">"Accuracy (Cross-Validated)"</span></span>
<span id="cb260-1547"><a href="#cb260-1547" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb260-1548"><a href="#cb260-1548" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb260-1549"><a href="#cb260-1549" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb260-1550"><a href="#cb260-1550" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background  =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#0a0a0f"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb260-1551"><a href="#cb260-1551" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#12121a"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb260-1552"><a href="#cb260-1552" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#2a2a3a"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>),</span>
<span id="cb260-1553"><a href="#cb260-1553" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb260-1554"><a href="#cb260-1554" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title       =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#ffffff"</span>,</span>
<span id="cb260-1555"><a href="#cb260-1555" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">face  =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb260-1556"><a href="#cb260-1556" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle    =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb260-1557"><a href="#cb260-1557" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text        =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#e8e8e8"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb260-1558"><a href="#cb260-1558" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title       =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#e8e8e8"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb260-1559"><a href="#cb260-1559" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position  =</span> <span class="st">"none"</span></span>
<span id="cb260-1560"><a href="#cb260-1560" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb260-1561"><a href="#cb260-1561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1562"><a href="#cb260-1562" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb260-1563"><a href="#cb260-1563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1564"><a href="#cb260-1564" aria-hidden="true" tabindex="-1"></a><span class="fu">## Feature Selection Results</span></span>
<span id="cb260-1565"><a href="#cb260-1565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1566"><a href="#cb260-1566" aria-hidden="true" tabindex="-1"></a>Recursive Feature Elimination identified **three optimal features** for predicting purchase channel: **region, amount, and age.**</span>
<span id="cb260-1567"><a href="#cb260-1567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1568"><a href="#cb260-1568" aria-hidden="true" tabindex="-1"></a>The <span class="in">`items`</span> variable was eliminated, contributing no meaningful predictive power, consistent with the EDA finding that items purchased has no relationship with customer behaviour.</span>
<span id="cb260-1569"><a href="#cb260-1569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1570"><a href="#cb260-1570" aria-hidden="true" tabindex="-1"></a>Cross-validated accuracy improves progressively from 74.77% with one feature to **88.72% with three features**. Adding the fourth feature (items) actually reduces accuracy slightly to 88.29%, confirming the three-feature model as optimal.</span>
<span id="cb260-1571"><a href="#cb260-1571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1572"><a href="#cb260-1572" aria-hidden="true" tabindex="-1"></a>All three models will be trained using region, amount, and age as predictor variables.\</span>
<span id="cb260-1573"><a href="#cb260-1573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1574"><a href="#cb260-1574" aria-hidden="true" tabindex="-1"></a><span class="fu">## Models Training</span></span>
<span id="cb260-1575"><a href="#cb260-1575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1578"><a href="#cb260-1578" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb260-1579"><a href="#cb260-1579" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: channel-models</span></span>
<span id="cb260-1580"><a href="#cb260-1580" aria-hidden="true" tabindex="-1"></a><span class="co">#| cache: true</span></span>
<span id="cb260-1581"><a href="#cb260-1581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1582"><a href="#cb260-1582" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Prepare train and test sets with RFE selected features ---</span></span>
<span id="cb260-1583"><a href="#cb260-1583" aria-hidden="true" tabindex="-1"></a>train_x <span class="ot">&lt;-</span> train_channel <span class="sc">%&gt;%</span> <span class="fu">select</span>(age, amount, region)</span>
<span id="cb260-1584"><a href="#cb260-1584" aria-hidden="true" tabindex="-1"></a>test_x  <span class="ot">&lt;-</span> test_channel <span class="sc">%&gt;%</span> <span class="fu">select</span>(age, amount, region)</span>
<span id="cb260-1585"><a href="#cb260-1585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1586"><a href="#cb260-1586" aria-hidden="true" tabindex="-1"></a>train_y <span class="ot">&lt;-</span> train_channel<span class="sc">$</span>channel</span>
<span id="cb260-1587"><a href="#cb260-1587" aria-hidden="true" tabindex="-1"></a>test_y  <span class="ot">&lt;-</span> test_channel<span class="sc">$</span>channel</span>
<span id="cb260-1588"><a href="#cb260-1588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1589"><a href="#cb260-1589" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Training models with features: age, amount, region</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb260-1590"><a href="#cb260-1590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1591"><a href="#cb260-1591" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Model 1: Logistic Regression ---</span></span>
<span id="cb260-1592"><a href="#cb260-1592" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb260-1593"><a href="#cb260-1593" aria-hidden="true" tabindex="-1"></a>model_lr_channel <span class="ot">&lt;-</span> <span class="fu">train</span>(</span>
<span id="cb260-1594"><a href="#cb260-1594" aria-hidden="true" tabindex="-1"></a>  <span class="at">x          =</span> train_x,</span>
<span id="cb260-1595"><a href="#cb260-1595" aria-hidden="true" tabindex="-1"></a>  <span class="at">y          =</span> train_y,</span>
<span id="cb260-1596"><a href="#cb260-1596" aria-hidden="true" tabindex="-1"></a>  <span class="at">method     =</span> <span class="st">"glm"</span>,</span>
<span id="cb260-1597"><a href="#cb260-1597" aria-hidden="true" tabindex="-1"></a>  <span class="at">family     =</span> <span class="st">"binomial"</span>,</span>
<span id="cb260-1598"><a href="#cb260-1598" aria-hidden="true" tabindex="-1"></a>  <span class="at">trControl  =</span> train_control,</span>
<span id="cb260-1599"><a href="#cb260-1599" aria-hidden="true" tabindex="-1"></a>  <span class="at">preProcess =</span> <span class="fu">c</span>(<span class="st">"center"</span>, <span class="st">"scale"</span>)</span>
<span id="cb260-1600"><a href="#cb260-1600" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb260-1601"><a href="#cb260-1601" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Logistic Regression — Trained</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-1602"><a href="#cb260-1602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1603"><a href="#cb260-1603" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Model 2: Random Forest ---</span></span>
<span id="cb260-1604"><a href="#cb260-1604" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb260-1605"><a href="#cb260-1605" aria-hidden="true" tabindex="-1"></a>model_rf_channel <span class="ot">&lt;-</span> <span class="fu">train</span>(</span>
<span id="cb260-1606"><a href="#cb260-1606" aria-hidden="true" tabindex="-1"></a>  <span class="at">x          =</span> train_x,</span>
<span id="cb260-1607"><a href="#cb260-1607" aria-hidden="true" tabindex="-1"></a>  <span class="at">y          =</span> train_y,</span>
<span id="cb260-1608"><a href="#cb260-1608" aria-hidden="true" tabindex="-1"></a>  <span class="at">method     =</span> <span class="st">"rf"</span>,</span>
<span id="cb260-1609"><a href="#cb260-1609" aria-hidden="true" tabindex="-1"></a>  <span class="at">trControl  =</span> train_control,</span>
<span id="cb260-1610"><a href="#cb260-1610" aria-hidden="true" tabindex="-1"></a>  <span class="at">preProcess =</span> <span class="fu">c</span>(<span class="st">"center"</span>, <span class="st">"scale"</span>),</span>
<span id="cb260-1611"><a href="#cb260-1611" aria-hidden="true" tabindex="-1"></a>  <span class="at">tuneLength =</span> <span class="dv">3</span></span>
<span id="cb260-1612"><a href="#cb260-1612" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb260-1613"><a href="#cb260-1613" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Random Forest — Trained</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-1614"><a href="#cb260-1614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1615"><a href="#cb260-1615" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Model 3: Decision Tree ---</span></span>
<span id="cb260-1616"><a href="#cb260-1616" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb260-1617"><a href="#cb260-1617" aria-hidden="true" tabindex="-1"></a>model_dt_channel <span class="ot">&lt;-</span> <span class="fu">train</span>(</span>
<span id="cb260-1618"><a href="#cb260-1618" aria-hidden="true" tabindex="-1"></a>  <span class="at">x          =</span> train_x,</span>
<span id="cb260-1619"><a href="#cb260-1619" aria-hidden="true" tabindex="-1"></a>  <span class="at">y          =</span> train_y,</span>
<span id="cb260-1620"><a href="#cb260-1620" aria-hidden="true" tabindex="-1"></a>  <span class="at">method     =</span> <span class="st">"rpart"</span>,</span>
<span id="cb260-1621"><a href="#cb260-1621" aria-hidden="true" tabindex="-1"></a>  <span class="at">trControl  =</span> train_control,</span>
<span id="cb260-1622"><a href="#cb260-1622" aria-hidden="true" tabindex="-1"></a>  <span class="at">preProcess =</span> <span class="fu">c</span>(<span class="st">"center"</span>, <span class="st">"scale"</span>),</span>
<span id="cb260-1623"><a href="#cb260-1623" aria-hidden="true" tabindex="-1"></a>  <span class="at">tuneLength =</span> <span class="dv">10</span></span>
<span id="cb260-1624"><a href="#cb260-1624" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb260-1625"><a href="#cb260-1625" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Decision Tree — Trained</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-1626"><a href="#cb260-1626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1627"><a href="#cb260-1627" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">All three models trained successfully.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-1628"><a href="#cb260-1628" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb260-1629"><a href="#cb260-1629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1630"><a href="#cb260-1630" aria-hidden="true" tabindex="-1"></a><span class="fu">## Channel Model Comparison</span></span>
<span id="cb260-1631"><a href="#cb260-1631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1634"><a href="#cb260-1634" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb260-1635"><a href="#cb260-1635" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: channel-comparison</span></span>
<span id="cb260-1636"><a href="#cb260-1636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1637"><a href="#cb260-1637" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Predictions on test set ---</span></span>
<span id="cb260-1638"><a href="#cb260-1638" aria-hidden="true" tabindex="-1"></a>pred_lr_channel <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_lr_channel, test_x)</span>
<span id="cb260-1639"><a href="#cb260-1639" aria-hidden="true" tabindex="-1"></a>pred_rf_channel <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_rf_channel, test_x)</span>
<span id="cb260-1640"><a href="#cb260-1640" aria-hidden="true" tabindex="-1"></a>pred_dt_channel <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_dt_channel, test_x)</span>
<span id="cb260-1641"><a href="#cb260-1641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1642"><a href="#cb260-1642" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Confusion matrices ---</span></span>
<span id="cb260-1643"><a href="#cb260-1643" aria-hidden="true" tabindex="-1"></a>cm_lr <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_lr_channel, test_y)</span>
<span id="cb260-1644"><a href="#cb260-1644" aria-hidden="true" tabindex="-1"></a>cm_rf <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_rf_channel, test_y)</span>
<span id="cb260-1645"><a href="#cb260-1645" aria-hidden="true" tabindex="-1"></a>cm_dt <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_dt_channel, test_y)</span>
<span id="cb260-1646"><a href="#cb260-1646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1647"><a href="#cb260-1647" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Model comparison table ---</span></span>
<span id="cb260-1648"><a href="#cb260-1648" aria-hidden="true" tabindex="-1"></a>model_comparison_channel <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb260-1649"><a href="#cb260-1649" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model       =</span> <span class="fu">c</span>(<span class="st">"Logistic Regression"</span>,</span>
<span id="cb260-1650"><a href="#cb260-1650" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Random Forest"</span>,</span>
<span id="cb260-1651"><a href="#cb260-1651" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Decision Tree"</span>),</span>
<span id="cb260-1652"><a href="#cb260-1652" aria-hidden="true" tabindex="-1"></a>  <span class="at">Accuracy    =</span> <span class="fu">c</span>(cm_lr<span class="sc">$</span>overall[<span class="st">"Accuracy"</span>],</span>
<span id="cb260-1653"><a href="#cb260-1653" aria-hidden="true" tabindex="-1"></a>                  cm_rf<span class="sc">$</span>overall[<span class="st">"Accuracy"</span>],</span>
<span id="cb260-1654"><a href="#cb260-1654" aria-hidden="true" tabindex="-1"></a>                  cm_dt<span class="sc">$</span>overall[<span class="st">"Accuracy"</span>]),</span>
<span id="cb260-1655"><a href="#cb260-1655" aria-hidden="true" tabindex="-1"></a>  <span class="at">Kappa       =</span> <span class="fu">c</span>(cm_lr<span class="sc">$</span>overall[<span class="st">"Kappa"</span>],</span>
<span id="cb260-1656"><a href="#cb260-1656" aria-hidden="true" tabindex="-1"></a>                  cm_rf<span class="sc">$</span>overall[<span class="st">"Kappa"</span>],</span>
<span id="cb260-1657"><a href="#cb260-1657" aria-hidden="true" tabindex="-1"></a>                  cm_dt<span class="sc">$</span>overall[<span class="st">"Kappa"</span>]),</span>
<span id="cb260-1658"><a href="#cb260-1658" aria-hidden="true" tabindex="-1"></a>  <span class="at">Sensitivity =</span> <span class="fu">c</span>(cm_lr<span class="sc">$</span>byClass[<span class="st">"Sensitivity"</span>],</span>
<span id="cb260-1659"><a href="#cb260-1659" aria-hidden="true" tabindex="-1"></a>                  cm_rf<span class="sc">$</span>byClass[<span class="st">"Sensitivity"</span>],</span>
<span id="cb260-1660"><a href="#cb260-1660" aria-hidden="true" tabindex="-1"></a>                  cm_dt<span class="sc">$</span>byClass[<span class="st">"Sensitivity"</span>]),</span>
<span id="cb260-1661"><a href="#cb260-1661" aria-hidden="true" tabindex="-1"></a>  <span class="at">Specificity =</span> <span class="fu">c</span>(cm_lr<span class="sc">$</span>byClass[<span class="st">"Specificity"</span>],</span>
<span id="cb260-1662"><a href="#cb260-1662" aria-hidden="true" tabindex="-1"></a>                  cm_rf<span class="sc">$</span>byClass[<span class="st">"Specificity"</span>],</span>
<span id="cb260-1663"><a href="#cb260-1663" aria-hidden="true" tabindex="-1"></a>                  cm_dt<span class="sc">$</span>byClass[<span class="st">"Specificity"</span>])</span>
<span id="cb260-1664"><a href="#cb260-1664" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb260-1665"><a href="#cb260-1665" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span> <span class="fu">round</span>(., <span class="dv">4</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb260-1666"><a href="#cb260-1666" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Accuracy))</span>
<span id="cb260-1667"><a href="#cb260-1667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1668"><a href="#cb260-1668" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Display comparison table ---</span></span>
<span id="cb260-1669"><a href="#cb260-1669" aria-hidden="true" tabindex="-1"></a>model_comparison_channel <span class="sc">%&gt;%</span></span>
<span id="cb260-1670"><a href="#cb260-1670" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(</span>
<span id="cb260-1671"><a href="#cb260-1671" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Model"</span>, <span class="st">"Accuracy"</span>, <span class="st">"Kappa"</span>,</span>
<span id="cb260-1672"><a href="#cb260-1672" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Sensitivity"</span>, <span class="st">"Specificity"</span>),</span>
<span id="cb260-1673"><a href="#cb260-1673" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption   =</span> <span class="st">"Table 9: Model Comparison — Channel Prediction"</span></span>
<span id="cb260-1674"><a href="#cb260-1674" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb260-1675"><a href="#cb260-1675" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb260-1676"><a href="#cb260-1676" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"#00d4ff"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb260-1677"><a href="#cb260-1677" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="dv">1</span>, <span class="at">background =</span> <span class="st">"rgba(0, 212, 255, 0.08)"</span>)</span>
<span id="cb260-1678"><a href="#cb260-1678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1679"><a href="#cb260-1679" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Best model statement ---</span></span>
<span id="cb260-1680"><a href="#cb260-1680" aria-hidden="true" tabindex="-1"></a>best_model    <span class="ot">&lt;-</span> model_comparison_channel<span class="sc">$</span>Model[<span class="dv">1</span>]</span>
<span id="cb260-1681"><a href="#cb260-1681" aria-hidden="true" tabindex="-1"></a>best_accuracy <span class="ot">&lt;-</span> <span class="fu">round</span>(model_comparison_channel<span class="sc">$</span>Accuracy[<span class="dv">1</span>] <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>)</span>
<span id="cb260-1682"><a href="#cb260-1682" aria-hidden="true" tabindex="-1"></a>best_kappa    <span class="ot">&lt;-</span> model_comparison_channel<span class="sc">$</span>Kappa[<span class="dv">1</span>]</span>
<span id="cb260-1683"><a href="#cb260-1683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1684"><a href="#cb260-1684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1685"><a href="#cb260-1685" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Best Performing Model:"</span>, best_model, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-1686"><a href="#cb260-1686" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Test Set Accuracy:    "</span>, best_accuracy, <span class="st">"%</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-1687"><a href="#cb260-1687" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Kappa Statistic:      "</span>, best_kappa, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-1688"><a href="#cb260-1688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1689"><a href="#cb260-1689" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb260-1690"><a href="#cb260-1690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1691"><a href="#cb260-1691" aria-hidden="true" tabindex="-1"></a><span class="fu">## Purchase Channel Best Model</span></span>
<span id="cb260-1692"><a href="#cb260-1692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1695"><a href="#cb260-1695" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb260-1696"><a href="#cb260-1696" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: channel-dt-evaluation</span></span>
<span id="cb260-1697"><a href="#cb260-1697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1698"><a href="#cb260-1698" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Confusion Matrix: Decision Tree ---</span></span>
<span id="cb260-1699"><a href="#cb260-1699" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Confusion Matrix — Decision Tree</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-1700"><a href="#cb260-1700" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"==================================</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-1701"><a href="#cb260-1701" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cm_dt<span class="sc">$</span>table)</span>
<span id="cb260-1702"><a href="#cb260-1702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1703"><a href="#cb260-1703" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Actual vs Predicted comparison table ---</span></span>
<span id="cb260-1704"><a href="#cb260-1704" aria-hidden="true" tabindex="-1"></a>dt_results <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb260-1705"><a href="#cb260-1705" aria-hidden="true" tabindex="-1"></a>  <span class="at">Actual    =</span> test_y,</span>
<span id="cb260-1706"><a href="#cb260-1706" aria-hidden="true" tabindex="-1"></a>  <span class="at">Predicted =</span> pred_dt_channel,</span>
<span id="cb260-1707"><a href="#cb260-1707" aria-hidden="true" tabindex="-1"></a>  <span class="at">Correct   =</span> test_y <span class="sc">==</span> pred_dt_channel</span>
<span id="cb260-1708"><a href="#cb260-1708" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb260-1709"><a href="#cb260-1709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1710"><a href="#cb260-1710" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Summary of correct vs incorrect predictions ---</span></span>
<span id="cb260-1711"><a href="#cb260-1711" aria-hidden="true" tabindex="-1"></a>dt_summary <span class="ot">&lt;-</span> dt_results <span class="sc">%&gt;%</span></span>
<span id="cb260-1712"><a href="#cb260-1712" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Actual, Predicted) <span class="sc">%&gt;%</span></span>
<span id="cb260-1713"><a href="#cb260-1713" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb260-1714"><a href="#cb260-1714" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb260-1715"><a href="#cb260-1715" aria-hidden="true" tabindex="-1"></a>    <span class="at">Result =</span> <span class="fu">ifelse</span>(Actual <span class="sc">==</span> Predicted, </span>
<span id="cb260-1716"><a href="#cb260-1716" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"Correct"</span>, <span class="st">"Incorrect"</span>)</span>
<span id="cb260-1717"><a href="#cb260-1717" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb260-1718"><a href="#cb260-1718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1719"><a href="#cb260-1719" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Display actual vs predicted table ---</span></span>
<span id="cb260-1720"><a href="#cb260-1720" aria-hidden="true" tabindex="-1"></a>dt_summary <span class="sc">%&gt;%</span></span>
<span id="cb260-1721"><a href="#cb260-1721" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(</span>
<span id="cb260-1722"><a href="#cb260-1722" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Actual"</span>, <span class="st">"Predicted"</span>, </span>
<span id="cb260-1723"><a href="#cb260-1723" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Count"</span>, <span class="st">"Result"</span>),</span>
<span id="cb260-1724"><a href="#cb260-1724" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption   =</span> <span class="st">"Table 10: Actual vs Predicted — Decision Tree"</span></span>
<span id="cb260-1725"><a href="#cb260-1725" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb260-1726"><a href="#cb260-1726" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb260-1727"><a href="#cb260-1727" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"#00d4ff"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb260-1728"><a href="#cb260-1728" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">4</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>,</span>
<span id="cb260-1729"><a href="#cb260-1729" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="fu">ifelse</span>(dt_summary<span class="sc">$</span>Result <span class="sc">==</span> <span class="st">"Correct"</span>,</span>
<span id="cb260-1730"><a href="#cb260-1730" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"#00ff9d"</span>, <span class="st">"#ff6b6b"</span>))</span>
<span id="cb260-1731"><a href="#cb260-1731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1732"><a href="#cb260-1732" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Overall prediction accuracy breakdown ---</span></span>
<span id="cb260-1733"><a href="#cb260-1733" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Prediction Breakdown:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-1734"><a href="#cb260-1734" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Correctly classified:  "</span>, <span class="fu">sum</span>(dt_results<span class="sc">$</span>Correct), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-1735"><a href="#cb260-1735" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Incorrectly classified:"</span>, <span class="fu">sum</span>(<span class="sc">!</span>dt_results<span class="sc">$</span>Correct), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-1736"><a href="#cb260-1736" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Overall Accuracy:      "</span>, </span>
<span id="cb260-1737"><a href="#cb260-1737" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">mean</span>(dt_results<span class="sc">$</span>Correct) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>), <span class="st">"%</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-1738"><a href="#cb260-1738" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb260-1739"><a href="#cb260-1739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1740"><a href="#cb260-1740" aria-hidden="true" tabindex="-1"></a><span class="fu">## Best model for channel prediction</span></span>
<span id="cb260-1741"><a href="#cb260-1741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1744"><a href="#cb260-1744" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb260-1745"><a href="#cb260-1745" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: save-channel-model</span></span>
<span id="cb260-1746"><a href="#cb260-1746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1747"><a href="#cb260-1747" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Save best model for channel prediction ---</span></span>
<span id="cb260-1748"><a href="#cb260-1748" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(model_dt_channel, <span class="st">"best_model_channel.rds"</span>)</span>
<span id="cb260-1749"><a href="#cb260-1749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1750"><a href="#cb260-1750" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Best model for channel prediction saved successfully.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-1751"><a href="#cb260-1751" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Model: Decision Tree</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-1752"><a href="#cb260-1752" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"File:  best_model_channel.rds</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-1753"><a href="#cb260-1753" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb260-1754"><a href="#cb260-1754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1755"><a href="#cb260-1755" aria-hidden="true" tabindex="-1"></a><span class="fu">## Interpretation: Channel Prediction</span></span>
<span id="cb260-1756"><a href="#cb260-1756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1757"><a href="#cb260-1757" aria-hidden="true" tabindex="-1"></a>The Decision Tree outperformed both Random Forest and Logistic Regression, achieving a test set accuracy of **88.82%** and a Kappa of **0.7764**, indicating strong agreement between predicted and actual channel classifications beyond chance.</span>
<span id="cb260-1758"><a href="#cb260-1758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1759"><a href="#cb260-1759" aria-hidden="true" tabindex="-1"></a>The actual vs predicted table reveals an important asymmetry in model performance:</span>
<span id="cb260-1760"><a href="#cb260-1760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1761"><a href="#cb260-1761" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Online customers** are predicted with near-perfect accuracy. Only **1** **Online custome**r was misclassified as In-Store</span>
<span id="cb260-1762"><a href="#cb260-1762" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**In-Store customers** are harder to predict. **1,744 In-Store customers** were incorrectly classified as Online</span>
<span id="cb260-1763"><a href="#cb260-1763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1764"><a href="#cb260-1764" aria-hidden="true" tabindex="-1"></a>This suggests the model has learned a very strong signal for identifying Online customers, likely driven by age and region, but finds In-Store customers more difficult to distinguish, possibly because their demographic profile overlaps more with Online customers in certain regions.</span>
<span id="cb260-1765"><a href="#cb260-1765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1766"><a href="#cb260-1766" aria-hidden="true" tabindex="-1"></a>Overall, 14,250 out of 15,995 customers were correctly classified, with only 1,745 misclassifications.</span>
<span id="cb260-1767"><a href="#cb260-1767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1768"><a href="#cb260-1768" aria-hidden="true" tabindex="-1"></a>**Recommendation:** The Decision Tree model provides a reliable tool for predicting whether a customer will shop online or in-store. Blackwell can use this model to proactively segment new customers and personalise marketing communications by channel before a purchase is even made. The model's near-perfect identification of Online customers is particularly valuable for targeted digital marketing campaigns.</span>
<span id="cb260-1769"><a href="#cb260-1769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1770"><a href="#cb260-1770" aria-hidden="true" tabindex="-1"></a><span class="fu"># Customer Age Prediction</span></span>
<span id="cb260-1771"><a href="#cb260-1771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1772"><a href="#cb260-1772" aria-hidden="true" tabindex="-1"></a>The second modelling task investigates whether the age of a customer can be predicted from their purchasing behaviour and demographic data. This is a regression problem; the target variable, age, is a continuous numeric value rather than a category.</span>
<span id="cb260-1773"><a href="#cb260-1773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1774"><a href="#cb260-1774" aria-hidden="true" tabindex="-1"></a>Predicting customer age is valuable for Blackwell because age data may not always be available for every customer. A reliable predictive model would allow the business to estimate the age profile of new customers from transaction data alone, enabling more targeted marketing without requiring customers to explicitly provide their age.</span>
<span id="cb260-1775"><a href="#cb260-1775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1776"><a href="#cb260-1776" aria-hidden="true" tabindex="-1"></a>It is worth acknowledging upfront that the EDA revealed only a weak negative correlation between age and amount spent (r = -0.282), and that age varies significantly by region. Predicting age from the available variables is therefore expected to be a challenging task, and this is reflected honestly in the results.</span>
<span id="cb260-1777"><a href="#cb260-1777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1778"><a href="#cb260-1778" aria-hidden="true" tabindex="-1"></a>**Candidate predictor variables:** channel, items, amount, region</span>
<span id="cb260-1779"><a href="#cb260-1779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1780"><a href="#cb260-1780" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data Splitting</span></span>
<span id="cb260-1781"><a href="#cb260-1781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1784"><a href="#cb260-1784" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb260-1785"><a href="#cb260-1785" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: age-split</span></span>
<span id="cb260-1786"><a href="#cb260-1786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1787"><a href="#cb260-1787" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 80/20 Train/Test Split ---</span></span>
<span id="cb260-1788"><a href="#cb260-1788" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb260-1789"><a href="#cb260-1789" aria-hidden="true" tabindex="-1"></a>train_index_age <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(df<span class="sc">$</span>age, <span class="at">p =</span> <span class="fl">0.8</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb260-1790"><a href="#cb260-1790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1791"><a href="#cb260-1791" aria-hidden="true" tabindex="-1"></a>train_age <span class="ot">&lt;-</span> df[train_index_age, ]</span>
<span id="cb260-1792"><a href="#cb260-1792" aria-hidden="true" tabindex="-1"></a>test_age  <span class="ot">&lt;-</span> df[<span class="sc">-</span>train_index_age, ]</span>
<span id="cb260-1793"><a href="#cb260-1793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1794"><a href="#cb260-1794" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Age Prediction — Data Split Summary:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-1795"><a href="#cb260-1795" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Training set:"</span>, <span class="fu">nrow</span>(train_age), <span class="st">"rows</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-1796"><a href="#cb260-1796" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Test set:    "</span>, <span class="fu">nrow</span>(test_age), <span class="st">"rows</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb260-1797"><a href="#cb260-1797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1798"><a href="#cb260-1798" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Verify age distribution in split ---</span></span>
<span id="cb260-1799"><a href="#cb260-1799" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Training set age summary:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-1800"><a href="#cb260-1800" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(train_age<span class="sc">$</span>age))</span>
<span id="cb260-1801"><a href="#cb260-1801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1802"><a href="#cb260-1802" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Test set age summary:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-1803"><a href="#cb260-1803" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(test_age<span class="sc">$</span>age))</span>
<span id="cb260-1804"><a href="#cb260-1804" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb260-1805"><a href="#cb260-1805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1806"><a href="#cb260-1806" aria-hidden="true" tabindex="-1"></a><span class="fu">## Feature Selection For Age Prediction</span></span>
<span id="cb260-1807"><a href="#cb260-1807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1810"><a href="#cb260-1810" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb260-1811"><a href="#cb260-1811" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: age-rfe</span></span>
<span id="cb260-1812"><a href="#cb260-1812" aria-hidden="true" tabindex="-1"></a><span class="co">#| cache: true</span></span>
<span id="cb260-1813"><a href="#cb260-1813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1814"><a href="#cb260-1814" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Recursive Feature Elimination for Age Prediction ---</span></span>
<span id="cb260-1815"><a href="#cb260-1815" aria-hidden="true" tabindex="-1"></a><span class="co"># Using Random Forest as the estimator</span></span>
<span id="cb260-1816"><a href="#cb260-1816" aria-hidden="true" tabindex="-1"></a>rfe_control_age <span class="ot">&lt;-</span> <span class="fu">rfeControl</span>(</span>
<span id="cb260-1817"><a href="#cb260-1817" aria-hidden="true" tabindex="-1"></a>  <span class="at">functions =</span> rfFuncs,</span>
<span id="cb260-1818"><a href="#cb260-1818" aria-hidden="true" tabindex="-1"></a>  <span class="at">method    =</span> <span class="st">"cv"</span>,</span>
<span id="cb260-1819"><a href="#cb260-1819" aria-hidden="true" tabindex="-1"></a>  <span class="at">number    =</span> <span class="dv">5</span>,</span>
<span id="cb260-1820"><a href="#cb260-1820" aria-hidden="true" tabindex="-1"></a>  <span class="at">verbose   =</span> <span class="cn">FALSE</span></span>
<span id="cb260-1821"><a href="#cb260-1821" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb260-1822"><a href="#cb260-1822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1823"><a href="#cb260-1823" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Prepare features and target ---</span></span>
<span id="cb260-1824"><a href="#cb260-1824" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert factors to numeric for RFE compatibility</span></span>
<span id="cb260-1825"><a href="#cb260-1825" aria-hidden="true" tabindex="-1"></a>train_age_rfe <span class="ot">&lt;-</span> train_age <span class="sc">%&gt;%</span></span>
<span id="cb260-1826"><a href="#cb260-1826" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb260-1827"><a href="#cb260-1827" aria-hidden="true" tabindex="-1"></a>    <span class="at">channel_num =</span> <span class="fu">as.numeric</span>(channel),</span>
<span id="cb260-1828"><a href="#cb260-1828" aria-hidden="true" tabindex="-1"></a>    <span class="at">region_num  =</span> <span class="fu">as.numeric</span>(region)</span>
<span id="cb260-1829"><a href="#cb260-1829" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb260-1830"><a href="#cb260-1830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1831"><a href="#cb260-1831" aria-hidden="true" tabindex="-1"></a>rfe_features_age <span class="ot">&lt;-</span> train_age_rfe <span class="sc">%&gt;%</span></span>
<span id="cb260-1832"><a href="#cb260-1832" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(channel_num, items, amount, region_num)</span>
<span id="cb260-1833"><a href="#cb260-1833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1834"><a href="#cb260-1834" aria-hidden="true" tabindex="-1"></a>rfe_target_age <span class="ot">&lt;-</span> train_age_rfe<span class="sc">$</span>age</span>
<span id="cb260-1835"><a href="#cb260-1835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1836"><a href="#cb260-1836" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Run RFE ---</span></span>
<span id="cb260-1837"><a href="#cb260-1837" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb260-1838"><a href="#cb260-1838" aria-hidden="true" tabindex="-1"></a>rfe_result_age <span class="ot">&lt;-</span> <span class="fu">rfe</span>(</span>
<span id="cb260-1839"><a href="#cb260-1839" aria-hidden="true" tabindex="-1"></a>  <span class="at">x          =</span> rfe_features_age,</span>
<span id="cb260-1840"><a href="#cb260-1840" aria-hidden="true" tabindex="-1"></a>  <span class="at">y          =</span> rfe_target_age,</span>
<span id="cb260-1841"><a href="#cb260-1841" aria-hidden="true" tabindex="-1"></a>  <span class="at">sizes      =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>),</span>
<span id="cb260-1842"><a href="#cb260-1842" aria-hidden="true" tabindex="-1"></a>  <span class="at">rfeControl =</span> rfe_control_age</span>
<span id="cb260-1843"><a href="#cb260-1843" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb260-1844"><a href="#cb260-1844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1845"><a href="#cb260-1845" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Results ---</span></span>
<span id="cb260-1846"><a href="#cb260-1846" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Optimal Features Selected:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-1847"><a href="#cb260-1847" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">predictors</span>(rfe_result_age))</span>
<span id="cb260-1848"><a href="#cb260-1848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1849"><a href="#cb260-1849" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">RFE Performance Summary:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-1850"><a href="#cb260-1850" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(rfe_result_age)</span>
<span id="cb260-1851"><a href="#cb260-1851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1852"><a href="#cb260-1852" aria-hidden="true" tabindex="-1"></a><span class="co"># --- RFE plot ---</span></span>
<span id="cb260-1853"><a href="#cb260-1853" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: age-rfe-plot</span></span>
<span id="cb260-1854"><a href="#cb260-1854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1855"><a href="#cb260-1855" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(rfe_result_age) <span class="sc">+</span></span>
<span id="cb260-1856"><a href="#cb260-1856" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb260-1857"><a href="#cb260-1857" aria-hidden="true" tabindex="-1"></a>    <span class="at">title    =</span> <span class="st">"Figure: RFE: Feature Selection for Age Prediction"</span>,</span>
<span id="cb260-1858"><a href="#cb260-1858" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"RMSE by number of features selected"</span>,</span>
<span id="cb260-1859"><a href="#cb260-1859" aria-hidden="true" tabindex="-1"></a>    <span class="at">x        =</span> <span class="st">"Number of Features"</span>,</span>
<span id="cb260-1860"><a href="#cb260-1860" aria-hidden="true" tabindex="-1"></a>    <span class="at">y        =</span> <span class="st">"RMSE (Cross-Validated)"</span></span>
<span id="cb260-1861"><a href="#cb260-1861" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb260-1862"><a href="#cb260-1862" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb260-1863"><a href="#cb260-1863" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb260-1864"><a href="#cb260-1864" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background  =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#12121a"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb260-1865"><a href="#cb260-1865" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#1e1e2e"</span>, <span class="at">color =</span> <span class="st">"#2a2a3a"</span>),</span>
<span id="cb260-1866"><a href="#cb260-1866" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#3a3a4a"</span>),</span>
<span id="cb260-1867"><a href="#cb260-1867" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#2a2a3a"</span>),</span>
<span id="cb260-1868"><a href="#cb260-1868" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title       =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#ffffff"</span>,</span>
<span id="cb260-1869"><a href="#cb260-1869" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">face  =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb260-1870"><a href="#cb260-1870" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle    =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb260-1871"><a href="#cb260-1871" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text        =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#e8e8e8"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb260-1872"><a href="#cb260-1872" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title       =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#e8e8e8"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb260-1873"><a href="#cb260-1873" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line        =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>),</span>
<span id="cb260-1874"><a href="#cb260-1874" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#1e1e2e"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb260-1875"><a href="#cb260-1875" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text       =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#e8e8e8"</span>),</span>
<span id="cb260-1876"><a href="#cb260-1876" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title      =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#e8e8e8"</span>)</span>
<span id="cb260-1877"><a href="#cb260-1877" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb260-1878"><a href="#cb260-1878" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb260-1879"><a href="#cb260-1879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1880"><a href="#cb260-1880" aria-hidden="true" tabindex="-1"></a><span class="fu">## Feature Selection Results</span></span>
<span id="cb260-1881"><a href="#cb260-1881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1882"><a href="#cb260-1882" aria-hidden="true" tabindex="-1"></a>Recursive Feature Elimination identified **three optimal features** for predicting customer age: **channel, region, and amount.**</span>
<span id="cb260-1883"><a href="#cb260-1883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1884"><a href="#cb260-1884" aria-hidden="true" tabindex="-1"></a>The <span class="in">`items`</span> variable was eliminated, contributing no meaningful predictive power, consistent with findings across both the EDA and the channel prediction task.</span>
<span id="cb260-1885"><a href="#cb260-1885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1886"><a href="#cb260-1886" aria-hidden="true" tabindex="-1"></a>Performance improves progressively from an RMSE of 15.47 with one feature to **14.00 with three features**, with R² improving from 0.031 to 0.212. Adding the fourth feature (items) produces no improvement, confirming the three-feature model as optimal.</span>
<span id="cb260-1887"><a href="#cb260-1887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1888"><a href="#cb260-1888" aria-hidden="true" tabindex="-1"></a>However, an R² of 0.212 indicates that the three selected features explain only **21.2% of the variance in customer age**, confirming the upfront acknowledgement that age is a difficult variable to predict from the available data. This is an honest and important finding that will be reflected in the model results.</span>
<span id="cb260-1889"><a href="#cb260-1889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1890"><a href="#cb260-1890" aria-hidden="true" tabindex="-1"></a>All three models will be trained using channel, amount, and region as predictor variables.</span>
<span id="cb260-1891"><a href="#cb260-1891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1892"><a href="#cb260-1892" aria-hidden="true" tabindex="-1"></a><span class="fu">## Model Training For Age Prediction</span></span>
<span id="cb260-1893"><a href="#cb260-1893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1896"><a href="#cb260-1896" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb260-1897"><a href="#cb260-1897" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: age-models</span></span>
<span id="cb260-1898"><a href="#cb260-1898" aria-hidden="true" tabindex="-1"></a><span class="co">#| cache: true</span></span>
<span id="cb260-1899"><a href="#cb260-1899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1900"><a href="#cb260-1900" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Prepare train and test sets with RFE selected features ---</span></span>
<span id="cb260-1901"><a href="#cb260-1901" aria-hidden="true" tabindex="-1"></a>train_x_age <span class="ot">&lt;-</span> train_age <span class="sc">%&gt;%</span> <span class="fu">select</span>(channel, amount, region)</span>
<span id="cb260-1902"><a href="#cb260-1902" aria-hidden="true" tabindex="-1"></a>test_x_age  <span class="ot">&lt;-</span> test_age <span class="sc">%&gt;%</span> <span class="fu">select</span>(channel, amount, region)</span>
<span id="cb260-1903"><a href="#cb260-1903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1904"><a href="#cb260-1904" aria-hidden="true" tabindex="-1"></a>train_y_age <span class="ot">&lt;-</span> train_age<span class="sc">$</span>age</span>
<span id="cb260-1905"><a href="#cb260-1905" aria-hidden="true" tabindex="-1"></a>test_y_age  <span class="ot">&lt;-</span> test_age<span class="sc">$</span>age</span>
<span id="cb260-1906"><a href="#cb260-1906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1907"><a href="#cb260-1907" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Training models with features: channel, amount, region</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb260-1908"><a href="#cb260-1908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1909"><a href="#cb260-1909" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Model 1: Linear Regression ---</span></span>
<span id="cb260-1910"><a href="#cb260-1910" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb260-1911"><a href="#cb260-1911" aria-hidden="true" tabindex="-1"></a>model_lr_age <span class="ot">&lt;-</span> <span class="fu">train</span>(</span>
<span id="cb260-1912"><a href="#cb260-1912" aria-hidden="true" tabindex="-1"></a>  <span class="at">x          =</span> train_x_age,</span>
<span id="cb260-1913"><a href="#cb260-1913" aria-hidden="true" tabindex="-1"></a>  <span class="at">y          =</span> train_y_age,</span>
<span id="cb260-1914"><a href="#cb260-1914" aria-hidden="true" tabindex="-1"></a>  <span class="at">method     =</span> <span class="st">"lm"</span>,</span>
<span id="cb260-1915"><a href="#cb260-1915" aria-hidden="true" tabindex="-1"></a>  <span class="at">trControl  =</span> train_control,</span>
<span id="cb260-1916"><a href="#cb260-1916" aria-hidden="true" tabindex="-1"></a>  <span class="at">preProcess =</span> <span class="fu">c</span>(<span class="st">"center"</span>, <span class="st">"scale"</span>)</span>
<span id="cb260-1917"><a href="#cb260-1917" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb260-1918"><a href="#cb260-1918" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Linear Regression — Trained</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-1919"><a href="#cb260-1919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1920"><a href="#cb260-1920" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Model 2: Random Forest ---</span></span>
<span id="cb260-1921"><a href="#cb260-1921" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb260-1922"><a href="#cb260-1922" aria-hidden="true" tabindex="-1"></a>model_rf_age <span class="ot">&lt;-</span> <span class="fu">train</span>(</span>
<span id="cb260-1923"><a href="#cb260-1923" aria-hidden="true" tabindex="-1"></a>  <span class="at">x          =</span> train_x_age,</span>
<span id="cb260-1924"><a href="#cb260-1924" aria-hidden="true" tabindex="-1"></a>  <span class="at">y          =</span> train_y_age,</span>
<span id="cb260-1925"><a href="#cb260-1925" aria-hidden="true" tabindex="-1"></a>  <span class="at">method     =</span> <span class="st">"rf"</span>,</span>
<span id="cb260-1926"><a href="#cb260-1926" aria-hidden="true" tabindex="-1"></a>  <span class="at">trControl  =</span> train_control,</span>
<span id="cb260-1927"><a href="#cb260-1927" aria-hidden="true" tabindex="-1"></a>  <span class="at">preProcess =</span> <span class="fu">c</span>(<span class="st">"center"</span>, <span class="st">"scale"</span>),</span>
<span id="cb260-1928"><a href="#cb260-1928" aria-hidden="true" tabindex="-1"></a>  <span class="at">tuneLength =</span> <span class="dv">3</span></span>
<span id="cb260-1929"><a href="#cb260-1929" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb260-1930"><a href="#cb260-1930" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Random Forest — Trained</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-1931"><a href="#cb260-1931" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1932"><a href="#cb260-1932" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Model 3: Decision Tree ---</span></span>
<span id="cb260-1933"><a href="#cb260-1933" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb260-1934"><a href="#cb260-1934" aria-hidden="true" tabindex="-1"></a>model_dt_age <span class="ot">&lt;-</span> <span class="fu">train</span>(</span>
<span id="cb260-1935"><a href="#cb260-1935" aria-hidden="true" tabindex="-1"></a>  <span class="at">x          =</span> train_x_age,</span>
<span id="cb260-1936"><a href="#cb260-1936" aria-hidden="true" tabindex="-1"></a>  <span class="at">y          =</span> train_y_age,</span>
<span id="cb260-1937"><a href="#cb260-1937" aria-hidden="true" tabindex="-1"></a>  <span class="at">method     =</span> <span class="st">"rpart"</span>,</span>
<span id="cb260-1938"><a href="#cb260-1938" aria-hidden="true" tabindex="-1"></a>  <span class="at">trControl  =</span> train_control,</span>
<span id="cb260-1939"><a href="#cb260-1939" aria-hidden="true" tabindex="-1"></a>  <span class="at">preProcess =</span> <span class="fu">c</span>(<span class="st">"center"</span>, <span class="st">"scale"</span>),</span>
<span id="cb260-1940"><a href="#cb260-1940" aria-hidden="true" tabindex="-1"></a>  <span class="at">tuneLength =</span> <span class="dv">10</span></span>
<span id="cb260-1941"><a href="#cb260-1941" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb260-1942"><a href="#cb260-1942" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Decision Tree — Trained</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-1943"><a href="#cb260-1943" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1944"><a href="#cb260-1944" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">All three models trained successfully.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-1945"><a href="#cb260-1945" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb260-1946"><a href="#cb260-1946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1947"><a href="#cb260-1947" aria-hidden="true" tabindex="-1"></a><span class="fu">## Age Comparison Table And Best Model </span></span>
<span id="cb260-1948"><a href="#cb260-1948" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1951"><a href="#cb260-1951" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb260-1952"><a href="#cb260-1952" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: age-comparison</span></span>
<span id="cb260-1953"><a href="#cb260-1953" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1954"><a href="#cb260-1954" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Predictions on test set ---</span></span>
<span id="cb260-1955"><a href="#cb260-1955" aria-hidden="true" tabindex="-1"></a>pred_lr_age <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_lr_age, test_x_age)</span>
<span id="cb260-1956"><a href="#cb260-1956" aria-hidden="true" tabindex="-1"></a>pred_rf_age <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_rf_age, test_x_age)</span>
<span id="cb260-1957"><a href="#cb260-1957" aria-hidden="true" tabindex="-1"></a>pred_dt_age <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_dt_age, test_x_age)</span>
<span id="cb260-1958"><a href="#cb260-1958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1959"><a href="#cb260-1959" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Model comparison table ---</span></span>
<span id="cb260-1960"><a href="#cb260-1960" aria-hidden="true" tabindex="-1"></a>model_comparison_age <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb260-1961"><a href="#cb260-1961" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model =</span> <span class="fu">c</span>(<span class="st">"Linear Regression"</span>,</span>
<span id="cb260-1962"><a href="#cb260-1962" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Random Forest"</span>,</span>
<span id="cb260-1963"><a href="#cb260-1963" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Decision Tree"</span>),</span>
<span id="cb260-1964"><a href="#cb260-1964" aria-hidden="true" tabindex="-1"></a>  <span class="at">RMSE  =</span> <span class="fu">c</span>(</span>
<span id="cb260-1965"><a href="#cb260-1965" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">RMSE</span>(pred_lr_age, test_y_age), <span class="dv">4</span>),</span>
<span id="cb260-1966"><a href="#cb260-1966" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">RMSE</span>(pred_rf_age, test_y_age), <span class="dv">4</span>),</span>
<span id="cb260-1967"><a href="#cb260-1967" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">RMSE</span>(pred_dt_age, test_y_age), <span class="dv">4</span>)</span>
<span id="cb260-1968"><a href="#cb260-1968" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb260-1969"><a href="#cb260-1969" aria-hidden="true" tabindex="-1"></a>  <span class="at">MAE =</span> <span class="fu">c</span>(</span>
<span id="cb260-1970"><a href="#cb260-1970" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">MAE</span>(pred_lr_age, test_y_age), <span class="dv">4</span>),</span>
<span id="cb260-1971"><a href="#cb260-1971" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">MAE</span>(pred_rf_age, test_y_age), <span class="dv">4</span>),</span>
<span id="cb260-1972"><a href="#cb260-1972" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">MAE</span>(pred_dt_age, test_y_age), <span class="dv">4</span>)</span>
<span id="cb260-1973"><a href="#cb260-1973" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb260-1974"><a href="#cb260-1974" aria-hidden="true" tabindex="-1"></a>  <span class="at">R_Squared =</span> <span class="fu">c</span>(</span>
<span id="cb260-1975"><a href="#cb260-1975" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">R2</span>(pred_lr_age, test_y_age), <span class="dv">4</span>),</span>
<span id="cb260-1976"><a href="#cb260-1976" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">R2</span>(pred_rf_age, test_y_age), <span class="dv">4</span>),</span>
<span id="cb260-1977"><a href="#cb260-1977" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">R2</span>(pred_dt_age, test_y_age), <span class="dv">4</span>)</span>
<span id="cb260-1978"><a href="#cb260-1978" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb260-1979"><a href="#cb260-1979" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb260-1980"><a href="#cb260-1980" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(RMSE)</span>
<span id="cb260-1981"><a href="#cb260-1981" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1982"><a href="#cb260-1982" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Display comparison table ---</span></span>
<span id="cb260-1983"><a href="#cb260-1983" aria-hidden="true" tabindex="-1"></a>model_comparison_age <span class="sc">%&gt;%</span></span>
<span id="cb260-1984"><a href="#cb260-1984" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(</span>
<span id="cb260-1985"><a href="#cb260-1985" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Model"</span>, <span class="st">"RMSE"</span>, <span class="st">"MAE"</span>, <span class="st">"R-Squared"</span>),</span>
<span id="cb260-1986"><a href="#cb260-1986" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption   =</span> <span class="st">"Table: Model Comparison — Age Prediction"</span></span>
<span id="cb260-1987"><a href="#cb260-1987" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb260-1988"><a href="#cb260-1988" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb260-1989"><a href="#cb260-1989" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"#00d4ff"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb260-1990"><a href="#cb260-1990" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="dv">1</span>, <span class="at">background =</span> <span class="st">"rgba(0, 212, 255, 0.08)"</span>)</span>
<span id="cb260-1991"><a href="#cb260-1991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1992"><a href="#cb260-1992" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Best model statement ---</span></span>
<span id="cb260-1993"><a href="#cb260-1993" aria-hidden="true" tabindex="-1"></a>best_model_age     <span class="ot">&lt;-</span> model_comparison_age<span class="sc">$</span>Model[<span class="dv">1</span>]</span>
<span id="cb260-1994"><a href="#cb260-1994" aria-hidden="true" tabindex="-1"></a>best_rmse_age      <span class="ot">&lt;-</span> model_comparison_age<span class="sc">$</span>RMSE[<span class="dv">1</span>]</span>
<span id="cb260-1995"><a href="#cb260-1995" aria-hidden="true" tabindex="-1"></a>best_mae_age       <span class="ot">&lt;-</span> model_comparison_age<span class="sc">$</span>MAE[<span class="dv">1</span>]</span>
<span id="cb260-1996"><a href="#cb260-1996" aria-hidden="true" tabindex="-1"></a>best_rsquared_age  <span class="ot">&lt;-</span> model_comparison_age<span class="sc">$</span>R_Squared[<span class="dv">1</span>]</span>
<span id="cb260-1997"><a href="#cb260-1997" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-1998"><a href="#cb260-1998" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Best Performing Model:"</span>, best_model_age, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-1999"><a href="#cb260-1999" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"RMSE:                 "</span>, best_rmse_age, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-2000"><a href="#cb260-2000" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"MAE:                  "</span>, best_mae_age, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-2001"><a href="#cb260-2001" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"R-Squared:            "</span>, best_rsquared_age, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-2002"><a href="#cb260-2002" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb260-2003"><a href="#cb260-2003" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2004"><a href="#cb260-2004" aria-hidden="true" tabindex="-1"></a><span class="fu">##  Actual vs Predicted Table For The Decision Tree</span></span>
<span id="cb260-2005"><a href="#cb260-2005" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2008"><a href="#cb260-2008" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb260-2009"><a href="#cb260-2009" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: age-dt-evaluation</span></span>
<span id="cb260-2010"><a href="#cb260-2010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2011"><a href="#cb260-2011" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Actual vs Predicted comparison ---</span></span>
<span id="cb260-2012"><a href="#cb260-2012" aria-hidden="true" tabindex="-1"></a>age_results <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb260-2013"><a href="#cb260-2013" aria-hidden="true" tabindex="-1"></a>  <span class="at">Actual    =</span> test_y_age,</span>
<span id="cb260-2014"><a href="#cb260-2014" aria-hidden="true" tabindex="-1"></a>  <span class="at">Predicted =</span> <span class="fu">round</span>(pred_dt_age, <span class="dv">1</span>),</span>
<span id="cb260-2015"><a href="#cb260-2015" aria-hidden="true" tabindex="-1"></a>  <span class="at">Error     =</span> <span class="fu">round</span>(<span class="fu">abs</span>(test_y_age <span class="sc">-</span> pred_dt_age), <span class="dv">1</span>)</span>
<span id="cb260-2016"><a href="#cb260-2016" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb260-2017"><a href="#cb260-2017" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb260-2018"><a href="#cb260-2018" aria-hidden="true" tabindex="-1"></a>    <span class="at">Error_Band =</span> <span class="fu">case_when</span>(</span>
<span id="cb260-2019"><a href="#cb260-2019" aria-hidden="true" tabindex="-1"></a>      Error <span class="sc">&lt;=</span> <span class="dv">5</span>  <span class="sc">~</span> <span class="st">"Within 5 years"</span>,</span>
<span id="cb260-2020"><a href="#cb260-2020" aria-hidden="true" tabindex="-1"></a>      Error <span class="sc">&lt;=</span> <span class="dv">10</span> <span class="sc">~</span> <span class="st">"Within 10 years"</span>,</span>
<span id="cb260-2021"><a href="#cb260-2021" aria-hidden="true" tabindex="-1"></a>      Error <span class="sc">&lt;=</span> <span class="dv">15</span> <span class="sc">~</span> <span class="st">"Within 15 years"</span>,</span>
<span id="cb260-2022"><a href="#cb260-2022" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span>        <span class="sc">~</span> <span class="st">"More than 15 years"</span></span>
<span id="cb260-2023"><a href="#cb260-2023" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb260-2024"><a href="#cb260-2024" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb260-2025"><a href="#cb260-2025" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2026"><a href="#cb260-2026" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Error band summary ---</span></span>
<span id="cb260-2027"><a href="#cb260-2027" aria-hidden="true" tabindex="-1"></a>error_summary <span class="ot">&lt;-</span> age_results <span class="sc">%&gt;%</span></span>
<span id="cb260-2028"><a href="#cb260-2028" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Error_Band) <span class="sc">%&gt;%</span></span>
<span id="cb260-2029"><a href="#cb260-2029" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb260-2030"><a href="#cb260-2030" aria-hidden="true" tabindex="-1"></a>    <span class="at">Count      =</span> <span class="fu">n</span>(),</span>
<span id="cb260-2031"><a href="#cb260-2031" aria-hidden="true" tabindex="-1"></a>    <span class="at">Percentage =</span> <span class="fu">round</span>(Count <span class="sc">/</span> <span class="fu">nrow</span>(age_results) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>)</span>
<span id="cb260-2032"><a href="#cb260-2032" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb260-2033"><a href="#cb260-2033" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Percentage <span class="sc">%&gt;%</span> <span class="fu">desc</span>())</span>
<span id="cb260-2034"><a href="#cb260-2034" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2035"><a href="#cb260-2035" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Display error band table ---</span></span>
<span id="cb260-2036"><a href="#cb260-2036" aria-hidden="true" tabindex="-1"></a>error_summary <span class="sc">%&gt;%</span></span>
<span id="cb260-2037"><a href="#cb260-2037" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(</span>
<span id="cb260-2038"><a href="#cb260-2038" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Prediction Accuracy"</span>, <span class="st">"Count"</span>, <span class="st">"Percentage (%)"</span>),</span>
<span id="cb260-2039"><a href="#cb260-2039" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption   =</span> <span class="st">"Table: Actual vs Predicted Age — Error Band Summary"</span></span>
<span id="cb260-2040"><a href="#cb260-2040" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb260-2041"><a href="#cb260-2041" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb260-2042"><a href="#cb260-2042" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"#00d4ff"</span>)</span>
<span id="cb260-2043"><a href="#cb260-2043" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2044"><a href="#cb260-2044" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Overall prediction summary ---</span></span>
<span id="cb260-2045"><a href="#cb260-2045" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Age Prediction Summary: Decision Tree:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-2046"><a href="#cb260-2046" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Mean Absolute Error:"</span>, <span class="fu">round</span>(<span class="fu">mean</span>(age_results<span class="sc">$</span>Error), <span class="dv">2</span>), <span class="st">"years</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-2047"><a href="#cb260-2047" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Median Error:       "</span>, <span class="fu">round</span>(<span class="fu">median</span>(age_results<span class="sc">$</span>Error), <span class="dv">2</span>), <span class="st">"years</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-2048"><a href="#cb260-2048" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Min Error:          "</span>, <span class="fu">round</span>(<span class="fu">min</span>(age_results<span class="sc">$</span>Error), <span class="dv">2</span>), <span class="st">"years</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-2049"><a href="#cb260-2049" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Max Error:          "</span>, <span class="fu">round</span>(<span class="fu">max</span>(age_results<span class="sc">$</span>Error), <span class="dv">2</span>), <span class="st">"years</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-2050"><a href="#cb260-2050" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb260-2051"><a href="#cb260-2051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2052"><a href="#cb260-2052" aria-hidden="true" tabindex="-1"></a><span class="fu">## Save The Best Age Model</span></span>
<span id="cb260-2053"><a href="#cb260-2053" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2056"><a href="#cb260-2056" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb260-2057"><a href="#cb260-2057" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: save-age-model</span></span>
<span id="cb260-2058"><a href="#cb260-2058" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2059"><a href="#cb260-2059" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Save best model for age prediction ---</span></span>
<span id="cb260-2060"><a href="#cb260-2060" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(model_dt_age, <span class="st">"best_model_age.rds"</span>)</span>
<span id="cb260-2061"><a href="#cb260-2061" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2062"><a href="#cb260-2062" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Best model for age prediction saved successfully.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-2063"><a href="#cb260-2063" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Model: Decision Tree</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-2064"><a href="#cb260-2064" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"File:  best_model_age.rds</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-2065"><a href="#cb260-2065" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb260-2066"><a href="#cb260-2066" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2067"><a href="#cb260-2067" aria-hidden="true" tabindex="-1"></a><span class="fu">## Interpretation: Age Prediction</span></span>
<span id="cb260-2068"><a href="#cb260-2068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2069"><a href="#cb260-2069" aria-hidden="true" tabindex="-1"></a>The Decision Tree achieved the lowest RMSE of **13.89 years** and an R-Squared of **0.2182**, marginally outperforming Random Forest (RMSE = 13.89, R² = 0.2179) and comfortably ahead of Linear Regression (RMSE = 14.10, R² = 0.1944).</span>
<span id="cb260-2070"><a href="#cb260-2070" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2071"><a href="#cb260-2071" aria-hidden="true" tabindex="-1"></a>However, the error band analysis reveals the honest limitations of this model:</span>
<span id="cb260-2072"><a href="#cb260-2072" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2073"><a href="#cb260-2073" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Only **22.30%** of predictions fall within 5 years of the actual age</span>
<span id="cb260-2074"><a href="#cb260-2074" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**34.43%** of predictions are off by more than 15 years, the largest single category</span>
<span id="cb260-2075"><a href="#cb260-2075" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The mean absolute error is **11.84 years**, meaning on average the model misjudges a customer's age by nearly 12 years</span>
<span id="cb260-2076"><a href="#cb260-2076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2077"><a href="#cb260-2077" aria-hidden="true" tabindex="-1"></a>This confirms the upfront acknowledgement that age is a challenging variable to predict from the available data. With an R-Squared of just 0.2182, channel, amount, and region together explain only **21.82% of the variance in customer age**, the remaining 78.18% is driven by factors not captured in this dataset.</span>
<span id="cb260-2078"><a href="#cb260-2078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2079"><a href="#cb260-2079" aria-hidden="true" tabindex="-1"></a>**Recommendation:** This model is not reliable enough for operational use in its current form. Blackwell would need richer customer data, such as browsing behaviour, product categories purchased, or loyalty programme data, to build a meaningfully accurate age prediction model. The finding itself is valuable however, confirming that transaction data alone is insufficient to infer customer age.</span>
<span id="cb260-2080"><a href="#cb260-2080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2081"><a href="#cb260-2081" aria-hidden="true" tabindex="-1"></a><span class="fu"># Region Prediction</span></span>
<span id="cb260-2082"><a href="#cb260-2082" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2083"><a href="#cb260-2083" aria-hidden="true" tabindex="-1"></a>The third and final modelling task investigates whether the region a customer belongs to can be predicted from their demographic and transaction data. This is a multi-class classification problem, the target variable has four possible outcomes: North, South, East, and West.</span>
<span id="cb260-2084"><a href="#cb260-2084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2085"><a href="#cb260-2085" aria-hidden="true" tabindex="-1"></a>Successfully predicting customer region would allow Blackwell to infer the geographic location of new or anonymous customers from their transaction behaviour alone, enabling region-specific marketing without requiring customers to explicitly provide their location.</span>
<span id="cb260-2086"><a href="#cb260-2086" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2087"><a href="#cb260-2087" aria-hidden="true" tabindex="-1"></a>**Candidate predictor variables:** age, channel, items, amount</span>
<span id="cb260-2088"><a href="#cb260-2088" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2089"><a href="#cb260-2089" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data Splitting</span></span>
<span id="cb260-2090"><a href="#cb260-2090" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2093"><a href="#cb260-2093" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb260-2094"><a href="#cb260-2094" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: region-split</span></span>
<span id="cb260-2095"><a href="#cb260-2095" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2096"><a href="#cb260-2096" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 80/20 Train/Test Split ---</span></span>
<span id="cb260-2097"><a href="#cb260-2097" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb260-2098"><a href="#cb260-2098" aria-hidden="true" tabindex="-1"></a>train_index_region <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(df<span class="sc">$</span>region, <span class="at">p =</span> <span class="fl">0.8</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb260-2099"><a href="#cb260-2099" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2100"><a href="#cb260-2100" aria-hidden="true" tabindex="-1"></a>train_region <span class="ot">&lt;-</span> df[train_index_region, ]</span>
<span id="cb260-2101"><a href="#cb260-2101" aria-hidden="true" tabindex="-1"></a>test_region  <span class="ot">&lt;-</span> df[<span class="sc">-</span>train_index_region, ]</span>
<span id="cb260-2102"><a href="#cb260-2102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2103"><a href="#cb260-2103" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Region Prediction — Data Split Summary:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-2104"><a href="#cb260-2104" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Training set:"</span>, <span class="fu">nrow</span>(train_region), <span class="st">"rows</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-2105"><a href="#cb260-2105" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Test set:    "</span>, <span class="fu">nrow</span>(test_region), <span class="st">"rows</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb260-2106"><a href="#cb260-2106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2107"><a href="#cb260-2107" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Verify class balance in split ---</span></span>
<span id="cb260-2108"><a href="#cb260-2108" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Training set region distribution:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-2109"><a href="#cb260-2109" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">prop.table</span>(<span class="fu">table</span>(train_region<span class="sc">$</span>region)))</span>
<span id="cb260-2110"><a href="#cb260-2110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2111"><a href="#cb260-2111" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Test set region distribution:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-2112"><a href="#cb260-2112" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">prop.table</span>(<span class="fu">table</span>(test_region<span class="sc">$</span>region)))</span>
<span id="cb260-2113"><a href="#cb260-2113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2114"><a href="#cb260-2114" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb260-2115"><a href="#cb260-2115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2116"><a href="#cb260-2116" aria-hidden="true" tabindex="-1"></a><span class="fu">## Feature Selection </span></span>
<span id="cb260-2117"><a href="#cb260-2117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2120"><a href="#cb260-2120" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb260-2121"><a href="#cb260-2121" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: region-rfe</span></span>
<span id="cb260-2122"><a href="#cb260-2122" aria-hidden="true" tabindex="-1"></a><span class="co">#| cache: true</span></span>
<span id="cb260-2123"><a href="#cb260-2123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2124"><a href="#cb260-2124" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Recursive Feature Elimination for Region Prediction ---</span></span>
<span id="cb260-2125"><a href="#cb260-2125" aria-hidden="true" tabindex="-1"></a>rfe_control_region <span class="ot">&lt;-</span> <span class="fu">rfeControl</span>(</span>
<span id="cb260-2126"><a href="#cb260-2126" aria-hidden="true" tabindex="-1"></a>  <span class="at">functions =</span> rfFuncs,</span>
<span id="cb260-2127"><a href="#cb260-2127" aria-hidden="true" tabindex="-1"></a>  <span class="at">method    =</span> <span class="st">"cv"</span>,</span>
<span id="cb260-2128"><a href="#cb260-2128" aria-hidden="true" tabindex="-1"></a>  <span class="at">number    =</span> <span class="dv">5</span>,</span>
<span id="cb260-2129"><a href="#cb260-2129" aria-hidden="true" tabindex="-1"></a>  <span class="at">verbose   =</span> <span class="cn">FALSE</span></span>
<span id="cb260-2130"><a href="#cb260-2130" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb260-2131"><a href="#cb260-2131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2132"><a href="#cb260-2132" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Prepare features and target ---</span></span>
<span id="cb260-2133"><a href="#cb260-2133" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert factors to numeric for RFE compatibility</span></span>
<span id="cb260-2134"><a href="#cb260-2134" aria-hidden="true" tabindex="-1"></a>train_region_rfe <span class="ot">&lt;-</span> train_region <span class="sc">%&gt;%</span></span>
<span id="cb260-2135"><a href="#cb260-2135" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">channel_num =</span> <span class="fu">as.numeric</span>(channel))</span>
<span id="cb260-2136"><a href="#cb260-2136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2137"><a href="#cb260-2137" aria-hidden="true" tabindex="-1"></a>rfe_features_region <span class="ot">&lt;-</span> train_region_rfe <span class="sc">%&gt;%</span></span>
<span id="cb260-2138"><a href="#cb260-2138" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(age, channel_num, items, amount)</span>
<span id="cb260-2139"><a href="#cb260-2139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2140"><a href="#cb260-2140" aria-hidden="true" tabindex="-1"></a>rfe_target_region <span class="ot">&lt;-</span> train_region_rfe<span class="sc">$</span>region</span>
<span id="cb260-2141"><a href="#cb260-2141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2142"><a href="#cb260-2142" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Run RFE ---</span></span>
<span id="cb260-2143"><a href="#cb260-2143" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb260-2144"><a href="#cb260-2144" aria-hidden="true" tabindex="-1"></a>rfe_result_region <span class="ot">&lt;-</span> <span class="fu">rfe</span>(</span>
<span id="cb260-2145"><a href="#cb260-2145" aria-hidden="true" tabindex="-1"></a>  <span class="at">x          =</span> rfe_features_region,</span>
<span id="cb260-2146"><a href="#cb260-2146" aria-hidden="true" tabindex="-1"></a>  <span class="at">y          =</span> rfe_target_region,</span>
<span id="cb260-2147"><a href="#cb260-2147" aria-hidden="true" tabindex="-1"></a>  <span class="at">sizes      =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>),</span>
<span id="cb260-2148"><a href="#cb260-2148" aria-hidden="true" tabindex="-1"></a>  <span class="at">rfeControl =</span> rfe_control_region</span>
<span id="cb260-2149"><a href="#cb260-2149" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb260-2150"><a href="#cb260-2150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2151"><a href="#cb260-2151" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Results ---</span></span>
<span id="cb260-2152"><a href="#cb260-2152" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Optimal Features Selected:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-2153"><a href="#cb260-2153" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">predictors</span>(rfe_result_region))</span>
<span id="cb260-2154"><a href="#cb260-2154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2155"><a href="#cb260-2155" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">RFE Performance Summary:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-2156"><a href="#cb260-2156" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(rfe_result_region)</span>
<span id="cb260-2157"><a href="#cb260-2157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2158"><a href="#cb260-2158" aria-hidden="true" tabindex="-1"></a><span class="co"># --- RFE plot ---</span></span>
<span id="cb260-2159"><a href="#cb260-2159" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(rfe_result_region) <span class="sc">+</span></span>
<span id="cb260-2160"><a href="#cb260-2160" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb260-2161"><a href="#cb260-2161" aria-hidden="true" tabindex="-1"></a>    <span class="at">title    =</span> <span class="st">"Figure: RFE — Feature Selection for Region Prediction"</span>,</span>
<span id="cb260-2162"><a href="#cb260-2162" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Accuracy by number of features selected"</span>,</span>
<span id="cb260-2163"><a href="#cb260-2163" aria-hidden="true" tabindex="-1"></a>    <span class="at">x        =</span> <span class="st">"Number of Features"</span>,</span>
<span id="cb260-2164"><a href="#cb260-2164" aria-hidden="true" tabindex="-1"></a>    <span class="at">y        =</span> <span class="st">"Accuracy (Cross-Validated)"</span></span>
<span id="cb260-2165"><a href="#cb260-2165" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb260-2166"><a href="#cb260-2166" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb260-2167"><a href="#cb260-2167" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb260-2168"><a href="#cb260-2168" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background   =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#12121a"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb260-2169"><a href="#cb260-2169" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background  =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#1e1e2e"</span>, <span class="at">color =</span> <span class="st">"#2a2a3a"</span>),</span>
<span id="cb260-2170"><a href="#cb260-2170" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major  =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#3a3a4a"</span>),</span>
<span id="cb260-2171"><a href="#cb260-2171" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor  =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#2a2a3a"</span>),</span>
<span id="cb260-2172"><a href="#cb260-2172" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title        =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#ffffff"</span>,</span>
<span id="cb260-2173"><a href="#cb260-2173" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">face  =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb260-2174"><a href="#cb260-2174" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle     =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb260-2175"><a href="#cb260-2175" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text         =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#e8e8e8"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb260-2176"><a href="#cb260-2176" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title        =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#e8e8e8"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb260-2177"><a href="#cb260-2177" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line         =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#8a8a9a"</span>),</span>
<span id="cb260-2178"><a href="#cb260-2178" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#1e1e2e"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb260-2179"><a href="#cb260-2179" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text       =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#e8e8e8"</span>),</span>
<span id="cb260-2180"><a href="#cb260-2180" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title      =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#e8e8e8"</span>)</span>
<span id="cb260-2181"><a href="#cb260-2181" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb260-2182"><a href="#cb260-2182" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb260-2183"><a href="#cb260-2183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2184"><a href="#cb260-2184" aria-hidden="true" tabindex="-1"></a><span class="fu">## Feature Selection Results</span></span>
<span id="cb260-2185"><a href="#cb260-2185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2186"><a href="#cb260-2186" aria-hidden="true" tabindex="-1"></a>Recursive Feature Elimination identified **three optimal features** for predicting customer region: **channel, amount, and age.**</span>
<span id="cb260-2187"><a href="#cb260-2187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2188"><a href="#cb260-2188" aria-hidden="true" tabindex="-1"></a>Notably, <span class="in">`items`</span> has now been eliminated across all three modelling tasks, consistently contributing no meaningful predictive power throughout this entire analysis.</span>
<span id="cb260-2189"><a href="#cb260-2189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2190"><a href="#cb260-2190" aria-hidden="true" tabindex="-1"></a>Accuracy improves from 0.45 with one feature to **0.6427 with three features**. Adding the fourth feature (items) actually reduces accuracy to 0.6315, confirming the three-feature model as optimal.</span>
<span id="cb260-2191"><a href="#cb260-2191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2192"><a href="#cb260-2192" aria-hidden="true" tabindex="-1"></a>All three models will be trained using channel, amount, and age as predictor variables.</span>
<span id="cb260-2193"><a href="#cb260-2193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2194"><a href="#cb260-2194" aria-hidden="true" tabindex="-1"></a><span class="fu">## Region Model Training</span></span>
<span id="cb260-2195"><a href="#cb260-2195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2198"><a href="#cb260-2198" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb260-2199"><a href="#cb260-2199" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: region-models</span></span>
<span id="cb260-2200"><a href="#cb260-2200" aria-hidden="true" tabindex="-1"></a><span class="co">#| cache: true</span></span>
<span id="cb260-2201"><a href="#cb260-2201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2202"><a href="#cb260-2202" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Prepare train and test sets with RFE selected features ---</span></span>
<span id="cb260-2203"><a href="#cb260-2203" aria-hidden="true" tabindex="-1"></a>train_x_region <span class="ot">&lt;-</span> train_region <span class="sc">%&gt;%</span> <span class="fu">select</span>(age, amount, channel)</span>
<span id="cb260-2204"><a href="#cb260-2204" aria-hidden="true" tabindex="-1"></a>test_x_region  <span class="ot">&lt;-</span> test_region <span class="sc">%&gt;%</span> <span class="fu">select</span>(age, amount, channel)</span>
<span id="cb260-2205"><a href="#cb260-2205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2206"><a href="#cb260-2206" aria-hidden="true" tabindex="-1"></a>train_y_region <span class="ot">&lt;-</span> train_region<span class="sc">$</span>region</span>
<span id="cb260-2207"><a href="#cb260-2207" aria-hidden="true" tabindex="-1"></a>test_y_region  <span class="ot">&lt;-</span> test_region<span class="sc">$</span>region</span>
<span id="cb260-2208"><a href="#cb260-2208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2209"><a href="#cb260-2209" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Training models with features: age, amount, channel</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb260-2210"><a href="#cb260-2210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2211"><a href="#cb260-2211" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Model 1: Multinomial Logistic Regression ---</span></span>
<span id="cb260-2212"><a href="#cb260-2212" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb260-2213"><a href="#cb260-2213" aria-hidden="true" tabindex="-1"></a>model_lr_region <span class="ot">&lt;-</span> <span class="fu">train</span>(</span>
<span id="cb260-2214"><a href="#cb260-2214" aria-hidden="true" tabindex="-1"></a>  <span class="at">x          =</span> train_x_region,</span>
<span id="cb260-2215"><a href="#cb260-2215" aria-hidden="true" tabindex="-1"></a>  <span class="at">y          =</span> train_y_region,</span>
<span id="cb260-2216"><a href="#cb260-2216" aria-hidden="true" tabindex="-1"></a>  <span class="at">method     =</span> <span class="st">"multinom"</span>,</span>
<span id="cb260-2217"><a href="#cb260-2217" aria-hidden="true" tabindex="-1"></a>  <span class="at">trControl  =</span> train_control,</span>
<span id="cb260-2218"><a href="#cb260-2218" aria-hidden="true" tabindex="-1"></a>  <span class="at">preProcess =</span> <span class="fu">c</span>(<span class="st">"center"</span>, <span class="st">"scale"</span>),</span>
<span id="cb260-2219"><a href="#cb260-2219" aria-hidden="true" tabindex="-1"></a>  <span class="at">trace      =</span> <span class="cn">FALSE</span></span>
<span id="cb260-2220"><a href="#cb260-2220" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb260-2221"><a href="#cb260-2221" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Multinomial Logistic Regression — Trained</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-2222"><a href="#cb260-2222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2223"><a href="#cb260-2223" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Model 2: Random Forest ---</span></span>
<span id="cb260-2224"><a href="#cb260-2224" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb260-2225"><a href="#cb260-2225" aria-hidden="true" tabindex="-1"></a>model_rf_region <span class="ot">&lt;-</span> <span class="fu">train</span>(</span>
<span id="cb260-2226"><a href="#cb260-2226" aria-hidden="true" tabindex="-1"></a>  <span class="at">x          =</span> train_x_region,</span>
<span id="cb260-2227"><a href="#cb260-2227" aria-hidden="true" tabindex="-1"></a>  <span class="at">y          =</span> train_y_region,</span>
<span id="cb260-2228"><a href="#cb260-2228" aria-hidden="true" tabindex="-1"></a>  <span class="at">method     =</span> <span class="st">"rf"</span>,</span>
<span id="cb260-2229"><a href="#cb260-2229" aria-hidden="true" tabindex="-1"></a>  <span class="at">trControl  =</span> train_control,</span>
<span id="cb260-2230"><a href="#cb260-2230" aria-hidden="true" tabindex="-1"></a>  <span class="at">preProcess =</span> <span class="fu">c</span>(<span class="st">"center"</span>, <span class="st">"scale"</span>),</span>
<span id="cb260-2231"><a href="#cb260-2231" aria-hidden="true" tabindex="-1"></a>  <span class="at">tuneLength =</span> <span class="dv">3</span></span>
<span id="cb260-2232"><a href="#cb260-2232" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb260-2233"><a href="#cb260-2233" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Random Forest — Trained</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-2234"><a href="#cb260-2234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2235"><a href="#cb260-2235" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Model 3: Decision Tree ---</span></span>
<span id="cb260-2236"><a href="#cb260-2236" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb260-2237"><a href="#cb260-2237" aria-hidden="true" tabindex="-1"></a>model_dt_region <span class="ot">&lt;-</span> <span class="fu">train</span>(</span>
<span id="cb260-2238"><a href="#cb260-2238" aria-hidden="true" tabindex="-1"></a>  <span class="at">x          =</span> train_x_region,</span>
<span id="cb260-2239"><a href="#cb260-2239" aria-hidden="true" tabindex="-1"></a>  <span class="at">y          =</span> train_y_region,</span>
<span id="cb260-2240"><a href="#cb260-2240" aria-hidden="true" tabindex="-1"></a>  <span class="at">method     =</span> <span class="st">"rpart"</span>,</span>
<span id="cb260-2241"><a href="#cb260-2241" aria-hidden="true" tabindex="-1"></a>  <span class="at">trControl  =</span> train_control,</span>
<span id="cb260-2242"><a href="#cb260-2242" aria-hidden="true" tabindex="-1"></a>  <span class="at">preProcess =</span> <span class="fu">c</span>(<span class="st">"center"</span>, <span class="st">"scale"</span>),</span>
<span id="cb260-2243"><a href="#cb260-2243" aria-hidden="true" tabindex="-1"></a>  <span class="at">tuneLength =</span> <span class="dv">10</span></span>
<span id="cb260-2244"><a href="#cb260-2244" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb260-2245"><a href="#cb260-2245" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Decision Tree — Trained</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-2246"><a href="#cb260-2246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2247"><a href="#cb260-2247" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">All three models trained successfully.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-2248"><a href="#cb260-2248" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb260-2249"><a href="#cb260-2249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2250"><a href="#cb260-2250" aria-hidden="true" tabindex="-1"></a><span class="fu">## Region Comparison Table And Best Model </span></span>
<span id="cb260-2251"><a href="#cb260-2251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2254"><a href="#cb260-2254" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb260-2255"><a href="#cb260-2255" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: region-comparison</span></span>
<span id="cb260-2256"><a href="#cb260-2256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2257"><a href="#cb260-2257" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Predictions on test set ---</span></span>
<span id="cb260-2258"><a href="#cb260-2258" aria-hidden="true" tabindex="-1"></a>pred_lr_region <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_lr_region, test_x_region)</span>
<span id="cb260-2259"><a href="#cb260-2259" aria-hidden="true" tabindex="-1"></a>pred_rf_region <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_rf_region, test_x_region)</span>
<span id="cb260-2260"><a href="#cb260-2260" aria-hidden="true" tabindex="-1"></a>pred_dt_region <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_dt_region, test_x_region)</span>
<span id="cb260-2261"><a href="#cb260-2261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2262"><a href="#cb260-2262" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Confusion matrices ---</span></span>
<span id="cb260-2263"><a href="#cb260-2263" aria-hidden="true" tabindex="-1"></a>cm_lr_region <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_lr_region, test_y_region)</span>
<span id="cb260-2264"><a href="#cb260-2264" aria-hidden="true" tabindex="-1"></a>cm_rf_region <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_rf_region, test_y_region)</span>
<span id="cb260-2265"><a href="#cb260-2265" aria-hidden="true" tabindex="-1"></a>cm_dt_region <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_dt_region, test_y_region)</span>
<span id="cb260-2266"><a href="#cb260-2266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2267"><a href="#cb260-2267" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Model comparison table ---</span></span>
<span id="cb260-2268"><a href="#cb260-2268" aria-hidden="true" tabindex="-1"></a>model_comparison_region <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb260-2269"><a href="#cb260-2269" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model    =</span> <span class="fu">c</span>(<span class="st">"Multinomial Logistic Regression"</span>,</span>
<span id="cb260-2270"><a href="#cb260-2270" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Random Forest"</span>,</span>
<span id="cb260-2271"><a href="#cb260-2271" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Decision Tree"</span>),</span>
<span id="cb260-2272"><a href="#cb260-2272" aria-hidden="true" tabindex="-1"></a>  <span class="at">Accuracy =</span> <span class="fu">c</span>(cm_lr_region<span class="sc">$</span>overall[<span class="st">"Accuracy"</span>],</span>
<span id="cb260-2273"><a href="#cb260-2273" aria-hidden="true" tabindex="-1"></a>               cm_rf_region<span class="sc">$</span>overall[<span class="st">"Accuracy"</span>],</span>
<span id="cb260-2274"><a href="#cb260-2274" aria-hidden="true" tabindex="-1"></a>               cm_dt_region<span class="sc">$</span>overall[<span class="st">"Accuracy"</span>]),</span>
<span id="cb260-2275"><a href="#cb260-2275" aria-hidden="true" tabindex="-1"></a>  <span class="at">Kappa    =</span> <span class="fu">c</span>(cm_lr_region<span class="sc">$</span>overall[<span class="st">"Kappa"</span>],</span>
<span id="cb260-2276"><a href="#cb260-2276" aria-hidden="true" tabindex="-1"></a>               cm_rf_region<span class="sc">$</span>overall[<span class="st">"Kappa"</span>],</span>
<span id="cb260-2277"><a href="#cb260-2277" aria-hidden="true" tabindex="-1"></a>               cm_dt_region<span class="sc">$</span>overall[<span class="st">"Kappa"</span>])</span>
<span id="cb260-2278"><a href="#cb260-2278" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb260-2279"><a href="#cb260-2279" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span> <span class="fu">round</span>(., <span class="dv">4</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb260-2280"><a href="#cb260-2280" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Accuracy))</span>
<span id="cb260-2281"><a href="#cb260-2281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2282"><a href="#cb260-2282" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Display comparison table ---</span></span>
<span id="cb260-2283"><a href="#cb260-2283" aria-hidden="true" tabindex="-1"></a>model_comparison_region <span class="sc">%&gt;%</span></span>
<span id="cb260-2284"><a href="#cb260-2284" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(</span>
<span id="cb260-2285"><a href="#cb260-2285" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Model"</span>, <span class="st">"Accuracy"</span>, <span class="st">"Kappa"</span>),</span>
<span id="cb260-2286"><a href="#cb260-2286" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption   =</span> <span class="st">"Table: Model Comparison Region Prediction"</span></span>
<span id="cb260-2287"><a href="#cb260-2287" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb260-2288"><a href="#cb260-2288" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb260-2289"><a href="#cb260-2289" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"#00d4ff"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb260-2290"><a href="#cb260-2290" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="dv">1</span>, <span class="at">background =</span> <span class="st">"rgba(0, 212, 255, 0.08)"</span>)</span>
<span id="cb260-2291"><a href="#cb260-2291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2292"><a href="#cb260-2292" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Best model statement ---</span></span>
<span id="cb260-2293"><a href="#cb260-2293" aria-hidden="true" tabindex="-1"></a>best_model_region    <span class="ot">&lt;-</span> model_comparison_region<span class="sc">$</span>Model[<span class="dv">1</span>]</span>
<span id="cb260-2294"><a href="#cb260-2294" aria-hidden="true" tabindex="-1"></a>best_accuracy_region <span class="ot">&lt;-</span> <span class="fu">round</span>(model_comparison_region<span class="sc">$</span>Accuracy[<span class="dv">1</span>] <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>)</span>
<span id="cb260-2295"><a href="#cb260-2295" aria-hidden="true" tabindex="-1"></a>best_kappa_region    <span class="ot">&lt;-</span> model_comparison_region<span class="sc">$</span>Kappa[<span class="dv">1</span>]</span>
<span id="cb260-2296"><a href="#cb260-2296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2297"><a href="#cb260-2297" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Best Performing Model:"</span>, best_model_region, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-2298"><a href="#cb260-2298" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Test Set Accuracy:    "</span>, best_accuracy_region, <span class="st">"%</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-2299"><a href="#cb260-2299" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Kappa Statistic:      "</span>, best_kappa_region, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-2300"><a href="#cb260-2300" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb260-2301"><a href="#cb260-2301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2302"><a href="#cb260-2302" aria-hidden="true" tabindex="-1"></a><span class="fu">## Actual vs Predicted Table: Decision Tree</span></span>
<span id="cb260-2303"><a href="#cb260-2303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2306"><a href="#cb260-2306" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb260-2307"><a href="#cb260-2307" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: region-dt-evaluation</span></span>
<span id="cb260-2308"><a href="#cb260-2308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2309"><a href="#cb260-2309" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Actual vs Predicted comparison ---</span></span>
<span id="cb260-2310"><a href="#cb260-2310" aria-hidden="true" tabindex="-1"></a>region_results <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb260-2311"><a href="#cb260-2311" aria-hidden="true" tabindex="-1"></a>  <span class="at">Actual    =</span> test_y_region,</span>
<span id="cb260-2312"><a href="#cb260-2312" aria-hidden="true" tabindex="-1"></a>  <span class="at">Predicted =</span> pred_dt_region,</span>
<span id="cb260-2313"><a href="#cb260-2313" aria-hidden="true" tabindex="-1"></a>  <span class="at">Correct   =</span> test_y_region <span class="sc">==</span> pred_dt_region</span>
<span id="cb260-2314"><a href="#cb260-2314" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb260-2315"><a href="#cb260-2315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2316"><a href="#cb260-2316" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Actual vs Predicted summary table ---</span></span>
<span id="cb260-2317"><a href="#cb260-2317" aria-hidden="true" tabindex="-1"></a>region_summary <span class="ot">&lt;-</span> region_results <span class="sc">%&gt;%</span></span>
<span id="cb260-2318"><a href="#cb260-2318" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Actual, Predicted) <span class="sc">%&gt;%</span></span>
<span id="cb260-2319"><a href="#cb260-2319" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb260-2320"><a href="#cb260-2320" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb260-2321"><a href="#cb260-2321" aria-hidden="true" tabindex="-1"></a>    <span class="at">Result =</span> <span class="fu">ifelse</span>(Actual <span class="sc">==</span> Predicted,</span>
<span id="cb260-2322"><a href="#cb260-2322" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"Correct"</span>, <span class="st">"Incorrect"</span>)</span>
<span id="cb260-2323"><a href="#cb260-2323" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb260-2324"><a href="#cb260-2324" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Actual, Predicted)</span>
<span id="cb260-2325"><a href="#cb260-2325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2326"><a href="#cb260-2326" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Display actual vs predicted table ---</span></span>
<span id="cb260-2327"><a href="#cb260-2327" aria-hidden="true" tabindex="-1"></a>region_summary <span class="sc">%&gt;%</span></span>
<span id="cb260-2328"><a href="#cb260-2328" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(</span>
<span id="cb260-2329"><a href="#cb260-2329" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Actual"</span>, <span class="st">"Predicted"</span>,</span>
<span id="cb260-2330"><a href="#cb260-2330" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Count"</span>, <span class="st">"Result"</span>),</span>
<span id="cb260-2331"><a href="#cb260-2331" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption   =</span> <span class="st">"Table: Actual vs Predicted: Region (Decision Tree)"</span></span>
<span id="cb260-2332"><a href="#cb260-2332" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb260-2333"><a href="#cb260-2333" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb260-2334"><a href="#cb260-2334" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"#00d4ff"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb260-2335"><a href="#cb260-2335" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">4</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>,</span>
<span id="cb260-2336"><a href="#cb260-2336" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="fu">ifelse</span>(region_summary<span class="sc">$</span>Result <span class="sc">==</span> <span class="st">"Correct"</span>,</span>
<span id="cb260-2337"><a href="#cb260-2337" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"#00ff9d"</span>, <span class="st">"#ff6b6b"</span>))</span>
<span id="cb260-2338"><a href="#cb260-2338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2339"><a href="#cb260-2339" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Overall prediction breakdown ---</span></span>
<span id="cb260-2340"><a href="#cb260-2340" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Region Prediction Breakdown:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-2341"><a href="#cb260-2341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2342"><a href="#cb260-2342" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Correctly classified:  "</span>, <span class="fu">sum</span>(region_results<span class="sc">$</span>Correct), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-2343"><a href="#cb260-2343" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Incorrectly classified:"</span>, <span class="fu">sum</span>(<span class="sc">!</span>region_results<span class="sc">$</span>Correct), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-2344"><a href="#cb260-2344" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Overall Accuracy:      "</span>,</span>
<span id="cb260-2345"><a href="#cb260-2345" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">mean</span>(region_results<span class="sc">$</span>Correct) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>), <span class="st">"%</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-2346"><a href="#cb260-2346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2347"><a href="#cb260-2347" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Per region accuracy ---</span></span>
<span id="cb260-2348"><a href="#cb260-2348" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Per Region Accuracy:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-2349"><a href="#cb260-2349" aria-hidden="true" tabindex="-1"></a>region_results <span class="sc">%&gt;%</span></span>
<span id="cb260-2350"><a href="#cb260-2350" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Actual) <span class="sc">%&gt;%</span></span>
<span id="cb260-2351"><a href="#cb260-2351" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb260-2352"><a href="#cb260-2352" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total   =</span> <span class="fu">n</span>(),</span>
<span id="cb260-2353"><a href="#cb260-2353" aria-hidden="true" tabindex="-1"></a>    <span class="at">Correct =</span> <span class="fu">sum</span>(Correct),</span>
<span id="cb260-2354"><a href="#cb260-2354" aria-hidden="true" tabindex="-1"></a>    <span class="at">Accuracy =</span> <span class="fu">round</span>(<span class="fu">mean</span>(Correct) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>)</span>
<span id="cb260-2355"><a href="#cb260-2355" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb260-2356"><a href="#cb260-2356" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span>
<span id="cb260-2357"><a href="#cb260-2357" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb260-2358"><a href="#cb260-2358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2359"><a href="#cb260-2359" aria-hidden="true" tabindex="-1"></a><span class="fu">## Save Region Best Model</span></span>
<span id="cb260-2360"><a href="#cb260-2360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2363"><a href="#cb260-2363" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb260-2364"><a href="#cb260-2364" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: save-region-model</span></span>
<span id="cb260-2365"><a href="#cb260-2365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2366"><a href="#cb260-2366" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Save best model for region prediction ---</span></span>
<span id="cb260-2367"><a href="#cb260-2367" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(model_dt_region, <span class="st">"best_model_region.rds"</span>)</span>
<span id="cb260-2368"><a href="#cb260-2368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2369"><a href="#cb260-2369" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Best model for region prediction saved successfully.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-2370"><a href="#cb260-2370" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Model: Decision Tree</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-2371"><a href="#cb260-2371" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"File:  best_model_region.rds</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-2372"><a href="#cb260-2372" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb260-2373"><a href="#cb260-2373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2374"><a href="#cb260-2374" aria-hidden="true" tabindex="-1"></a><span class="fu">## Interpretation: Region Prediction</span></span>
<span id="cb260-2375"><a href="#cb260-2375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2376"><a href="#cb260-2376" aria-hidden="true" tabindex="-1"></a>The Decision Tree outperformed both Random Forest and Multinomial Logistic Regression, achieving a test set accuracy of **64.41%** and a Kappa of **0.5175**, indicating moderate agreement beyond chance for a four-class prediction problem.</span>
<span id="cb260-2377"><a href="#cb260-2377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2378"><a href="#cb260-2378" aria-hidden="true" tabindex="-1"></a>The per region accuracy reveals a striking performance imbalance:</span>
<span id="cb260-2379"><a href="#cb260-2379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2380"><a href="#cb260-2380" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**South, 99.92% accuracy**, virtually perfect. The South's distinct customer profile, older age, low spending ceiling of \$499.94, makes it uniquely identifiable from other regions.</span>
<span id="cb260-2381"><a href="#cb260-2381" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**West ,73.96% accuracy**, good performance, driven by the West's young, high-spending customer profile.</span>
<span id="cb260-2382"><a href="#cb260-2382" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**North, 54.36% accuracy**, moderate. North customers share demographic overlap with both East and West, making them harder to distinguish.</span>
<span id="cb260-2383"><a href="#cb260-2383" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**East, 20.11% accuracy**, poor. The majority of East customers are misclassified as North (1,426 cases), suggesting the two regions have very similar demographic and spending profiles that the model cannot reliably separate.</span>
<span id="cb260-2384"><a href="#cb260-2384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2385"><a href="#cb260-2385" aria-hidden="true" tabindex="-1"></a>Overall, 10,302 out of 15,994 customers were correctly classified, with 5,692 misclassifications, concentrated almost entirely in the East region.</span>
<span id="cb260-2386"><a href="#cb260-2386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2387"><a href="#cb260-2387" aria-hidden="true" tabindex="-1"></a>**Recommendation:** The model is reliable for identifying South and West customers, but struggles significantly with East region customers. Blackwell should treat East region predictions with caution. Richer data such as product category preferences or browsing behaviour would likely improve East vs North discrimination considerably.</span>
<span id="cb260-2388"><a href="#cb260-2388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2389"><a href="#cb260-2389" aria-hidden="true" tabindex="-1"></a><span class="fu">#  Conclusions &amp; Recommendations</span></span>
<span id="cb260-2390"><a href="#cb260-2390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2391"><a href="#cb260-2391" aria-hidden="true" tabindex="-1"></a>This section brings together the key findings from both the Exploratory Data Analysis and the Predictive Modelling phases into a concise, actionable summary for Danielle Sherman and Martin Goodrich. Every conclusion drawn here is grounded directly in the data, no assumptions, no generalisations.</span>
<span id="cb260-2392"><a href="#cb260-2392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2395"><a href="#cb260-2395" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb260-2396"><a href="#cb260-2396" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: conclusions-summary</span></span>
<span id="cb260-2397"><a href="#cb260-2397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2398"><a href="#cb260-2398" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Final findings summary table ---</span></span>
<span id="cb260-2399"><a href="#cb260-2399" aria-hidden="true" tabindex="-1"></a>conclusions <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb260-2400"><a href="#cb260-2400" aria-hidden="true" tabindex="-1"></a>  <span class="at">Business_Question =</span> <span class="fu">c</span>(</span>
<span id="cb260-2401"><a href="#cb260-2401" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Do customers in different regions spend more per transaction?"</span>,</span>
<span id="cb260-2402"><a href="#cb260-2402" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Is there a relationship between items purchased and amount spent?"</span>,</span>
<span id="cb260-2403"><a href="#cb260-2403" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Do older customers spend more than younger customers?"</span>,</span>
<span id="cb260-2404"><a href="#cb260-2404" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Are in-store customers older than online customers?"</span>,</span>
<span id="cb260-2405"><a href="#cb260-2405" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Are there age differences across regions?"</span>,</span>
<span id="cb260-2406"><a href="#cb260-2406" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Can purchase channel be predicted?"</span>,</span>
<span id="cb260-2407"><a href="#cb260-2407" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Can customer age be predicted?"</span>,</span>
<span id="cb260-2408"><a href="#cb260-2408" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Can customer region be predicted?"</span></span>
<span id="cb260-2409"><a href="#cb260-2409" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb260-2410"><a href="#cb260-2410" aria-hidden="true" tabindex="-1"></a>  <span class="at">Finding =</span> <span class="fu">c</span>(</span>
<span id="cb260-2411"><a href="#cb260-2411" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Yes, significant regional differences exist. West leads ($1,283.94), South trails ($252.10) with a spending ceiling of $499.94."</span>,</span>
<span id="cb260-2412"><a href="#cb260-2412" aria-hidden="true" tabindex="-1"></a>    <span class="st">"No, Pearson r = 0.0004. No meaningful relationship exists between items purchased and amount spent."</span>,</span>
<span id="cb260-2413"><a href="#cb260-2413" aria-hidden="true" tabindex="-1"></a>    <span class="st">"No, the data contradicts this hypothesis. Younger customers spend more. Pearson r = -0.282."</span>,</span>
<span id="cb260-2414"><a href="#cb260-2414" aria-hidden="true" tabindex="-1"></a>    <span class="st">"No, the data contradicts this hypothesis. Online customers are older (mean 48.56) than in-store (mean 42.96)."</span>,</span>
<span id="cb260-2415"><a href="#cb260-2415" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Yes, statistically significant age differences exist across regions (F = 6,139.42, p &lt; 0.0001). South is oldest (56.6), West is youngest (38.8)."</span>,</span>
<span id="cb260-2416"><a href="#cb260-2416" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Yes — Decision Tree achieves 88.82% accuracy. Online customers identified with near-perfect precision."</span>,</span>
<span id="cb260-2417"><a href="#cb260-2417" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Partially Decision Tree RMSE = 13.89 years, R² = 0.22. Model explains only 21.82% of age variance. Not reliable for operational use."</span>,</span>
<span id="cb260-2418"><a href="#cb260-2418" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Partially, Decision Tree achieves 64.41% accuracy. South (99.92%) and West (73.96%) predicted well. East poorly predicted (20.11%)."</span></span>
<span id="cb260-2419"><a href="#cb260-2419" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb260-2420"><a href="#cb260-2420" aria-hidden="true" tabindex="-1"></a>  <span class="at">Recommendation =</span> <span class="fu">c</span>(</span>
<span id="cb260-2421"><a href="#cb260-2421" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Allocate higher marketing budgets to West and East. Deploy value-oriented strategy for South. Investigate absence of high-value purchases in South."</span>,</span>
<span id="cb260-2422"><a href="#cb260-2422" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Bundling and volume-based pricing strategies are unlikely to drive higher revenue. Focus on product type and price point instead."</span>,</span>
<span id="cb260-2423"><a href="#cb260-2423" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Marketing campaigns targeting older customers as higher spenders are not justified. Focus high-value campaigns on younger demographics (18-39)."</span>,</span>
<span id="cb260-2424"><a href="#cb260-2424" aria-hidden="true" tabindex="-1"></a>    <span class="st">"The website already attracts older customers. Focus should shift to understanding why younger in-store customers generate higher transaction values."</span>,</span>
<span id="cb260-2425"><a href="#cb260-2425" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Regional marketing should account for demographic differences. South needs trust-building, value-oriented messaging. West and East suit premium campaigns."</span>,</span>
<span id="cb260-2426"><a href="#cb260-2426" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Deploy the Decision Tree model to proactively segment customers by channel for targeted marketing communications."</span>,</span>
<span id="cb260-2427"><a href="#cb260-2427" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Transaction data alone is insufficient to predict age reliably. Richer data, browsing behaviour, product categories are needed."</span>,</span>
<span id="cb260-2428"><a href="#cb260-2428" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Model is reliable for South and West segmentation. East region predictions should be treated with caution until richer data is available."</span></span>
<span id="cb260-2429"><a href="#cb260-2429" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb260-2430"><a href="#cb260-2430" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb260-2431"><a href="#cb260-2431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2432"><a href="#cb260-2432" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Display conclusions table ---</span></span>
<span id="cb260-2433"><a href="#cb260-2433" aria-hidden="true" tabindex="-1"></a>conclusions <span class="sc">%&gt;%</span></span>
<span id="cb260-2434"><a href="#cb260-2434" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(</span>
<span id="cb260-2435"><a href="#cb260-2435" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Business Question"</span>, </span>
<span id="cb260-2436"><a href="#cb260-2436" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Finding"</span>, </span>
<span id="cb260-2437"><a href="#cb260-2437" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Recommendation"</span>),</span>
<span id="cb260-2438"><a href="#cb260-2438" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption   =</span> <span class="st">"Table: Summary of Findings &amp; Recommendations"</span></span>
<span id="cb260-2439"><a href="#cb260-2439" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb260-2440"><a href="#cb260-2440" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb260-2441"><a href="#cb260-2441" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"#00d4ff"</span>, <span class="at">width =</span> <span class="st">"25%"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb260-2442"><a href="#cb260-2442" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">2</span>, <span class="at">width =</span> <span class="st">"40%"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb260-2443"><a href="#cb260-2443" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">3</span>, <span class="at">width =</span> <span class="st">"35%"</span>)</span>
<span id="cb260-2444"><a href="#cb260-2444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2445"><a href="#cb260-2445" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb260-2446"><a href="#cb260-2446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2447"><a href="#cb260-2447" aria-hidden="true" tabindex="-1"></a><span class="fu">## Closing Remarks</span></span>
<span id="cb260-2448"><a href="#cb260-2448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2449"><a href="#cb260-2449" aria-hidden="true" tabindex="-1"></a>This analysis has delivered data-driven answers to every business question posed by Danielle Sherman and tested both hypotheses raised by Martin Goodrich. The findings are clear:</span>
<span id="cb260-2450"><a href="#cb260-2450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2451"><a href="#cb260-2451" aria-hidden="true" tabindex="-1"></a>**Martin's hypotheses are not supported by the data.** Older customers do not spend more, and in-store customers are not older than online customers. Any business decisions based on these assumptions would be misdirected.</span>
<span id="cb260-2452"><a href="#cb260-2452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2453"><a href="#cb260-2453" aria-hidden="true" tabindex="-1"></a>**Regional differences are the most actionable insight.** The West and East regions represent Blackwell's highest-value customer segments, while the South presents a fundamentally different and more constrained spending profile that warrants its own dedicated strategy.</span>
<span id="cb260-2454"><a href="#cb260-2454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2455"><a href="#cb260-2455" aria-hidden="true" tabindex="-1"></a>**The Decision Tree model is the strongest performer** across all three prediction tasks achieving 88.82% accuracy for channel prediction, and providing reliable region segmentation for South and West customers.</span>
<span id="cb260-2456"><a href="#cb260-2456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2457"><a href="#cb260-2457" aria-hidden="true" tabindex="-1"></a>**The most important limitation** identified in this analysis is data richness. Transaction data alone, five variables across 80,000 records has clear predictive limits, particularly for age prediction. Blackwell's next step should be enriching their customer data collection to include browsing behaviour, product category preferences, and loyalty programme engagement. This would unlock significantly more powerful predictive models and deeper customer insights.</span>
<span id="cb260-2458"><a href="#cb260-2458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-2459"><a href="#cb260-2459" aria-hidden="true" tabindex="-1"></a>***Analysis conducted by Freda Erinmwingbovo ; February 2026***</span>
</code></pre></div><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></div>
</div></div></div></div></div>
</div> <!-- /content -->




<script src="blackwell-customer-analytics_files/libs/quarto-html/zenscroll-min.js"></script>
</body></html>